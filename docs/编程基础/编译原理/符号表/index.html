<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Blog Atom Feed"><title data-react-helmet="true">符号表 | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="符号表 | My Site"><meta data-react-helmet="true" name="description" content="符号表"><meta data-react-helmet="true" property="og:description" content="符号表"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/编程基础/编译原理/符号表"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/编程基础/编译原理/符号表"><link rel="stylesheet" href="/styles.8cfbcdec.css">
<link rel="preload" href="/styles.9888532b.js" as="script">
<link rel="preload" href="/runtime~main.73fb2e0e.js" as="script">
<link rel="preload" href="/main.a2e30791.js" as="script">
<link rel="preload" href="/1.fa235d9f.js" as="script">
<link rel="preload" href="/2.8423217f.js" as="script">
<link rel="preload" href="/257.8905f2ed.js" as="script">
<link rel="preload" href="/258.3860215e.js" as="script">
<link rel="preload" href="/935f2afb.ce536a1e.js" as="script">
<link rel="preload" href="/17896441.d8a5f7af.js" as="script">
<link rel="preload" href="/dfa55b42.3934e631.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/编程基础/编程基础/编程基础">编程基础</a><a class="navbar__item navbar__link" href="/docs/编程语言/编程语言">编程语言</a><a class="navbar__item navbar__link" href="/docs/工具/常用工具">工具</a><a class="navbar__item navbar__link" href="/docs/应用开发/应用开发">应用开发</a><a class="navbar__item navbar__link" href="/docs/Apple/iOS开发/iOS开发">Apple</a><a class="navbar__item navbar__link" href="/docs/音视频/音视频">音视频</a><a class="navbar__item navbar__link" href="/docs/项目/项目">项目</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/编程基础/编程基础/编程基础">编程基础</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/编程语言/编程语言">编程语言</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/工具/常用工具">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/应用开发/应用开发">应用开发</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Apple/iOS开发/iOS开发">Apple</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/音视频/音视频">音视频</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/项目/项目">项目</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">符号表</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="符号表"></a>符号表<a class="hash-link" href="#符号表" title="Direct link to heading">#</a></h1><p>symbol</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="objective-c"></a>Objective-C<a class="hash-link" href="#objective-c" title="Direct link to heading">#</a></h3><p>The dynamic nature of Objective-C complicates things slightly. Because the code that implements a method is not determined until the method is actually called, Objective-C does not define linker symbols for methods. Linker symbols are only defined for classes.</p><p>For example, if main.m includes the code <code>[[FooClass alloc] initWithBar:nil];</code> then <code>main.o</code> will contain an undefined symbol for <code>FooClass</code>, but no linker symbols for the <code>-initWithBar:</code> method will be in <code>main.o</code>.</p><p>Since categories are a collection of methods, using a category&#x27;s method does not generate an undefined symbol. This means the linker does not know to load an object file defining the category, if the class itself is already defined. This causes the same &quot;selector not recognized&quot; runtime exception you would see for any unimplemented method.</p><p>参考：</p><p><a href="https://developer.apple.com/library/archive/qa/qa1490/_index.html" target="_blank" rel="noopener noreferrer">https://developer.apple.com/library/archive/qa/qa1490/_index.html</a></p><p>因为实现方法的代码直到方法被实际调用时才确定，Objective-C 没有为方法定义链接器符号。链接器符号仅为类定义。</p><p>可以这么理解：在OC里所有的方法都是虚的。因为只有到运行时才能确定调用那个方法。</p><p>dys_ios_framework：</p><p><code>/Users/dingyusong/mine/github/dys_ios_framework_staticlib/demo2/dys_ios_framework/dys_ios_framework/DYSFrameWorkClass.h</code></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework nm -g dys_ios_framework</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework_vers.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000040 R _dys_ios_frameworkVersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 R _dys_ios_frameworkVersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DYSFrameWorkClass.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _NSLog</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000280 T _OBJC_CLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000258 T _OBJC_METACLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U ___CFConstantStringClassReference</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>DYSFrameWorkClass.h</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@interface DYSFrameWorkClass : NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+ (void)dys_test;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- (void)dys_test1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>可以看到符号只有类，没有方法。验证了上面的方法。</p><p>添加了helloc.c 和 helloc2.c。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework nm -g dys_ios_framework</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework_vers.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000040 R _dys_ios_frameworkVersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 R _dys_ios_frameworkVersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helloc.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _my_c_print</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helloc2.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _my_c_print_in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DYSFrameWorkClass.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _NSLog</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000280 T _OBJC_CLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000258 T _OBJC_METACLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U ___CFConstantStringClassReference</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _my_c_print_in</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>-g或–extern-only：仅显示外部符号。</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mach-o"></a>Mach-O<a class="hash-link" href="#mach-o" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">gcc -g a.c -o a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>注意-g参数，在其他unix系统中，通常将符号信息内嵌在二进制文件中，但是在osx中，这些信息都放在一个辅助文件dSYM中。</p><p><a href="https://h3adsh0tzz.com/2020/01/macho-file-format/" target="_blank" rel="noopener noreferrer">Mach-O File Format: Introduction</a></p><p><a href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/CodeFootprint/Articles/MachOOverview.html" target="_blank" rel="noopener noreferrer">Overview of the Mach-O Executable Format</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mach-header"></a>Mach header<a class="hash-link" href="#mach-header" title="Direct link to heading">#</a></h3><p>C结构体天然可以用来解释二进制文件。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct mach_header {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            magic;          // mach magic number</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cpu_type_t          cputype;        // cpu specifier</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cpu_subtype_t       cpusubtype;     // cpu subtype specifier</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            filetype;       // type of mach-o e.g. exec, dylib ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            ncmds;          // number of load commands</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            sizeofcmds;     // size of load command region</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            flags;          // flags</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            reserved;       // *64-bit only* reserved</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework otool -h dys_ios_framework </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mach header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> 0xfeedfacf 16777228          0  0x00           6    21       2536 0x00100085</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="image-20210818153407343" src="/assets/images/image-20210818153407343-1379df3a7f30768ac1d14903a7f9baaf.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="load-commands"></a>Load Commands<a class="hash-link" href="#load-commands" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   struct load_command {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            cmd;            // type of load command</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            cmdsize;        // size of load command</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="symbol-table"></a>Symbol Table<a class="hash-link" href="#symbol-table" title="Direct link to heading">#</a></h3><p>符号表存储了当前文件的符号信息，静态链接器(ld)和动态链接器(dyld)在链接的过程中都会读取符号表，另外调试器也会用符号表来把符号映射到源文件。</p><p>.symtab符号表不包含局部变量的条目。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dynamic-symbol-table"></a>Dynamic Symbol Table<a class="hash-link" href="#dynamic-symbol-table" title="Direct link to heading">#</a></h3><p>使用 <strong><em>otool</em></strong> 命令可以查看动态符号表中的符号位于符号表中的下标。因此动态符号也叫做 <strong><em>Indirect symbols</em></strong>。</p><p>动态符号表，<strong><em>Dynamic Symbol Table</em></strong> ，其中 <strong><em>仅存储了符号位于Symbol Table中的下标</em></strong> ，而非符号数据结构，因为符号的结构仅存储在 <strong><em>Symbol Table</em></strong> 而已。</p><p><img alt="image-20210817172804282" src="/assets/images/image-20210817172804282-7599e91265cb45f110a9fbeb9228a556.png"></p><p><img alt="image-20210817172203838" src="/assets/images/image-20210817172203838-76ea04ff6e826509b5f944461ca4dba1.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="string-table"></a>String Table<a class="hash-link" href="#string-table" title="Direct link to heading">#</a></h3><p>二进制中的所有字符串都存储在 <strong><em>String Table</em></strong> 中。</p><p><img alt="img" src="/assets/images/17231f081b953bf4~tplv-t2oaga2asx-watermark-e9c2fc748948b0a99a4b1fb2e40f3b2f.awebp"></p><p><img alt="image-20210817172107039" src="/assets/images/image-20210817172107039-c1487f2ec5b85b97689e4acf4ec56e0c.png"></p><p><img alt="image-20210817172356296" src="/assets/images/image-20210817172356296-39e9ae1d1b04f39245d9682f23d2f794.png"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework strings dys_ios_framework</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="otool"></a>otool<a class="hash-link" href="#otool" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework otool --help</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">error: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/otool: unknown char `-&#x27; in flag --help</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Usage: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/otool [-arch arch_type] [-fahlLDtdorSTMRIHGvVcXmqQjCP] [-mcpu=arg] [--version] &lt;object file&gt; ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -f print the fat headers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -a print the archive header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -h print the mach header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -l print the load commands</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -L print shared libraries used</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -D print shared library id name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -t print the text section (disassemble with -v)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -x print all text sections (disassemble with -v)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -p &lt;routine name&gt;  start dissassemble from routine name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -s &lt;segname&gt; &lt;sectname&gt; print contents of section</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -d print the data section</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -o print the Objective-C segment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -r print the relocation entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -S print the table of contents of a library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -T print the table of contents of a dynamic shared library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -M print the module table of a dynamic shared library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -R print the reference table of a dynamic shared library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -I print the indirect symbol table</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -H print the two-level hints table (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -G print the data in code table</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -v print verbosely (symbolically) when possible</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -V print disassembled operands symbolically</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -c print argument strings of a core file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -X print no leading addresses or headers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -m don&#x27;t use archive(member) syntax</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -B force Thumb disassembly (ARM objects only)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -q use llvm&#x27;s disassembler (the default)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -Q use otool(1)&#x27;s disassembler</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -mcpu=arg use `arg&#x27; as the cpu for disassembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -j print opcode bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -P print the info plist section as strings</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -C print linker optimization hints</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --version print the version of /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/otool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>-I print the indirect symbol table</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework otool -I dys_ios_framework </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Indirect symbols for (__TEXT,__stubs) 2 entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">address            index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000000007e70    58 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000000007e7c    63 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Indirect symbols for (__DATA_CONST,__got) 1 entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">address            index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000000008000    64 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Indirect symbols for (__DATA,__la_symbol_ptr) 2 entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">address            index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000000000c000    58 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000000000c008    63 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  dys_ios_framework.framework </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="image-20210817173651023" src="/assets/images/image-20210817173651023-1d1fc1b15cafe895d2231f6af4ff9ceb.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="符号生成规则"></a>符号生成规则<a class="hash-link" href="#符号生成规则" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="c语言"></a>C语言<a class="hash-link" href="#c语言" title="Direct link to heading">#</a></h4><p>C的符号生成规则比较简单，一般的符号都是在函数名上加上下划线，比如main.c里包含mian和mylog两个C函数，对应符号如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  link-test nm a.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  link-test nm b.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 D _x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000004 D _y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  link-test nm a.out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100008008 d __dyld_private</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100000000 T __mh_execute_header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100003f10 T _foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100003f30 T _main</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100008010 D _x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100008014 D _y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U dyld_stub_binder</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="c"></a>C++<a class="hash-link" href="#c" title="Direct link to heading">#</a></h4><p>C++因为支持命名空间，函数重载等高级特性，为了避免符号冲突，所以编译器对C++符号做了Symbol Mangling(不同编译器的规则不一样)。</p><p>举个例子：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace MyNameSpace {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    class MyClass{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        static int myFunc(int);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        static double myFunc(double);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>编译后，分别对应符号</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-➜ codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000008 T __ZN11MyNameSpace7MyClass6myFuncEd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T __ZN11MyNameSpace7MyClass6myFuncEi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>其实，Symbol Mangling规则并不难，刚刚的两个符号是按照如下规则生成的：</p><ul><li>以_Z开头</li><li>跟着C语言的保留字符串N</li><li>对于namespace等嵌套的名称，接下依次拼接名称长度，名称</li><li>然后是结束字符E</li><li>最后是参数的类型，比如int是i，double是d</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="objective-c-1"></a>Objective C<a class="hash-link" href="#objective-c-1" title="Direct link to heading">#</a></h4><p>Objective C的符号更简单一些，比如方法的符号是<code>+-[Class_name(category_name) method:name:]</code>，除了这些，Objective C还会生成一些Runtime元数据的符号</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-➜ codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_BTDRouteBuilder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_BTDRouter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_UIViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000458 S _OBJC_CLASS_$_ViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_UIViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000480 S _OBJC_METACLASS_$_ViewController</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>所以当链接的时候类找不到了，会报错符号<em>OBJC_CLASS</em>$_CLASSNAME找不到</p><p><img alt="在这里插入图片描述" src="/assets/images/20191130225957319-3877695318309d16b4a3256be9bb46c7.png"></p><p>当然，如果类的符号没有被裁减掉，运行时就用<em>OBJC_CLASS</em>$_CLASSNAME作为参数，通过dlsym来获取类指针。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="符号的种类"></a>符号的种类<a class="hash-link" href="#符号的种类" title="Direct link to heading">#</a></h3><p>按照不同的方式可以对符号进行不同的分类，比如按照可见性划分</p><ul><li>全局符号(Global Symbol) 对其他编译单元可见</li><li>本地符号(Local Symbol) 只对当前编译单元可见</li></ul><p>按照位置划分</p><ul><li>外部符号，符号不在当前文件，需要ld或者dyld在链接的时候解决</li><li>非外部符号，即当前文件内的符号</li></ul><p>nm命令里的小写字母对应着本地符号，大写字母表示全局符号；U表示undefined，即未定义的外部符号</p><p><img alt="在这里插入图片描述" src="/assets/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9sZW9tb2JpbGVkZXZlbG9wZXIuYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70-1ef08279f0a31d06741bb2d5e87d98e9.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="可见性"></a>可见性<a class="hash-link" href="#可见性" title="Direct link to heading">#</a></h3><p>有个很常见的case，就是你有1000个函数，但只有10个函数是公开的，希望最后生成的动态库里不包含其他990个函数的符号，这时候就可以用clang的attribute来实现</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">//符号可被外部链接</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">__attribute__((visibility(&quot;default&quot;)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">//符号不会被放到Dynamic Symbol Table里，意味着不可以再被其他编译单元链接</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">__attribute__((visibility(&quot;hidden&quot;)))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>clang来提供了一个全局的开关，用来设置符号的默认可见性：</p><p><img alt="在这里插入图片描述" src="/assets/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9sZW9tb2JpbGVkZXZlbG9wZXIuYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70-20210817180018350-2bb401d8c4f16c284117bd8eca376271.png"></p><p>控制符号的可见性</p><p><a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/SymbolVisibility.html#//apple_ref/doc/uid/TP40001670-CJBGBHEJ" target="_blank" rel="noopener noreferrer">Apple： Controlling Symbol Visibility</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="xcode"></a>xcode<a class="hash-link" href="#xcode" title="Direct link to heading">#</a></h2><p><a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/0-Introduction/introduction.html#//apple_ref/doc/uid/TP40003931-CH3-SW45" target="_blank" rel="noopener noreferrer">Xcode Build System Guide</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="generate-debug-symbols"></a>Generate Debug Symbols<a class="hash-link" href="#generate-debug-symbols" title="Direct link to heading">#</a></h3><p>调试符号是在编译时生成的。在Xcode中查看构建过程，可以发现，当<code>Generate Debug Symbols</code>选项设置为<code>YES</code>时，每个源文件在编译成.o文件时，编译参数多了<code>-g</code>和<code>-gmodules</code>两项。</p><p>Clang文档对<code>-g</code>的描述是：</p><blockquote><p>Generate complete debug info.</p></blockquote><p>和GDB一样。</p><p><img alt="image-20210818162758978" src="/assets/images/image-20210818162758978-e36e9c986837ddaecfa3a6c0b06fa728.png"></p><p><img alt="image-20210818162900920" src="/assets/images/image-20210818162900920-1d49bf24bb034a06b608c9e849c0f681.png"></p><p>是否产生调试符号</p><p>当Generate Debug Symbols设置为YES时，编译产生的.o文件会大一些，当然最终生成的可执行文件也大一些（亲测如此）</p><p>当Generate Debug Symbols设置为NO的时候，在Xcode中设置的断点不会中断。但是在程序中打印 [NSThread callStackSymbols]，依然可以看到类名和方法名</p><p>在程序崩溃时，也可以得到带有类名和方法名的函数调用栈</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">9   QQLiveInternational 0x00000001069c2515 -[QVNUICustomView layoutSubviews] + 3253</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>结论：Debug/Release 均打开</p><p>新建一个工程，Xcode默认帮我们设置YES。</p><p><img alt="image-20210818163131797" src="/assets/images/image-20210818163131797-ceab2aaafd91c90915af248dcd2d1310.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="debug-information-level"></a>Debug Information Level<a class="hash-link" href="#debug-information-level" title="Direct link to heading">#</a></h3><p>调试符号携带的信息等级</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Debug Information Level` 默认值为 `Compiler default`，另一个选项是 `Line tables only</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>Generate Debug Symbols</code> = YES 的前提下，如果选择 <code>Line tables only</code>，调试信息带有函数名、文件名和行号，但是不包含其他数据（比如局部变量和函数参数）。所以断点可以工作，但是无法在 lldb 中查看局部变量的值（亲测如此）</p><p>当我把<code>Debug Information Level</code>设置为<code>Line tables only</code>的时候，然后构建app，每个源文件在编译时，都多了一个编译参数：<code>-gline-tables-only</code></p><p>Clang的文档中这样解释<code>-gline-tables-only</code>：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Generate line number tables only.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">This kind of debug info allows to obtain stack traces with function names, file names and line numbers (by such tools as gdb or addr2line). It doesn’t contain any other data (e.g. description of local variables or function parameters).</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Xcode默认</p><p><img alt="image-20210818163242245" src="/assets/images/image-20210818163242245-d09b3cce13ba50b06f1a91e90b89740f.png"></p><p>相对于<code>Compiler default</code> 才减少1KB。</p><p><img alt="image-20210818163451104" src="/assets/images/image-20210818163451104-d4834560feeed124a83d8970ec2a2c5e.png"></p><p>结论是使用xcode默认：Compiler default</p><p><img alt="image-20210818163636557" src="/assets/images/image-20210818163636557-600c28ab991f350a65d2c2fb633db1fb.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deployment-postprocessing和strip-linked-product"></a>Deployment Postprocessing和Strip Linked Product<a class="hash-link" href="#deployment-postprocessing和strip-linked-product" title="Direct link to heading">#</a></h3><p>如果把<strong>调试符号</strong>裁剪掉(Deployment Postprocessing选择为YES)，那么文件里的断点会失效，是因为符号被去除了，去除符号的开关被打开了：</p><p><img alt="image-20210818145015363" src="/assets/images/image-20210818145015363-d38115468c80374ee86e8f4070cd8abd.png"></p><p><img alt="image-20210818151222560" src="/assets/images/image-20210818151222560-7c52ece30976a6cea01b2b97383a8974.png"></p><p>可以断点，包变小 no-85kb</p><p><img alt="image-20210818155635012" src="/assets/images/image-20210818155635012-820c1b8637b492d94d122b214bab7b6f.png"></p><p>无法断点，包变大 yes-99kb</p><p><img alt="image-20210818155656805" src="/assets/images/image-20210818155656805-2b0e3f916ebf0cc6980ec171d348272e.png"></p><p>Strip Linked Product 选项在 Deployment Postprocessing 设置为 YES 的时候才生效，而在 Archive 的时候 Xcode 总是会把 Deployment Postprocessing 设置为 YES 。所以我们可以打开 Strip Linked Product 并且把 Deployment Postprocessing 设置为 NO，而不用担心调试的时候会影响断点和符号化，同时打包的时候又会自动去除符号信息。<strong>这个选项是默认打开的</strong>。</p><ol><li>调试的时候使用断点。</li><li>发布的时候不使用断点，减少体积。</li></ol><p>Deployment Postprocessing设置为yes</p><p><img alt="image-20210818165712971" src="/assets/images/image-20210818165712971-80d7dc963430ef7a3e0336278739ff4e.png"></p><p>这个section明显变大。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Segment __LLVM: 32768</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Section __bundle: 17863</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    total 17863</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Segment __LLVM: 16384</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Section __bundle: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    total 1 </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>mach-o 验证</p><p><img alt="image-20210818165945552" src="/assets/images/image-20210818165945552-1e2ccf327268307f4ded1783dcdf92c4.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="symbols-hidden-by-default"></a>Symbols Hidden by Default<a class="hash-link" href="#symbols-hidden-by-default" title="Direct link to heading">#</a></h3><p><a href="https://orangejuiceliberationfront.com/hiding-symbols-in-static-libraries-with-xcode-or-cmake/" target="_blank" rel="noopener noreferrer">https://orangejuiceliberationfront.com/hiding-symbols-in-static-libraries-with-xcode-or-cmake/</a></p><p>Clang flag <code>-fvisibility=hidden</code>).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="exported-symbols-file"></a>Exported Symbols File<a class="hash-link" href="#exported-symbols-file" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="动态库的符号表"></a>动态库的符号表<a class="hash-link" href="#动态库的符号表" title="Direct link to heading">#</a></h4><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="实验一：dynamic-library-指定exported-symbols-file"></a>实验一：Dynamic Library 指定Exported Symbols File<a class="hash-link" href="#实验一：dynamic-library-指定exported-symbols-file" title="Direct link to heading">#</a></h4><p><img alt="image-20210817152615737" src="/assets/images/image-20210817152615737-4837dafc0d7a611b9198129411aa1012.png"></p><p><img alt="image-20210817152556062" src="/assets/images/image-20210817152556062-20877565b51e255ca5411b191ded231c.png"></p><p>nm -g 是全局符号，并不是导出符号。注意！</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm -g /Users/dingyusong/Library/Developer/Xcode/DerivedData/dys_ios_framework_demo-bqyyimtnpptyoreaoutikbgxbvqm/Build/Products/Release-iphoneos/dys_ios_framework.framework/dys_ios_framework</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _NSLog</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">000000000000c120 D _OBJC_CLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">000000000000c0f8 D _OBJC_METACLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U ___CFConstantStringClassReference</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000007ef8 R _dys_ios_frameworkVersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000007eb8 R _dys_ios_frameworkVersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000007e04 T _my_c_print</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000007e10 T _my_c_print_in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U dyld_stub_binder</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>在Dynamic Loader Info 的 Export Info里面查看。结果只有_my_c_print.</p><p><img alt="image-20210817152435081" src="/assets/images/image-20210817152435081-fcfae706868ecd53289ea03048c6fc67.png"></p><p>demo编译出错，因为找不到符号表。</p><p><img alt="image-20210817152747697" src="/assets/images/image-20210817152747697-e1b722dbae55d7a154e5c009285769f7.png"></p><p>因为只导出了<code>_my_c_print</code>所有其他的符号找不到。所以要给别人使用需要导出来</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="实验二：static-library-指定exported-symbols-file"></a>实验二：Static Library 指定Exported Symbols File<a class="hash-link" href="#实验二：static-library-指定exported-symbols-file" title="Direct link to heading">#</a></h4><p><img alt="image-20210817153332046" src="/assets/images/image-20210817153332046-1d200a58dc68418f1aeccb6e406672e9.png"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm -g /Users/dingyusong/Library/Developer/Xcode/DerivedData/dys_ios_framework_demo-bqyyimtnpptyoreaoutikbgxbvqm/Build/Products/Release-iphoneos/dys_ios_framework.framework/dys_ios_framework</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework_vers.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000040 R _dys_ios_frameworkVersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 R _dys_ios_frameworkVersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helloc.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _my_c_print</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helloc2.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _my_c_print_in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DYSFrameWorkClass.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _NSLog</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000250 T _OBJC_CLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000228 T _OBJC_METACLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U ___CFConstantStringClassReference</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _my_c_print_in</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>静态库指定export_symbols,在上面的情况下也能正常运行，说明export_symbols没问题。</p><p>也就是说，如果设置了 <code>EXPORTED_SYMBOLS_FILE</code> 配置项，那么不在 <code>EXPORTED_SYMBOLS_FILE</code> 中的符号，就会被认为是 <code>__private_extern__</code> 的。</p><p>总结：EXPORTED_SYMBOLS_FILE 不能减小文件体积。只是会隐藏符号，安全性有所提升。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="这些符号是怎么被用到的？"></a>这些符号是怎么被用到的？<a class="hash-link" href="#这些符号是怎么被用到的？" title="Direct link to heading">#</a></h2><p>动态库的“符号”是怎么被用到的？</p><p>可以想象，如果可执行文件 A 想要调用动态库中的一个函数 B，A 在静态的编译链接完成后，并不知道 B 函数在内存中的地址。B 函数的地址也是运行时计算得到的。这个过程叫做“绑定”。</p><p>Export Info 中的信息就是必不可少的一环。</p><p>作者：卖萌凉
链接：<a href="https://www.jianshu.com/p/675756173a6a" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/675756173a6a</a>
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="静态库的符号表"></a>静态库的符号表<a class="hash-link" href="#静态库的符号表" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  rzpaas_example_ios.app.dSYM symbolicatecrash path_to_crash.log  -d path_to_dysm  &gt; 3-361</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>path_to_dysm 是到这一级别Contents/Resources/DWARF/RZPaas_iOS。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  rzpaas_example_ios.app.dSYM symbolicatecrash --help</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">usage: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /Applications/Xcode.app/Contents/SharedFrameworks/DVTFoundation.framework/Versions/A/Resources/symbolicatecrash [--help] [--dsym=DSYM] [--output OUTPUT_FILE] &lt;LOGFILE&gt; [SYMBOL_PATH ...]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;LOGFILE&gt;                   The crash log to be symbolicated. If &quot;-&quot;, then the log will be read from stdin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;SYMBOL_PATH&gt;               Additional search paths in which to search for symbol rich binaries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -o | --output &lt;OUTPUT_FILE&gt; The symbolicated log will be written to OUTPUT_FILE. Defaults to &quot;-&quot; (i.e. stdout) if not specified</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -d | --dsym &lt;DSYM_BUNDLE&gt;   Adds additional dSYM that will be consulted if and when a binary&#x27;s UUID matches (may be specified more than once)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -h | --help                 Display this help message</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v | --verbose              Enables additional output</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  rzpaas_example_ios.app.dSYM symbolicatecrash &#x27;/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios  2021-8-17, 3-36 PM.crash&#x27;  -d &#x27;/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM&#x27;  &gt; 3-361                                </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS matches adc694af3f503bf697d3bca32a5a637a (arm64)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 4d6dd6dd22e438589a0c3cb77c2f13d6</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 9c2d6e302482364380a345930c02edc0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 5fffb96439d63ccfbd34c6ca4a148d1a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 453c20abba283cf79e965eb2601a2bcc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 5aa2ff118f7f336aa3dbcff65d5a9f7d</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match ddf3cfa7757f307480a15f0cbbd8797e</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 0236b078e7873935b59d9b0bea3fe2dd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 2fef5447a07b360bb825f9852e16263b</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match b9b7173337913116a5e26159fabf74a2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 186f3a78108a3057a67e800a88ebff00</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 777f51fcef37388b8985228e98115207</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 3bbe17ac597b3b7991ac21a5523e7bd7</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 5d682540a28131a5a8a4a2c18b3bb3fc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Checking “/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Desktop/duobei/crashes/20210817142421/rzpaas_example_ios.app.dSYM/RZPaas_iOS.framework.dSYM/Contents/Resources/DWARF/RZPaas_iOS does not match 9cfebf14879b3aafa29dec1cdba54826</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## Warning: Unable to symbolicate from required binary: /Users/dingyusong/Library/Developer/Xcode/iOS DeviceSupport/14.6 (18F72)/Symbols/System/Library/Frameworks/CFNetwork.framework/CFNetwork</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>dSYM:Debug Symbol 调试符号表。</p><p>这些Debug符号表要么被存储在编译好的二进制中，要么单独存储在Debug Symbol文件中(也就是dSYM文件)：一般来说，debug模式构建的App会把Debug符号表存储在编译好的二进制中，而release模式构建的App会把Debug符号表存储在dSYM文件中以节省二进制体积。</p><p>DWARF，即 <strong><em>Debug With Arbitrary Record Format</em></strong> ，是一个标准调试信息格式，即调试信息。单独保存下来就是dSYM文件，即 <strong><em>Debug Symbol File</em></strong> 。使用MachOView打开一个二进制文件，就能看到很多DWARF的section，如 <strong><em><strong>DWARF,</strong>debug_str</em></strong>, <strong><em><strong>DWARF,</strong>debug_info</em></strong>, <strong><em><strong>DWARF,</strong>debug_names</em></strong> 等。</p><p>作者：超越杨超越
链接：<a href="https://juejin.cn/post/6844904164208689166" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6844904164208689166</a>
来源：掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="debug-information-format"></a>Debug Information Format<a class="hash-link" href="#debug-information-format" title="Direct link to heading">#</a></h3><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="oc符号冲突"></a>OC符号冲突<a class="hash-link" href="#oc符号冲突" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm -a /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw1.framework/fw1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 01 0000    SO</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 01 0000    SO</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000024 - 00 0000   FUN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000024 - 01 0000 ENSYM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003ef0 - 01 0000 BNSYM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003ef0 t -[FW1Obj1 showHello]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003ef0 - 01 0000   FUN -[FW1Obj1 showHello]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000    SO /Users/dingyusong/Documents/tmp/framework-dump/framework-demo/fw1/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000    SO /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Intermediates.noindex/framework-demo.build/Debug-iphonesimulator/fw1.build/DerivedSources/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">000000006135b92c - 03 0001   OSO /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Intermediates.noindex/framework-demo.build/Debug-iphonesimulator/fw1.build/Objects-normal/x86_64/FW1Obj1.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">000000006135b92c - 03 0001   OSO /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Intermediates.noindex/framework-demo.build/Debug-iphonesimulator/fw1.build/Objects-normal/x86_64/fw1_vers.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000    SO FW1Obj1.m</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000  GSYM _OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080c8 S _OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000  GSYM _OBJC_METACLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080a0 S _OBJC_METACLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f38 s __OBJC_$_INSTANCE_METHODS_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008050 s __OBJC_CLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008050 - 0f 0000 STSYM __OBJC_CLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008008 s __OBJC_METACLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008008 - 0f 0000 STSYM __OBJC_METACLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080f0 d __dyld_private</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000  GSYM _fw1VersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f80 S _fw1VersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000  GSYM _fw1VersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f50 S _fw1VersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U dyld_stub_binder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 - 00 0000    SO fw1_vers.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw2.framework/fw2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003ef0 t -[FW2Obj1 showHello]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008158 s _OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000081a8 S _OBJC_CLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008130 s _OBJC_METACLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008180 S _OBJC_METACLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f38 s __OBJC_$_INSTANCE_METHODS_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008050 s __OBJC_CLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080e0 s __OBJC_CLASS_RO_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008008 s __OBJC_METACLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008098 s __OBJC_METACLASS_RO_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000081d0 d __dyld_private</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f80 s _fw2VersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f50 s _fw2VersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U dyld_stub_binder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ otool -L /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/framework-demo.app/framework-demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/framework-demo.app/framework-demo:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @rpath/fw2.framework/fw2 (compatibility version 1.0.0, current version 1.0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @rpath/fw1.framework/fw1 (compatibility version 1.0.0, current version 1.0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /System/Library/Frameworks/Foundation.framework/Foundation (compatibility version 300.0.0, current version 1775.118.101)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1292.100.5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation (compatibility version 150.0.0, current version 1775.118.101)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /System/Library/Frameworks/UIKit.framework/UIKit (compatibility version 1.0.0, current version 4218.1.100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ jtool2 -L /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/framework-demo.app/framework-demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/framework-demo.app/framework-demo:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @rpath/fw2.framework/fw2 (compatibility version 1.0.0, current version 1.0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @rpath/fw1.framework/fw1 (compatibility version 1.0.0, current version 1.0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /System/Library/Frameworks/Foundation.framework/Foundation (compatibility version 300.0.0, current version 1775.118.101)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1292.100.5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation (compatibility version 150.0.0, current version 1775.118.101)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /System/Library/Frameworks/UIKit.framework/UIKit (compatibility version 1.0.0, current version 4218.1.100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="不设置exported-symbols-file"></a>不设置Exported Symbols File<a class="hash-link" href="#不设置exported-symbols-file" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw2.framework/fw2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003ef0 t -[FW2Obj1 showHello]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008158 S _OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000081a8 S _OBJC_CLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008130 S _OBJC_METACLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008180 S _OBJC_METACLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f38 s __OBJC_$_INSTANCE_METHODS_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008050 s __OBJC_CLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080e0 s __OBJC_CLASS_RO_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008008 s __OBJC_METACLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008098 s __OBJC_METACLASS_RO_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000081d0 d __dyld_private</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f80 S _fw2VersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f50 S _fw2VersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U dyld_stub_binder</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>0000000000008130 S _OBJC_METACLASS_$_FW1Obj1</code></p><p>不做控制是这样的</p><p><img alt="image-20210906152330176" src="/assets/images/image-20210906152330176-14de12ce0a96d7ac2fda091e7c891aab.png"></p><p>另外一个库也定义了FW1Obj1这个类</p><p><img alt="image-20210906152444518" src="/assets/images/image-20210906152444518-113e3db74fe7824476bf4f68d7ceaed5.png"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm -gU /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw2.framework/fw2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008158 S _OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000081a8 S _OBJC_CLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008130 S _OBJC_METACLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008180 S _OBJC_METACLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f80 S _fw2VersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f50 S _fw2VersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm -gU /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw1.framework/fw1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080c8 S _OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080a0 S _OBJC_METACLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f80 S _fw1VersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f50 S _fw1VersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm -gu /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/framework-demo.app/framework-demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_NSStringFromClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_CLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_CLASS_$_UIResponder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_CLASS_$_UISceneConfiguration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_CLASS_$_UIViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_METACLASS_$_UIResponder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_METACLASS_$_UIViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_UIApplicationMain</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">___CFConstantStringClassReference</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">__objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_alloc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_autoreleasePoolPop</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_autoreleasePoolPush</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_autoreleaseReturnValue</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_msgSend</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_msgSendSuper2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_opt_class</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_opt_new</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_release</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_retainAutoreleasedReturnValue</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_objc_storeStrong</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dyld_stub_binder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>可以看到我们的demo需要<code>_OBJC_CLASS_$_FW1Obj1</code>符号，而fw2和fw2都提供 所以会报错，甚至发生运行时错误</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">objc[5634]: Class FW1Obj1 is implemented in both /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw1.framework/fw1 (0x1076a70c8) and /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw2.framework/fw2 (0x107693158). One of the two will be used. Which one is undefined.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2021-09-06 15:24:58.551334+0800 framework-demo[5634:2991417] -[FW1Obj1 showHello]: unrecognized selector sent to instance 0x6000005804e0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2021-09-06 15:24:58.556478+0800 framework-demo[5634:2991417] *** Terminating app due to uncaught exception &#x27;NSInvalidArgumentException&#x27;, reason: &#x27;-[FW1Obj1 showHello]: unrecognized selector sent to instance 0x6000005804e0&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*** First throw call stack:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    0   CoreFoundation                      0x00007fff20422fba __exceptionPreprocess + 242</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    1   libobjc.A.dylib                     0x00007fff20193ff5 objc_exception_throw + 48</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    2   CoreFoundation                      0x00007fff20431d2f +[NSObject(NSObject) instanceMethodSignatureForSelector:] + 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    3   CoreFoundation                      0x00007fff204274cf ___forwarding___ + 1455</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    4   CoreFoundation                      0x00007fff204297a8 _CF_forwarding_prep_0 + 120</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    5   framework-demo                      0x0000000107419ed9 -[ViewController viewDidLoad] + 89</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    6   UIKitCore                           0x00007fff23f806a9 -[UIViewController _sendViewDidLoadWithAppearanceProxyObjectTaggingEnabled] + 88</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    7   UIKitCore                           0x00007fff23f8504c -[UIViewController loadViewIfRequired] + 1084</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    8   UIKitCore                           0x00007fff23f85436 -[UIViewController view] + 27</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    9   UIKitCore                           0x00007fff246ffc73 -[UIWindow addRootViewControllerViewIfPossible] + 313</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    10  UIKitCore                           0x00007fff246ff362 -[UIWindow _updateLayerOrderingAndSetLayerHidden:actionBlock:] + 219</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    11  UIKitCore                           0x00007fff24700325 -[UIWindow _setHidden:forced:] + 362</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    12  UIKit                               0x00000001096f7748 -[UIWindowAccessibility _orderFrontWithoutMakingKey] + 84</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    13  UIKitCore                           0x00007fff247133a6 -[UIWindow _mainQueue_makeKeyAndVisible] + 42</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    14  UIKitCore                           0x00007fff24951c05 -[UIWindowScene _makeKeyAndVisibleIfNeeded] + 202</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    15  UIKitCore                           0x00007fff23b0e80c +[UIScene _sceneForFBSScene:create:withSession:connectionOptions:] + 1671</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    16  UIKitCore                           0x00007fff246c2df9 -[UIApplication _connectUISceneFromFBSScene:transitionContext:] + 1114</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    17  UIKitCore                           0x00007fff246c3128 -[UIApplication workspace:didCreateScene:withTransitionContext:completion:] + 289</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    18  UIKitCore                           0x00007fff241a4ab4 -[UIApplicationSceneClientAgent scene:didInitializeWithEvent:completion:] + 358</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    19  FrontBoardServices                  0x00007fff25a1b40b -[FBSScene _callOutQueue_agent_didCreateWithTransitionContext:completion:] + 398</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    20  FrontBoardServices                  0x00007fff25a43e55 __94-[FBSWorkspaceScenesClient createWithSceneID:groupID:parameters:transitionContext:completion:]_block_invoke.176 + 102</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    21  FrontBoardServices                  0x00007fff25a28f12 -[FBSWorkspace _calloutQueue_executeCalloutFromSource:withBlock:] + 209</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    22  FrontBoardServices                  0x00007fff25a43b28 __94-[FBSWorkspaceScenesClient createWithSceneID:groupID:parameters:transitionContext:completion:]_block_invoke + 352</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    23  libdispatch.dylib                   0x00000001076b774e _dispatch_client_callout + 8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    24  libdispatch.dylib                   0x00000001076ba656 _dispatch_block_invoke_direct + 295</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    25  FrontBoardServices                  0x00007fff25a695d0 __FBSSERIALQUEUE_IS_CALLING_OUT_TO_A_BLOCK__ + 30</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    26  FrontBoardServices                  0x00007fff25a692b6 -[FBSSerialQueue _targetQueue_performNextIfPossible] + 433</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    27  FrontBoardServices                  0x00007fff25a6977b -[FBSSerialQueue _performNextFromRunLoopSource] + 22</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    28  CoreFoundation                      0x00007fff20390ede __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 17</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    29  CoreFoundation                      0x00007fff20390dd6 __CFRunLoopDoSource0 + 180</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    30  CoreFoundation                      0x00007fff20390300 __CFRunLoopDoSources0 + 340</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    31  CoreFoundation                      0x00007fff2038a9f7 __CFRunLoopRun + 875</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    32  CoreFoundation                      0x00007fff2038a1a7 CFRunLoopRunSpecific + 567</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    33  GraphicsServices                    0x00007fff2b874d85 GSEventRunModal + 139</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    34  UIKitCore                           0x00007fff246c14df -[UIApplication _run] + 912</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    35  UIKitCore                           0x00007fff246c639c UIApplicationMain + 101</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    36  framework-demo                      0x000000010741a1a2 main + 114</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    37  libdyld.dylib                       0x00007fff2025abbd start + 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    38  ???                                 0x0000000000000001 0x0 + 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">libc++abi: terminating with uncaught exception of type NSException</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*** Terminating app due to uncaught exception &#x27;NSInvalidArgumentException&#x27;, reason: &#x27;-[FW1Obj1 showHello]: unrecognized selector sent to instance 0x6000005804e0&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">terminating with uncaught exception of type NSException</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CoreSimulator 757.5 - Device: iPhone 12 (76310195-292B-446A-BF49-D88197A7E4A7) - Runtime: iOS 14.5 (18E182) - DeviceType: iPhone 12</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>在OC下如果要捣蛋的话，定义一个和三方库名字相同的类就能摧毁他们！</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="设置exported-symbols-file-为"></a>设置Exported Symbols File 为<a class="hash-link" href="#设置exported-symbols-file-为" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_CLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OBJC_METACLASS_$_FW2Obj1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="image-20210906151319615" src="/assets/images/image-20210906151319615-c7267e41485da8341eabbed0f1daa5b2.png"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  ~ nm /Users/dingyusong/Library/Developer/Xcode/DerivedData/framework-demo-gpomogmayijsfpclllhlbeetrizz/Build/Products/Debug-iphonesimulator/fw2.framework/fw2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003ef0 t -[FW2Obj1 showHello]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008158 s _OBJC_CLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000081a8 S _OBJC_CLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008130 s _OBJC_METACLASS_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008180 S _OBJC_METACLASS_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f38 s __OBJC_$_INSTANCE_METHODS_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008050 s __OBJC_CLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000080e0 s __OBJC_CLASS_RO_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008008 s __OBJC_METACLASS_RO_$_FW1Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000008098 s __OBJC_METACLASS_RO_$_FW2Obj1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">00000000000081d0 d __dyld_private</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f80 s _fw2VersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000003f50 s _fw2VersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U dyld_stub_binder</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>0000000000008130 s _OBJC_METACLASS_$_FW1Obj1</code></p><p><img alt="image-20210906151720171" src="/assets/images/image-20210906151720171-717b3c5b5dfb0d6d5f9c7a39da3d3de9.png"></p><p><img alt="image-20210906151913464" src="/assets/images/image-20210906151913464-00237b7b43c5a7fe4ceff0fb22107bfb.png"></p><p>将几个不想导出的符号刷选出来</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> 9843  nm -jgU /Users/dingyusong/Library/Developer/Xcode/DerivedData/tosee-bnxlmdxecdrxoyhkhhqgpchfrcew/Build/Products/Debug-iphoneos/tosee.app/Frameworks/RZGMS.framework/RZGMS | grep RZDataCollectManager &gt;&gt; symbol.strip</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> 9844  nm -jgU /Users/dingyusong/Library/Developer/Xcode/DerivedData/tosee-bnxlmdxecdrxoyhkhhqgpchfrcew/Build/Products/Debug-iphoneos/tosee.app/Frameworks/RZGMS.framework/RZGMS | grep RZUUIDHelper &gt;&gt; symbol.strip</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li><a href="https://www.jianshu.com/p/11710e7ab661" target="_blank" rel="noopener noreferrer">Xcode中和symbols有关的几个设置</a></li><li><a href="https://www.jianshu.com/p/675756173a6a" target="_blank" rel="noopener noreferrer">从 Exported Symbols 应用于包大小优化说到符号绑定</a></li><li><a href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/CodeFootprint/Articles/ReducingExports.html" target="_blank" rel="noopener noreferrer">Code Size Performance Guidelines</a></li><li><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Tasks/ExportingInterfaces.html" target="_blank" rel="noopener noreferrer">Framework Programming Guide</a></li><li><a href="https://juejin.cn/post/6844904164208689166" target="_blank" rel="noopener noreferrer">iOS中符号的那些事儿</a></li><li><a href="https://github.com/Tencent/matrix/wiki/About-macOS-&amp;-iOS-symbol" target="_blank" rel="noopener noreferrer">https://github.com/Tencent/matrix/wiki/About-macOS-&amp;-iOS-symbol</a></li><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fblog.csdn.net%2FHello_Hwc%2Farticle%2Fdetails%2F103330564" target="_blank" rel="noopener noreferrer">深入理解Symbol</a></li><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Forangejuiceliberationfront.com%2Fhiding-symbols-in-static-libraries-with-xcode-or-cmake%2F" target="_blank" rel="noopener noreferrer">Hiding Symbols in Static Libraries with Xcode or CMake</a></li><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FTencent%2Fmatrix%2Fwiki%2FAbout-macOS-%26-iOS-symbol" target="_blank" rel="noopener noreferrer">About macOS &amp; iOS symbol</a></li><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fsatanwoo.github.io%2F2018%2F12%2F22%2FLD-1%2F" target="_blank" rel="noopener noreferrer">通过Xcode 10链接libstdc++来深入分析tbd文件</a></li><li><a href="https://juejin.cn/post/6844904164208689166" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6844904164208689166</a></li><li><a href="https://blog.csdn.net/Hello_Hwc/article/details/103330564" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/Hello_Hwc/article/details/103330564</a></li><li><a href="https://github.com/Tencent/matrix/wiki/About-macOS-&amp;-iOS-symbol" target="_blank" rel="noopener noreferrer">https://github.com/Tencent/matrix/wiki/About-macOS-&amp;-iOS-symbol</a></li><li><a href="https://h3adsh0tzz.com/2020/01/macho-helper-toolset/" target="_blank" rel="noopener noreferrer">Mach-O Helper Toolset.</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="dys-typora-open://mine/survival/docs/编程基础/编译原理/符号表.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objective-c" class="table-of-contents__link">Objective-C</a></li><li><a href="#mach-o" class="table-of-contents__link">Mach-O</a><ul><li><a href="#mach-header" class="table-of-contents__link">Mach header</a></li><li><a href="#load-commands" class="table-of-contents__link">Load Commands</a></li><li><a href="#symbol-table" class="table-of-contents__link">Symbol Table</a></li><li><a href="#dynamic-symbol-table" class="table-of-contents__link">Dynamic Symbol Table</a></li><li><a href="#string-table" class="table-of-contents__link">String Table</a></li><li><a href="#otool" class="table-of-contents__link">otool</a></li><li><a href="#符号生成规则" class="table-of-contents__link">符号生成规则</a></li><li><a href="#符号的种类" class="table-of-contents__link">符号的种类</a></li><li><a href="#可见性" class="table-of-contents__link">可见性</a></li></ul></li><li><a href="#xcode" class="table-of-contents__link">xcode</a><ul><li><a href="#generate-debug-symbols" class="table-of-contents__link">Generate Debug Symbols</a></li><li><a href="#debug-information-level" class="table-of-contents__link">Debug Information Level</a></li><li><a href="#deployment-postprocessing和strip-linked-product" class="table-of-contents__link">Deployment Postprocessing和Strip Linked Product</a></li><li><a href="#symbols-hidden-by-default" class="table-of-contents__link">Symbols Hidden by Default</a></li><li><a href="#exported-symbols-file" class="table-of-contents__link">Exported Symbols File</a></li></ul></li><li><a href="#这些符号是怎么被用到的？" class="table-of-contents__link">这些符号是怎么被用到的？</a><ul><li><a href="#debug-information-format" class="table-of-contents__link">Debug Information Format</a></li></ul></li><li><a href="#oc符号冲突" class="table-of-contents__link">OC符号冲突</a><ul><li><a href="#不设置exported-symbols-file" class="table-of-contents__link">不设置Exported Symbols File</a></li><li><a href="#设置exported-symbols-file-为" class="table-of-contents__link">设置Exported Symbols File 为</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.9888532b.js"></script>
<script src="/runtime~main.73fb2e0e.js"></script>
<script src="/main.a2e30791.js"></script>
<script src="/1.fa235d9f.js"></script>
<script src="/2.8423217f.js"></script>
<script src="/257.8905f2ed.js"></script>
<script src="/258.3860215e.js"></script>
<script src="/935f2afb.ce536a1e.js"></script>
<script src="/17896441.d8a5f7af.js"></script>
<script src="/dfa55b42.3934e631.js"></script>
</body>
</html>