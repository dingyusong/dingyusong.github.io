<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Blog Atom Feed"><title data-react-helmet="true">CMake | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="CMake | My Site"><meta data-react-helmet="true" name="description" content="CMake"><meta data-react-helmet="true" property="og:description" content="CMake"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/编程基础/计算机系统基础/1-程序/1-构建/CMake/CMake"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/编程基础/计算机系统基础/1-程序/1-构建/CMake/CMake"><link rel="stylesheet" href="/styles.8cfbcdec.css">
<link rel="preload" href="/styles.9888532b.js" as="script">
<link rel="preload" href="/runtime~main.73fb2e0e.js" as="script">
<link rel="preload" href="/main.a2e30791.js" as="script">
<link rel="preload" href="/1.fa235d9f.js" as="script">
<link rel="preload" href="/2.8423217f.js" as="script">
<link rel="preload" href="/257.8905f2ed.js" as="script">
<link rel="preload" href="/258.3860215e.js" as="script">
<link rel="preload" href="/935f2afb.ce536a1e.js" as="script">
<link rel="preload" href="/17896441.d8a5f7af.js" as="script">
<link rel="preload" href="/86b47624.f254bcf7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/编程基础/编程基础/编程基础">编程基础</a><a class="navbar__item navbar__link" href="/docs/编程语言/编程语言">编程语言</a><a class="navbar__item navbar__link" href="/docs/工具/常用工具">工具</a><a class="navbar__item navbar__link" href="/docs/应用开发/应用开发">应用开发</a><a class="navbar__item navbar__link" href="/docs/Apple/iOS开发/iOS开发">Apple</a><a class="navbar__item navbar__link" href="/docs/音视频/音视频">音视频</a><a class="navbar__item navbar__link" href="/docs/项目/项目">项目</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/编程基础/编程基础/编程基础">编程基础</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/编程语言/编程语言">编程语言</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/工具/常用工具">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/应用开发/应用开发">应用开发</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Apple/iOS开发/iOS开发">Apple</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/音视频/音视频">音视频</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/项目/项目">项目</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">CMake</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cmake"></a>CMake<a class="hash-link" href="#cmake" title="Direct link to heading">#</a></h1><p>[toc]</p><p>源码所在位置</p><p><a href="https://github.com/Kitware/CMake" target="_blank" rel="noopener noreferrer">https://github.com/Kitware/CMake</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="简介"></a>简介<a class="hash-link" href="#简介" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="为何用cmake？"></a>为何用Cmake？<a class="hash-link" href="#为何用cmake？" title="Direct link to heading">#</a></h3><p>在linux环境编写程序，因没有类似于visual studio、vs code等IDE(集成开发环境)，那么如何编译、运行程序呢？一种方法是编写makefile文件，用makefile文件管理程序脚本之间的相互依赖关系，其语法相对比较复杂。另一种有效的方法就是利用cmake工具，自动生成makefile文件。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cmake是什么？"></a>CMake是什么？<a class="hash-link" href="#cmake是什么？" title="Direct link to heading">#</a></h3><p>CMake是一个<strong>跨平台</strong>的安装（编译）工具，可以用简单的语句来描述所有平台的安装(编译过程)。Linux/Ubuntu上基本都预先安装好了cmake工具，用 sudo apt-get install 也可以自动安装。要使用cmake必须在工程的每个文件夹中都编写CMakeLists.txt，尤其注意C、M、L是大写，并且是复数形式。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="基础"></a>基础<a class="hash-link" href="#基础" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="语法"></a>语法<a class="hash-link" href="#语法" title="Direct link to heading">#</a></h3><p><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#cmake-language-variables" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#cmake-language-variables</a></p><p>可以将Cmake理解为一门语言。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="数据"></a>数据<a class="hash-link" href="#数据" title="Direct link to heading">#</a></h4><p>变量设置，变量存取</p><p><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#cmake-language-variables" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#cmake-language-variables</a></p><p>Their values are always of string type, though some commands may interpret the strings as values of other types. </p><p>变量总是String类型。</p><p>参考 - <a href="https://www.cnblogs.com/xianghang123/p/3556425.html" target="_blank" rel="noopener noreferrer">cmake 常用变量和常用环境变量查表手册---整理 .</a></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="内置的变量"></a>内置的变量<a class="hash-link" href="#内置的变量" title="Direct link to heading">#</a></h5><h6><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="variables"></a><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-variables.7.html" target="_blank" rel="noopener noreferrer"><strong>variables</strong></a><a class="hash-link" href="#variables" title="Direct link to heading">#</a></h6><p>9类变量</p><h6><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="env-variables"></a><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-env-variables.7.html" target="_blank" rel="noopener noreferrer"><strong>env-variables</strong></a><a class="hash-link" href="#env-variables" title="Direct link to heading">#</a></h6><p>5类环境变量</p><hr><h6><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="property"></a><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-properties.7.html" target="_blank" rel="noopener noreferrer"><strong>property</strong></a><a class="hash-link" href="#property" title="Direct link to heading">#</a></h6><p>7类property</p><hr><p>变量和property的区别</p><p>A very short and simple way to think about it is that properties are variables scoped to a target。</p><p>Property是作用在target上的variables。</p><p>参考：<a href="https://stackoverflow.com/questions/49958208/what-is-the-difference-between-cmake-variables-and-properties" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/49958208/what-is-the-difference-between-cmake-variables-and-properties</a></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="自定义变量"></a>自定义变量<a class="hash-link" href="#自定义变量" title="Direct link to heading">#</a></h5><p>The set() and unset() commands explicitly set or unset a variable</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">set(var ...) # 没有缓存的变量</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set(Var ... CACHE) # 没有缓存才设置，相当于MakeFile 的 ?=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set(Var ... FORCE) # 强制修改变量 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#eg：set(TTTT tttt) # 使用${TTTT}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><hr><p>字符串操作</p><p><a href="http://cmake.org/cmake/help/v3.21/command/string.html" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/command/string.html</a></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Found Python: /usr/local/Frameworks/Python.framework/Versions/3.9/bin/python3.9 (found version &quot;3.9.6&quot;) found components: Interpreter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Looking for pthread.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Looking for pthread.h - found</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Performing Test CMAKE_HAVE_LIBC_PTHREAD</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Found Threads: TRUE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMake Error at CMakeLists.txt:34 (set_target_properties):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  set_target_properties called with incorrect number of arguments.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Configuring incomplete, errors occurred!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">See also &quot;/Users/dingyusong/Desktop/duobei/rz-logan-oc/build/CMakeFiles/CMakeOutput.log&quot;.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Command line invocation:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /Applications/Xcode.app/Contents/Developer/usr/bin/xcodebuild -project RZLogan.xcodeproj build -target ALL_BUILD -parallelizeTargets -configuration Debug -hideShellScriptEnvironment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">User defaults from command line:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    HideShellScriptEnvironment = YES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    IDEPackageSupportUseBuiltinSCM = YES</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">set_target_properties(${LIB_TARGET_NAME} </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PROPERTIES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CLANG_ENABLE_OBJC_ARC YES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PUBLIC_HEADER &quot;${public_headers}&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># PUBLIC_HEADER ${public_headers}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># CXX_VISIBILITY_PRESET hidden</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># VISIBILITY_INLINES_HIDDEN 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="scope"></a>Scope<a class="hash-link" href="#scope" title="Direct link to heading">#</a></h5><p>变量的作用域</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="运算"></a>运算<a class="hash-link" href="#运算" title="Direct link to heading">#</a></h4><p>数据的运算，拼接</p><p><a href="https://cmake.org/cmake/help/v3.21/command/if.html#condition-syntax" target="_blank" rel="noopener noreferrer">https://cmake.org/cmake/help/v3.21/command/if.html#condition-syntax</a></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="逻辑运算"></a>逻辑运算<a class="hash-link" href="#逻辑运算" title="Direct link to heading">#</a></h5><p><a href="https://cmake.org/cmake/help/v3.21/command/if.html#logic-operators" target="_blank" rel="noopener noreferrer">https://cmake.org/cmake/help/v3.21/command/if.html#logic-operators</a></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="比较运算"></a>比较运算<a class="hash-link" href="#比较运算" title="Direct link to heading">#</a></h5><p><a href="https://cmake.org/cmake/help/v3.21/command/if.html#comparisons" target="_blank" rel="noopener noreferrer">https://cmake.org/cmake/help/v3.21/command/if.html#comparisons</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="控制"></a>控制<a class="hash-link" href="#控制" title="Direct link to heading">#</a></h4><p><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#control-structures" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#control-structures</a></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">if(${PLATFORM} MATCHES &quot;MAC&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    project(RZLogan_macOS)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">else()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    project(RZLogan_iOS)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">endif()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="过程"></a>过程<a class="hash-link" href="#过程" title="Direct link to heading">#</a></h4><p><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#command-definitions" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/manual/cmake-language.7.html#command-definitions</a></p><p>The <a href="https://cmake.org/cmake/help/v3.21/command/macro.html#command:macro" target="_blank" rel="noopener noreferrer"><code>macro()</code></a>/<a href="https://cmake.org/cmake/help/v3.21/command/endmacro.html#command:endmacro" target="_blank" rel="noopener noreferrer"><code>endmacro()</code></a>, and <a href="https://cmake.org/cmake/help/v3.21/command/function.html#command:function" target="_blank" rel="noopener noreferrer"><code>function()</code></a>/<a href="https://cmake.org/cmake/help/v3.21/command/endfunction.html#command:endfunction" target="_blank" rel="noopener noreferrer"><code>endfunction()</code></a> commands delimit code blocks to be recorded for later invocation as commands.</p><p>类似函数，自定义函数，函数调用等</p><p>cmake中的类似的概念叫command。</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="自定义函数"></a>自定义函数<a class="hash-link" href="#自定义函数" title="Direct link to heading">#</a></h5><p><a href="http://cmake.org/cmake/help/v3.21/command/function.html" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/command/function.html</a></p><hr><p><strong>macro</strong></p><p>Start recording a macro for later invocation as a command</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">macro(&lt;name&gt; [&lt;arg1&gt; ...])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;commands&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">endmacro()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Defines a macro named <code>&lt;name&gt;</code> that takes arguments named <code>&lt;arg1&gt;</code>, … Commands listed after macro, but before the matching [<code>endmacro()</code>], are not executed until the macro is invoked.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cmake codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">macro(set_xcode_property TARGET XCODE_PROPERTY XCODE_VALUE XCODE_RELVERSION)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  set(XCODE_RELVERSION_I &quot;${XCODE_RELVERSION}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if(XCODE_RELVERSION_I STREQUAL &quot;All&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    set_property(TARGET ${TARGET} PROPERTY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    XCODE_ATTRIBUTE_${XCODE_PROPERTY} &quot;${XCODE_VALUE}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  else()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    set_property(TARGET ${TARGET} PROPERTY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    XCODE_ATTRIBUTE_${XCODE_PROPERTY}[variant=${XCODE_RELVERSION_I}] &quot;${XCODE_VALUE}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  endif()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">endmacro(set_xcode_property)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="内置函数"></a>内置函数<a class="hash-link" href="#内置函数" title="Direct link to heading">#</a></h5><p><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-commands.7.html" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/manual/cmake-commands.7.html</a></p><hr><p><strong>打印信息</strong></p><p>Log a message.</p><p>Synopsis</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">General messages</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  message([&lt;mode&gt;] &quot;message text&quot; ...)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Reporting checks</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  message(&lt;checkState&gt; &quot;message text&quot; ...)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="环境"></a>环境<a class="hash-link" href="#环境" title="Direct link to heading">#</a></h3><p>环境变量，环境过程。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="解释执行"></a>解释/执行<a class="hash-link" href="#解释执行" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">编写文件CMakeLists.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">执行命令“cmake PATH”或者“ccmake PATH”生成Makefile (PATH是CMakeLists.txt所在的目录)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">使用make命令进行编译源码生成可执行程序或共享库（so(shared object)）</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>cmake 指向CMakeLists.txt所在的目录，例如 cmake .. 表示CMakeLists.txt在当前目录的上一级目录。cmake后会生成很多编译的中间文件以及makefile文件，所以一般建议新建一个新的目录，专门用来编译</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cmake ..</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">make</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="使用说明"></a>使用说明<a class="hash-link" href="#使用说明" title="Direct link to heading">#</a></h2><p>cmake是以完成二进制的构建为目的的工具。二进制的构建一般分为，预编译，编译，汇编，链接，4个步骤。当然llvm的步骤更多。但是大体可分为两个阶段。</p><ol><li>编译<ol><li>需要指定源码，头文件位置。</li><li>需要指定一些编译的参数（目标平台，架构等）</li></ol></li><li>链接<ol><li>需要指定需要连接的库和库位置。</li></ol></li></ol><p>以上，便是CMake大概需要做的工作。如此便可以更好的理解CMake了。</p><p>Modern CMake 围绕 <strong>Targets</strong> 和 <strong>Properties</strong> 展开，因此常用的命令如下:</p><p><em>创建 target</em></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_library()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_exectutable()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_sources()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><em>为 target 指定参数</em></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">## 预处理头文件搜索路径 -I</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_include_directories()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## 编译宏 自动在指定的宏前添加 -D</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_compile_definitions()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## 编译选项</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_compile_options()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## 链接库搜索路径 -L</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_link_directories()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## 链接选项</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_link_options()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## 链接库</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_link_libraries()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="target和project"></a>target和project<a class="hash-link" href="#target和project" title="Direct link to heading">#</a></h3><p>target是整个make的目标。target必须依赖project存在，没有project没法编译。类似Xcode项目。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">if(${PLATFORM} MATCHES &quot;MAC&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    project(RZLogan_macOS)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">else()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    project(RZLogan_iOS)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">endif()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>相当于编译器的<code>-o</code>和源代码列表</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">clang -o hello hello.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">等价于</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_executable(hello hello.c)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-buildsystem.7.html#binary-targets" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/manual/cmake-buildsystem.7.html#binary-targets</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="binary-executables"></a>Binary Executables<a class="hash-link" href="#binary-executables" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_executable(mytool mytool.cpp)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="binary-library"></a>Binary Library<a class="hash-link" href="#binary-library" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_library(archive SHARED archive.cpp zip.cpp lzma.cpp)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_library(archive STATIC archive.cpp zip.cpp lzma.cpp)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_library(MyFramework SHARED MyFramework.cpp)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set_target_properties(MyFramework PROPERTIES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  FRAMEWORK TRUE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  FRAMEWORK_VERSION A # Version &quot;A&quot; is macOS convention</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  MACOSX_FRAMEWORK_IDENTIFIER org.cmake.MyFramework</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><hr><p>设置一个变量：来保存源文件列表</p><ul><li><p>需要一些环境变量，来定位源文件所在的文件夹</p><p><a href="http://cmake.org/cmake/help/v3.21/manual/cmake-variables.7.html#variables-that-describe-the-system" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/manual/cmake-variables.7.html#variables-that-describe-the-system</a></p></li><li><p>需要变量来保存源文件列表</p></li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">set(oc_src_folder &quot;${CMAKE_CURRENT_LIST_DIR}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set(oc_src_upload_folder &quot;${CMAKE_CURRENT_LIST_DIR}/Upload&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">file(GLOB logan_oc_source_files </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;${oc_src_folder}/*.m&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;${oc_src_folder}/*.mm&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;${oc_src_folder}/*.h&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;${oc_src_upload_folder}/*.m&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;${oc_src_upload_folder}/*.mm&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;${oc_src_upload_folder}/*.h&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><hr><p>设置一个变量：来保存TargetName</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">set(LIB_TARGET_NAME rzlogan)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="设置"></a>设置<a class="hash-link" href="#设置" title="Direct link to heading">#</a></h3><p>Properties</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="预编译设置"></a>预编译设置<a class="hash-link" href="#预编译设置" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="指定头文件路径"></a><strong>指定头文件路径</strong><a class="hash-link" href="#指定头文件路径" title="Direct link to heading">#</a></h5><p>include_directories</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">include_directories` vs `target_include_directories</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><blockquote><p><code>include_directories(x/y)</code> affects directory scope. All targets in this CMakeList, as well as those in all subdirectories added after the point of its call, will have the path <code>x/y</code> added to their include path.</p><p><code>target_include_directories(t x/y)</code> has target scope—it adds <code>x/y</code> to the include path for target <code>t</code>.</p><p>You want the former one if all of your targets use the include directories in question. You want the latter one if the path is specific to a target, or if you want finer control of the path&#x27;s visibility. The latter comes from the fact that <code>target_include_directories()</code> supports the <code>PRIVATE</code>, <code>PUBLIC</code>, and <code>INTERFACE</code> qualifiers.</p></blockquote><p><code>include_directories</code> 之后，会对之后的target的造成影响。有顺序关系。</p><p>如果有不同目录相同名称的头文件会产生影响，所以这里建议针对特定的target进行添加头文件的操作，不要使用<code>include_directories</code></p><blockquote><p>If PRIVATE is specified for a certain option/property, then that option/property will only impact the current target. If PUBLIC is specified, then the option/property impacts both the current target and any others that link to it. If INTERFACE is specified, then the option/property does not impact the current target but will propagate to other targets that link to it.</p></blockquote><p>public: 头文件可以提供给依赖的库和自己使用</p><p>interface： 头文件提供给依赖的库使用，但自己不使用，场景：封装一个sdk，供外部使用的头文件和内部使用的头文件，这时候就很有用了</p><p>private：头文件自己使用，不提供给外部使用</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cmake codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_include_directories(&lt;target&gt; [SYSTEM] [BEFORE]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;INTERFACE|PUBLIC|PRIVATE&gt; [items1...]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [&lt;INTERFACE|PUBLIC|PRIVATE&gt; [items2...] ...])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>如何提供给外部依赖的库使用呢？</p><p>通过使用：<code>target_link_libraries</code> 来提供。但是这个api也有public、private、interface，这个请看下文。</p><hr><p>如果你写一个库，指定库的头文件搜索路径。</p><p><a href="https://stackoverflow.com/questions/13703647/how-to-properly-add-include-directories-with-cmake" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/13703647/how-to-properly-add-include-directories-with-cmake</a></p><p>Two things must be done.</p><p>First add the directory to be included:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cpp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">target_include_directories</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test PRIVATE $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case you are stuck with a very old CMake version (2.8.10 or older) without support for <code>target_include_directories</code>, you can also use the legacy <code>include_directories</code> instead:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cpp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">include_directories</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Then you also must add the header files to the list of your source files for the current target, for instance:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cpp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">SOURCES file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cpp file2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cpp $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">file1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">h $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">file2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">h</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add_executable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">SOURCES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This way, the header files will appear as dependencies in the Makefile, and also for example in the generated Visual Studio project, if you generate one.</p><p>How to use those header files for several targets:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cpp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">HEADER_FILES $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">file1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">h $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">file2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">h</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add_library</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">mylib libsrc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cpp $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">HEADER_FILES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">target_include_directories</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">mylib PRIVATE $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add_executable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">myexec execfile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cpp $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">HEADER_FILES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">target_include_directories</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">myexec PRIVATE $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">YOUR_DIRECTORY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>First, you use <code>include_directories()</code> to tell CMake to add the directory as <code>-I</code> to the compilation command line. Second, you list the headers in your <code>add_executable()</code> or <code>add_library()</code> call.</p><p>As an example, if your project&#x27;s sources are in <code>src</code>, and you need headers from <code>include</code>, you could do it like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cpp codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">include_directories</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add_executable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">MyExec</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  src</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  src</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">other_source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  include</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">header1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  include</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">header2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><hr><p>target_include_directories</p><p>切记这个是你指定target的include。demo01 的 hello_library 引用了hello.h。</p><p>这个不是必须，这个target用到了include就使。正常大型项目都会用。 这个和外界使用库是两回事。</p><p>两个注意点：</p><ol><li>.a 库文件 和 .h 头文件分离</li><li>保留了文件夹结构 “hello/hello.h”</li></ol><p>[https://sfumecjf.github.io/cmake-examples-Chinese/01-basic/1.3%20%20Static%20Library.html](<a href="https://sfumecjf.github.io/cmake-examples-Chinese/01-basic/1.3" target="_blank" rel="noopener noreferrer">https://sfumecjf.github.io/cmake-examples-Chinese/01-basic/1.3</a>  Static Library.html)</p><p>编译这个库的时候 因为这个库hello_library由Hello.cpp生成，Hello.cpp中函数的定义在Hello.h中，Hello.h在这个include目录下，所以显然编译这个库的时候，这个目录会用到</p><ul><li>见名知意就是 那个target 所用到的 include 的 directories</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_include_directories(hello_library</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PUBLIC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">${PROJECT_SOURCE_DIR}/include</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Demo2 没有用到 </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// #include &quot;hello/hello.h&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>所以demo02 也不必使用 target_include_directories 来包含头文件，因为那个target没有用到 include。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># target_include_directories(hello_library</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># PUBLIC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># ${PROJECT_SOURCE_DIR}/include</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><hr><p>使用静态库</p><p>库的引用的头文件目录</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">注意 header search path 所导致头文件包含的不同。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">//&quot;$(SRCROOT)/../hello/include/hello&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">//#include &lt;hello.h&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">//&quot;$(SRCROOT)/../hello/include&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;hello/hello.h&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>这个头文件的路径 只和 你引用的方式有关系</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="宏"></a>宏<a class="hash-link" href="#宏" title="Direct link to heading">#</a></h5><p>编译的时候用到的命令：</p><p>如：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c++ codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;iostream&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">int main(int argc, char *argv[]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   std::cout &lt;&lt; &quot;Hello Compile Flags!&quot; &lt;&lt; std::endl;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   // only print if compile flag set</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#ifdef EX2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  std::cout &lt;&lt; &quot;Hello Compile Flag EX2!&quot; &lt;&lt; std::endl;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#endif</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#ifdef EX3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  std::cout &lt;&lt; &quot;Hello Compile Flag EX3!&quot; &lt;&lt; std::endl;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#endif</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   return 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="https://sfumecjf.github.io/cmake-examples-Chinese/01-basic/1.6%20%20Compile%20Flags.html" target="_blank" rel="noopener noreferrer">https://sfumecjf.github.io/cmake-examples-Chinese/01-basic/1.6%20%20Compile%20Flags.html</a></p><p><img alt="image-20210506163025949" src="/assets/images/image-20210506163025949-5c3d36844f1aa52b66fd18ea442b8f5f.png"></p><p>就和默认给的debug的定义差不多，以此类推。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="编译设置"></a>编译设置<a class="hash-link" href="#编译设置" title="Direct link to heading">#</a></h4><p><strong>指定编译器</strong></p><p><code>CPPFLAGS</code> is supposed to be for flags for the <strong>C</strong> <strong>P</strong>re<strong>P</strong>rocessor; <code>CXXFLAGS</code> is for flags for the C++ compiler.</p><p>The default rules in make (on my machine, at any rate) pass <code>CPPFLAGS</code> to just about everything, <code>CFLAGS</code> is only passed when compiling and linking C, and <code>CXXFLAGS</code> is only passed when compiling and linking C++.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMAKE_&lt;LANG&gt;_FLAGS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">eg:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMAKE_C_FLAGS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 表示预编译参数</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMAKE_CPP_FLAGS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 表示编译参数</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMAKE_CXX_FLAGS </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><hr><p><strong>加载C++全局变量</strong></p><p><a href="https://gamedev.stackexchange.com/questions/37813/variables-in-static-library-are-never-initialized-why" target="_blank" rel="noopener noreferrer">https://gamedev.stackexchange.com/questions/37813/variables-in-static-library-are-never-initialized-why</a></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Use the -all_load linker option to load all members of static libraries. Or for a specific library, use -force_load path_to_archive.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">In Xcode, you&#x27;ll want to add these options under &quot;Other Linker Flags&quot; for your executable (not your static library).</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><hr><p><strong>arc设置</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">set_property (TARGET ${LIB_TARGET_NAME} </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">APPEND_STRING </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PROPERTY </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">COMPILE_FLAGS &quot;-fobjc-arc&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="http://cmake.org/cmake/help/v3.21/prop_tgt/COMPILE_FLAGS.html" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/prop_tgt/COMPILE_FLAGS.html</a></p><p><img alt="image-20211014112102164" src="/assets/images/image-20211014112102164-c9102c7f423f52267e91b7e21179bd6b.png"></p><p><img alt="image-20211014112157933" src="/assets/images/image-20211014112157933-fc7911881b23f4e317c686c6c073dbad.png"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">方式1：</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set_property (TARGET ${LIB_TARGET_NAME} </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">APPEND_STRING </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PROPERTY </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CLANG_ENABLE_OBJC_ARC YES)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">方式2：</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set_target_properties(${LIB_TARGET_NAME} </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PROPERTIES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CLANG_ENABLE_OBJC_ARC YES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>争论在这里：<a href="https://developer.apple.com/forums/thread/673960" target="_blank" rel="noopener noreferrer">Xcode defaults ARC to off. CMake-based builds leak large amounts of memory.</a></p><p><img alt="image-20211014112748485" src="/assets/images/image-20211014112748485-be63e5ec0f2661e294b5c9dd0c7236d4.png"></p><p>方式2更好，直接修改了项目工程文件。</p><p>关于 XCODE<em>ATTRIBUTE</em>：</p><p><a href="http://cmake.org/cmake/help/v3.21/prop_tgt/XCODE_ATTRIBUTE_an-attribute.html" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/prop_tgt/XCODE_ATTRIBUTE_an-attribute.html</a></p><p>关于Xcode的<code>&lt;an-attribute&gt;</code>的值，可以参考：</p><p><a href="https://help.apple.com/xcode/mac/current/#/itcaec37c2a6" target="_blank" rel="noopener noreferrer">Build settings reference</a></p><p>xcode 的build setting 没有，直接设置相关属性则添加到User-Defined区域里面。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">set_target_properties(${LIB_TARGET_NAME} </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PROPERTIES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CLANG_ENABLE_OBJC_ARC YES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CODE_SIGNING_REQUIRED NO</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CODE_SIGN_STYLE     Manual</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CODE_SIGN_IDENTITY &quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCODE_ATTRIBUTE_CODE_SIGNING_ALLOWED NO</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PUBLIC_HEADER &quot;${public_headers}&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># CXX_VISIBILITY_PRESET hidden</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># VISIBILITY_INLINES_HIDDEN 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PRODUCT_BUNDLE_IDENTIFIER com.rz.logan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="image-20211028170632502" src="/assets/images/image-20211028170632502-8cca6f834d653884a999184ae6dbdfa4.png"></p><hr><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="设置编译选项"></a><strong>设置编译选项</strong><a class="hash-link" href="#设置编译选项" title="Direct link to heading">#</a></h5><p>编译选项分为对C编译器和C++编译器的编译选项设置</p><p>CMAKE_C_COMPILER：指定C编译器
CMAKE_CXX_COMPILER：指定C++编译器</p><p>设置编译选项（配置编译器）有如下三种方法：</p><ol><li><p>add_compile_options命令</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cmake codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_compile_options(-Wall -Werror -Wstrict-prototypes -Wmissing-prototypes)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ol><ol start="2"><li><p>add_definitions命令</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cmake codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ADD_DEFINITIONS(&quot;-Wall -Werror -Wstrict-prototypes -Wmissing-prototypes&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ol><ol start="3"><li><p>set命令修改CMAKE_CXX_FLAGS或CMAKE_C_FLAGS</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cmake codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">set(CMAKE_C_FLAGS &quot;-Wall -Werror -Wstrict-prototypes -Wmissing-prototypes)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ol><p>针对所有编译器：</p><p>add_compile_options</p><p>add_definitions</p><p>set命令针对指定编译器：</p><p>CMAKE_C_FLAGS：指定编译C文件时编译选项</p><p>CMAKE_CXX_FLAGS：指定编译C++文件时编译选项</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="选择config"></a>选择config<a class="hash-link" href="#选择config" title="Direct link to heading">#</a></h5><p><a href="http://cmake.org/cmake/help/v3.21/variable/CMAKE_BUILD_TYPE.html" target="_blank" rel="noopener noreferrer">http://cmake.org/cmake/help/v3.21/variable/CMAKE_BUILD_TYPE.html</a></p><p>This statically specifies what build type (configuration) will be built in this build tree. Possible values are empty, <code>Debug</code>, <code>Release</code>, <code>RelWithDebInfo</code>, <code>MinSizeRel</code>, ... </p><p>构建可以调试的版本</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cmake .. -DCMAKE_BUILD_TYPE=Debug</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/cmake生成静态库/demo03/libr2/build git:(master) ✗ cmake .. -DCMAKE_BUILD_TYPE=Debug</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- The C compiler identification is AppleClang 12.0.0.12000032</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- The CXX compiler identification is AppleClang 12.0.0.12000032</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compiler ABI info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compiler ABI info - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc - skipped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compile features</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compile features - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compiler ABI info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compiler ABI info - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++ - skipped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compile features</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compile features - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Configuring done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Generating done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Build files have been written to: /Users/dingyusong/mine/gitee/cmake_demos/cmake生成静态库/demo03/libr2/build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/cmake生成静态库/demo03/libr2/build git:(master) ✗ make</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scanning dependencies of target hello_library</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[ 50%] Building CXX object CMakeFiles/hello_library.dir/src/hello.cpp.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[100%] Linking CXX static library libhello_library.a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[100%] Built target hello_library</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>可以进入库中调试了！</p><p><img alt="image-20210506153151820" src="/assets/images/image-20210506153151820-735495ac38623d8381b20e96f701e3ba.png"></p><p>对比差异：</p><ul><li>大小差异</li></ul><p>release版本：大小14KB</p><p>debug版本：大小95KB</p><p><img alt="image-20210506153305701" src="/assets/images/image-20210506153305701-b66bf9b1d4715f51aa39dd298c47edc5.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="汇编设置"></a>汇编设置<a class="hash-link" href="#汇编设置" title="Direct link to heading">#</a></h4><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="链接设置"></a>链接设置<a class="hash-link" href="#链接设置" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="find_library"></a>find_library<a class="hash-link" href="#find_library" title="Direct link to heading">#</a></h5><p>A short-hand signature is:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">find_library (&lt;VAR&gt; name1 [path1 path2 ...])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>为什么下面的方法加个.a就不会找到系统的库了？</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">find_library(PROTOBUF_LIBRARIES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        NAMES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            libprotobuf.a protobuf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        HINTS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ${THIRD_PART_LIBS_PATH}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        PATHS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ${THIRD_PART_LIBS_PATH}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        PATH_SUFFIXES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            lib libs)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="链接第三方库"></a>链接第三方库<a class="hash-link" href="#链接第三方库" title="Direct link to heading">#</a></h5><p><a href="https://sfumecjf.github.io/cmake-examples-Chinese/01-basic/1.7%20%20Including%20Third%20Party%20Library.html" target="_blank" rel="noopener noreferrer">https://sfumecjf.github.io/cmake-examples-Chinese/01-basic/1.7%20%20Including%20Third%20Party%20Library.html</a></p><p>查找：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># find a boost install with the libraries filesystem and system</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#使用库文件系统和系统查找boost install</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">find_package(Boost 1.46.1 REQUIRED COMPONENTS filesystem system)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># check if boost was found</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if(Boost_FOUND)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    message (&quot;boost found&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">else()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    message (FATAL_ERROR &quot;Cannot find Boost&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">endif()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>inclue + link</p><p>方式1：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_link_libraries( third_party_include</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      PRIVATE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          Boost::filesystem</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>方式2：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Include the boost headers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  target_include_directories( third_party_include</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      PRIVATE ${Boost_INCLUDE_DIRS}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # link against the boost libraries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  target_link_libraries( third_party_include</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      PRIVATE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ${Boost_SYSTEM_LIBRARY}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ${Boost_FILESYSTEM_LIBRARY}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="链接cmake子项目"></a>链接cmake子项目<a class="hash-link" href="#链接cmake子项目" title="Direct link to heading">#</a></h5><p>subbinary依赖lib1和lib2。他们都是同一级别的。</p><p><a href="https://sfumecjf.github.io/cmake-examples-Chinese/02-sub-projects/A-basic/" target="_blank" rel="noopener noreferrer">https://sfumecjf.github.io/cmake-examples-Chinese/02-sub-projects/A-basic/</a></p><p>add_subdirectory 会自动构建子项目</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_subdirectory(sublibrary1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_subdirectory(sublibrary2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_subdirectory(subbinary)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>集成一个CMake项目到另外的CMake项目</strong></p><p>为了让别的C++项目在CMakeLists.txt中使用find_package来引用自己的C++项目，则需要在自己项目的CMakeLists.txt中使用EXPORT语法和install(EXPORT ...)语法。一个生动的例子可以参考：</p><ul><li><a href="https://github.com/DeepVAC/libdeepvac/blob/master/CMakeLists.txt" target="_blank" rel="noopener noreferrer">https://github.com/DeepVAC/libdeepvac/blob/master/CMakeLists.txt</a></li><li><a href="https://github.com/DeepVAC/libdeepvac/blob/master/cmake/deepvac-config.cmake" target="_blank" rel="noopener noreferrer">https://github.com/DeepVAC/libdeepvac/blob/master/cmake/deepvac-config.cmake</a></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="目录查找"></a>目录查找<a class="hash-link" href="#目录查找" title="Direct link to heading">#</a></h4><p><a href="http://www.voidcn.com/article/p-vowckywc-btg.html" target="_blank" rel="noopener noreferrer">http://www.voidcn.com/article/p-vowckywc-btg.html</a></p><p>变量 <a href="javascript:void()" target="_blank" rel="noopener noreferrer"><code>CMAKE_CURRENT_SOURCE_DIR</code></a>和 <a href="javascript:void()" target="_blank" rel="noopener noreferrer"><code>CMAKE_CURRENT_LIST_DIR</code></a>可以指代由具有 <a href="javascript:void()" target="_blank" rel="noopener noreferrer">include</a>命令的不同文件包括的CMake列表文件的不同目录.例如,如果目录项目中存在CMakeLists.txt并且包含以下指令</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">include(src/CMakeLists.txt)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>然后在处理<code>src / CMakeLists.tx</code>t时,<code>CMAKE_CURRENT_LIST_DIR</code>将引用<code>project / src</code>,而<code>CMAKE_CURRENT_SOURCE_DIR</code>仍然指向外部目录项目.</p><p>当您需要找到当前正在处理的<code>CMakeLists.txt</code>文件旁边的模板文件或批处理脚本等资源文件时,<code>CMAKE_CURRENT_LIST_DIR</code>会派上用场.</p><hr><ul><li>CMake中的CMAKE_SOURCE_DIR和PROJECT_SOURCE_DIR是否相同？</li></ul><p><em>原文</em>  <a href="javascript:void()" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/32028667/are-cmake-source-dir-and-project-source-dir-the-same-in-cmake</a></p><p>CMake已经为我们定义了变量.我觉得有些变量是一样的.以CMAKE_SOURCE_DIR和PROJECT_SOURCE_DIR为例.它们是相同的,指的是定义顶级CMakeLists.txt的文件夹.所以我的问题是：他们之间有微妙的区别吗？谢谢.</p><p>这些变量之间有差异. <a href="javascript:void()" target="_blank" rel="noopener noreferrer"><code>CMAKE_SOURCE_DIR</code></a>确实是指定义了顶级CMakeLists.txt的文件夹.但是, <a href="javascript:void()" target="_blank" rel="noopener noreferrer"><code>PROJECT_SOURCE_DIR</code></a>是指包含最近的project()命令的CMakeLists.txt的文件夹.</p><p>例如,假设你有一个名为Outer的顶级项目,它包含一个子目录,其自己的项目叫做Inner.外面的CMakeLists.txt有：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">project(Outer)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_subdirectory(Inner)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>和内在的：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">project(Inner)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>然后在这两个CMakeLists文件中,CMAKE_SOURCE_DIR将引用Outer的源目录.但是外部PROJECT_SOURCE_DIR也是同一个目录,而Inner并不是这样. Inner的PROJECT_SOURCE_DIR是包含其CMakeLists.txt的子目录.</p><p>该差异适用于所有<code>PROJECT_&lt; var&gt;</code> vs<code> CMAKE_&lt; var&gt;</code>变量.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cmake编译流程"></a>CMake编译流程<a class="hash-link" href="#cmake编译流程" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">编写文件CMakeLists.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">执行命令“cmake PATH”或者“ccmake PATH”生成Makefile (PATH是CMakeLists.txt所在的目录)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">使用make命令进行编译源码生成可执行程序或共享库（so(shared object)）</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>cmake 指向CMakeLists.txt所在的目录，例如 cmake .. 表示CMakeLists.txt在当前目录的上一级目录。cmake后会生成很多编译的中间文件以及makefile文件，所以一般建议新建一个新的目录，专门用来编译</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cmake ..</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">make</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>make根据生成makefile文件，编译程序</p><p>CMake语句主要有3类用法：</p><ul><li>设置变量。这样的语句有set、file、list、find_library、aux_source_directory、generator expressions；</li><li>设置target。也就是构建的目标是什么（你构建个项目总得有个目标吧，一般来说就是库或者可执行文件）；这样的语句有add_library、add_executable；</li><li>设置target的属性。也就是定义如何生成target（比如源文件的路径、编译选项、要链接什么库......）；这样的语句有add_definitions、target_link_libraries、link_directories、include_directories、target_include_directories；</li></ul><p>参考：<a href="https://zhuanlan.zhihu.com/p/92928820" target="_blank" rel="noopener noreferrer">使用CMake构建C++项目</a></p><p>走一遍tutorial 源码在这里：</p><p><a href="https://github.com/Kitware/CMake/tree/master/Help/guide/tutorial" target="_blank" rel="noopener noreferrer">https://github.com/Kitware/CMake/tree/master/Help/guide/tutorial</a></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cmake codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">project (HELLO)   #指定项目名称，生成的VC项目的名称；</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;使用${HELLO_SOURCE_DIR}表示项目根目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">include_directories：指定头文件的搜索路径，相当于指定gcc的-I参数</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; include_directories (${HELLO_SOURCE_DIR}/Hello)  #增加Hello为include目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">link_directories：动态链接库或静态链接库的搜索路径，相当于gcc的-L参数</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; link_directories (${HELLO_BINARY_DIR}/Hello)     #增加Hello为link目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_subdirectory：包含子目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; add_subdirectory (Hello)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_executable：编译可执行程序，指定编译，好像也可以添加.o文件</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; add_executable (helloDemo demo.cxx demo_b.cxx)   #将cxx编译成可执行文件——</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_definitions：添加编译参数</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; add_definitions(-DDEBUG)将在gcc命令行添加DEBUG宏定义；</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; add_definitions( “-Wall -ansi –pedantic –g”)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">target_link_libraries：添加链接库,相同于指定-l参数</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; target_link_libraries(demo Hello) #将可执行文件与Hello连接成最终文件demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add_library:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; add_library(Hello hello.cxx)  #将hello.cxx编译成静态库如libHello.a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">————————————————</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">版权声明：本文为CSDN博主「potxxx」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">原文链接：https://blog.csdn.net/potxxx/article/details/86766378</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>第三方库主要由两个部分组成，即 a)<strong>头文件</strong>， b)<strong>库文件</strong>。 头文件一般是一系列名为<code>xxx.h</code>（<strong>h</strong>ead）的文件，相当于暴露出第三方库所提供的API接口（函数签名）。 库文件一般会包含<strong>静态库文件</strong>和<strong>动态库文件</strong>，相当于第三方库在功能上的二进制实现。 其中，静态库文件是一系列名为<code>libxxx.a</code>（<strong>a</strong>rchive）的文件（Windows下为<code>libxxx.lib</code>，<strong>lib</strong>rary）。 动态库文件则是一系列名为<code>libxxx.so</code>（<strong>s</strong>hared <strong>o</strong>bject）的文件（Windows下为<code>libxxx.dll</code>，<strong>d</strong>ynamic <strong>l</strong>ink <strong>l</strong>ibrary，macOS下为<code>libxxx.dylib</code>，<strong>dy</strong>namic <strong>lib</strong>rary）。 系统自带的，以及由系统包管理器安装的第三方库，其头文件一般在<code>/usr/include</code>或<code>/usr/local/include</code>路径下，库文件一般在<code>/lib</code>，<code>/usr/lib</code>和<code>/usr/local/lib</code>目录下。</p><p>正是由于以上因素的影响，GCC工具链不负责管理第三方库，因此无法判定C/C++项目具体需要使用哪些库，以及这些库的准确信息，如位置、版本等。 所以，仅使用GCC，无法完全自动地解决C/C++项目第三方库的依赖问题。 我们需要人工地添加各种编译参数，如<code>-I</code>，<code>-l</code>以及<code>-L</code>，将所依赖的第三方库的相关信息，传递给<code>gcc</code>编译器。 其中<code>-I</code>传递的是头文件所在的目录，<code>-l</code>传递的是需要链接的库的名称，<code>-L</code>传递的是库文件所在的目录。</p><p><a href="https://zhuanlan.zhihu.com/p/342151242" target="_blank" rel="noopener noreferrer">GCC/Make/CMake 之 GCC</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cmake工程目录结构"></a>cmake工程目录结构<a class="hash-link" href="#cmake工程目录结构" title="Direct link to heading">#</a></h3><p><img alt="img" src="/assets/images/12730381-d319a7e97d4390af-b57f2d5a9c1b3f90e6bd2d2beeacc336.jpg"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">lib: 生成的库文件</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> src: 源文件（*.cpp *.cc）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> include: 头文件（*.h *.hpp）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> build: 一般在这个文件夹下执行cmake ..(..之前有一个空格，表示你要使用的CMakeLists.txt文件在当前的上层路径)，生成的Makefile文件也在这个路径下。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> bin: 一般放生成的可执行文件</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> CMakeLists.txt: cmake的配置文件，关于配置文件怎么写的教程（[http://blog.csdn.net/kaizi318/article/details/7721624](https://links.jianshu.com/go?to=http%3A%2F%2Fblog.csdn.net%2Fkaizi318%2Farticle%2Fdetails%2F7721624)）</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-cmake codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#井好表示注释</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMAKE_MINIMUM_REQUIRED( VERSION 2.8 ) #设定最小版本号</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PROJECT( test )                       #设定工程名</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SET(CMAKE_CXX_COMPILER &quot;g++&quot;)         #设置编译器（可选的有gcc，g++）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 设置用debug还是release模式。debug允许断点，而release更快</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#set( CMAKE_BUILD_TYPE Debug )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set( CMAKE_BUILD_TYPE Release )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 设置编译选项</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 允许c++11标准、O3优化、多线程。match选项可避免一些cpu上的问题</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">set( CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -std=c++11 -march=native -O3 -pthread&quot; )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#设定可执行二进制文件的目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SET( EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#设定存放编译出来的库文件的目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SET( LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#并且把该目录设为连接目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LINK_DIRECTORIES( ${PROJECT_SOURCE_DIR}/lib)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">find_package (Threads REQUIRED)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#设定头文件目录</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INCLUDE_DIRECTORIES( ${PROJECT_SOURCE_DIR}/include)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#增加子文件夹(注意我们的src路径是通过子文件夹的形式添加的，在这里面也是可以些CMakeLists.txt的)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ADD_SUBDIRECTORY( ${PROJECT_SOURCE_DIR}/src)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">或则是ADD_SUBDIRECTORY( src)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>作者：Caiaolun
链接：<a href="https://www.jianshu.com/p/2287ed1080c3" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/2287ed1080c3</a>
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p><p>CMake   install 之后</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build git:(master) ✗ cmake --install .                                                                                              (0s)[22:07:53] </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Install configuration: &quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /usr/local/bin/Tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /usr/local/include/TutorialConfig.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /usr/local/lib/libMathFunctions.a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /usr/local/include/MathFunctions.h</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>也就是说一个cmake项目源码下载下来之后，我们进行编译安装之后，会到系统的/usr/local  目录下</p><p>注意： 和系统执行目录如出一辙</p><p><img alt="image-20210221221424232" src="/assets/images/image-20210221221424232-4fd51bb3717dfd709ac7e85964fc6838.png"></p><p>cmake 指定安装路径</p><p>The CMake variable [<code>CMAKE_INSTALL_PREFIX</code>] is used to determine the root of where the files will be installed. If using the <code>cmake --install</code> command, the installation prefix can be overridden via the <code>--prefix</code> argument. For example:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cmake --install . --prefix &quot;/home/myuser/installdir&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Navigate to the install directory and verify that the installed Tutorial runs.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="测试"></a>测试<a class="hash-link" href="#测试" title="Direct link to heading">#</a></h3><p>Rebuild the application and then cd to the binary directory and run the [<code>ctest</code>] executable: <code>ctest -N</code> and <code>ctest -VV</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 注意这个test不要写错地方了</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  enable_testing()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # does the application run</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  add_test(NAME Runs COMMAND Tutorial 25)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # does the usage message work?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  add_test(NAME Usage COMMAND Tutorial)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  set_tests_properties(Usage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PROPERTIES PASS_REGULAR_EXPRESSION &quot;Usage:.*number&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # define a function to simplify adding tests</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  function(do_test target arg result)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    add_test(NAME Comp${arg} COMMAND ${target} ${arg})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    set_tests_properties(Comp${arg}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      PROPERTIES PASS_REGULAR_EXPRESSION ${result}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  endfunction(do_test)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # do a bunch of result based tests</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  do_test(Tutorial 4 &quot;4 is 2&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  do_test(Tutorial 9 &quot;9 is 3&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  do_test(Tutorial 5 &quot;5 is 2.236&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  do_test(Tutorial 7 &quot;7 is 2.645&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  do_test(Tutorial 25 &quot;25 is 5&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  do_test(Tutorial -25 &quot;-25 is [-nan|nan|0]&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  do_test(Tutorial 0.0001 &quot;0.0001 is 0.01&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>参考cmake工程：</p><p><a href="https://github.com/Tencent/rapidjson" target="_blank" rel="noopener noreferrer">https://github.com/Tencent/rapidjson</a></p><p>ios-cmake</p><p><a href="https://github.com/leetal/ios-cmake" target="_blank" rel="noopener noreferrer">https://github.com/leetal/ios-cmake</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="交叉编译"></a>交叉编译<a class="hash-link" href="#交叉编译" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="安装"></a>安装<a class="hash-link" href="#安装" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">install(TARGETS MyLib</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        EXPORT MyLibTargets </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        LIBRARY DESTINATION lib  # 动态库安装路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ARCHIVE DESTINATION lib  # 静态库安装路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        RUNTIME DESTINATION bin  # 可执行文件安装路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        PUBLIC_HEADER DESTINATION include  # 头文件安装路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol><li><p>生成构建系统</p><p><code>cmake ../Step4 </code></p></li><li><p>编译</p><p><code>cmake --build .</code></p></li><li><p>安装</p><p><code>cmake --install . --prefix &quot;des&quot;</code></p></li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2 git:(master) ✗ cmake ../Step4 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- The C compiler identification is AppleClang 12.0.0.12000032</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- The CXX compiler identification is AppleClang 12.0.0.12000032</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compiler ABI info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compiler ABI info - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Check for working C compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc - skipped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compile features</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting C compile features - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compiler ABI info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compiler ABI info - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++ - skipped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compile features</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Detecting CXX compile features - done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Configuring done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Generating done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Build files have been written to: /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2 git:(master) ✗ ls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMakeCache.txt      CMakeFiles          CTestTestfile.cmake Makefile            MathFunctions       TutorialConfig.h    cmake_install.cmake</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2 git:(master) ✗ cmake --install . --prefix &quot;des&quot;              </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Install configuration: &quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMake Error at cmake_install.cmake:41 (file):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  file INSTALL cannot find</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;/Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2/Tutorial&quot;:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  No such file or directory.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2 git:(master) ✗ cmake --build .         </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scanning dependencies of target MathFunctions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[ 25%] Building CXX object MathFunctions/CMakeFiles/MathFunctions.dir/mysqrt.cxx.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[ 50%] Linking CXX static library libMathFunctions.a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[ 50%] Built target MathFunctions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Scanning dependencies of target Tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[ 75%] Building CXX object CMakeFiles/Tutorial.dir/tutorial.cxx.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[100%] Linking CXX executable Tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[100%] Built target Tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2 git:(master) ✗ cmake --install . --prefix &quot;des&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Install configuration: &quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2/des/bin/Tutorial</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2/des/include/TutorialConfig.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2/des/lib/libMathFunctions.a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Installing: /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2/des/include/MathFunctions.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">➜  /Users/dingyusong/mine/gitee/cmake_demos/tutorial/Step4_build2 git:(master) ✗ </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>参考：CMake之install方法的使用：<a href="https://zhuanlan.zhihu.com/p/102955723" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/102955723</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="参考文档"></a>参考文档<a class="hash-link" href="#参考文档" title="Direct link to heading">#</a></h2><ul><li><p><a href="https://github.com/ttroy50/cmake-examples" target="_blank" rel="noopener noreferrer">https://github.com/ttroy50/cmake-examples</a></p></li><li><p><a href="https://sfumecjf.github.io/cmake-examples-Chinese/" target="_blank" rel="noopener noreferrer">https://sfumecjf.github.io/cmake-examples-Chinese/</a></p></li><li><p><a href="https://zhjwpku.com/category/2020/04/04/effective-modern-cmake-practice.html" target="_blank" rel="noopener noreferrer">Effective Modern CMake 实践</a></p></li><li><p><a href="https://phenix3443.github.io/notebook/cmake/effective-modern-cmake.html" target="_blank" rel="noopener noreferrer">https://phenix3443.github.io/notebook/cmake/effective-modern-cmake.html</a></p></li><li><p><a href="https://www.jianshu.com/p/9e8e0566ccc5" target="_blank" rel="noopener noreferrer">带你看 CMake</a></p></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="dys-typora-open://mine/survival/docs/编程基础/计算机系统基础/1-程序/1-构建/CMake/CMake.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#简介" class="table-of-contents__link">简介</a><ul><li><a href="#为何用cmake？" class="table-of-contents__link">为何用Cmake？</a></li><li><a href="#cmake是什么？" class="table-of-contents__link">CMake是什么？</a></li></ul></li><li><a href="#基础" class="table-of-contents__link">基础</a><ul><li><a href="#语法" class="table-of-contents__link">语法</a></li><li><a href="#环境" class="table-of-contents__link">环境</a></li><li><a href="#解释执行" class="table-of-contents__link">解释/执行</a></li></ul></li><li><a href="#使用说明" class="table-of-contents__link">使用说明</a><ul><li><a href="#target和project" class="table-of-contents__link">target和project</a></li><li><a href="#设置" class="table-of-contents__link">设置</a></li><li><a href="#cmake编译流程" class="table-of-contents__link">CMake编译流程</a></li><li><a href="#cmake工程目录结构" class="table-of-contents__link">cmake工程目录结构</a></li><li><a href="#测试" class="table-of-contents__link">测试</a></li></ul></li><li><a href="#交叉编译" class="table-of-contents__link">交叉编译</a></li><li><a href="#安装" class="table-of-contents__link">安装</a></li><li><a href="#参考文档" class="table-of-contents__link">参考文档</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.9888532b.js"></script>
<script src="/runtime~main.73fb2e0e.js"></script>
<script src="/main.a2e30791.js"></script>
<script src="/1.fa235d9f.js"></script>
<script src="/2.8423217f.js"></script>
<script src="/257.8905f2ed.js"></script>
<script src="/258.3860215e.js"></script>
<script src="/935f2afb.ce536a1e.js"></script>
<script src="/17896441.d8a5f7af.js"></script>
<script src="/86b47624.f254bcf7.js"></script>
</body>
</html>