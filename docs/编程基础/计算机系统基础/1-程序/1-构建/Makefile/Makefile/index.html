<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Blog Atom Feed"><title data-react-helmet="true">Makefile | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Makefile | My Site"><meta data-react-helmet="true" name="description" content="Makefile"><meta data-react-helmet="true" property="og:description" content="Makefile"><meta data-react-helmet="true" property="og:url" content="http://localhost:9999//docs/编程基础/计算机系统基础/1-程序/1-构建/Makefile/Makefile"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://localhost:9999//docs/编程基础/计算机系统基础/1-程序/1-构建/Makefile/Makefile"><link rel="stylesheet" href="/styles.8cfbcdec.css">
<link rel="preload" href="/styles.1004da7c.js" as="script">
<link rel="preload" href="/runtime~main.74d3fe56.js" as="script">
<link rel="preload" href="/main.b81ad7fb.js" as="script">
<link rel="preload" href="/1.2fe752e0.js" as="script">
<link rel="preload" href="/259.96e24fb8.js" as="script">
<link rel="preload" href="/260.8c75c7b8.js" as="script">
<link rel="preload" href="/935f2afb.8492b0e9.js" as="script">
<link rel="preload" href="/258.d78093f4.js" as="script">
<link rel="preload" href="/3d89bf83.d48956de.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">基础</a><a class="navbar__item navbar__link" href="/docs/编程语言/编程语言">语言</a><a class="navbar__item navbar__link" href="/docs/工具/常用工具">工具</a><a class="navbar__item navbar__link" href="/docs/应用开发/应用开发">应用开发</a><a class="navbar__item navbar__link" href="/docs/Apple/iOS开发/iOS开发">Apple</a><a class="navbar__item navbar__link" href="/docs/音视频/音视频">音视频</a><a class="navbar__item navbar__link" href="/docs/项目/项目">项目</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">基础</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/编程语言/编程语言">语言</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/工具/常用工具">工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/应用开发/应用开发">应用开发</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Apple/iOS开发/iOS开发">Apple</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/音视频/音视频">音视频</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/项目/项目">项目</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Makefile</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="makefile"></a>Makefile<a class="hash-link" href="#makefile" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="数据"></a>数据<a class="hash-link" href="#数据" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="运算"></a>运算<a class="hash-link" href="#运算" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="控制"></a>控制<a class="hash-link" href="#控制" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="过程"></a>过程<a class="hash-link" href="#过程" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="环境"></a>环境<a class="hash-link" href="#环境" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="解释器"></a>解释器<a class="hash-link" href="#解释器" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="make"></a>make<a class="hash-link" href="#make" title="Direct link to heading">#</a></h2><p>代码变成可执行文件，叫做<a href="http://www.ruanyifeng.com/blog/2014/11/compiler.html" target="_blank" rel="noopener noreferrer">编译</a>（compile）；先编译这个，还是先编译那个（即编译的安排），叫做<a href="http://en.wikipedia.org/wiki/Software_build" target="_blank" rel="noopener noreferrer">构建</a>（build）。</p><p>参考链接：
<a href="http://blog.csdn.net/ruglcc/article/details/7814546/" target="_blank" rel="noopener noreferrer"> Makefile经典教程(掌握这些足够)</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="makefile的规则"></a>Makefile的规则<a class="hash-link" href="#makefile的规则" title="Direct link to heading">#</a></h2><p>最核心的内容：</p><p>在讲述这个Makefile之前，还是让我们先来粗略地看一看Makefile的规则。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">target... : prerequisites ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">command</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li><p>target也就是一个目标文件，可以是ObjectFile，也可以是执行文件。还可以是一个标签（Label），对于标签这种特性，在后续的“伪目标”章节中会有叙述。</p></li><li><p>prerequisites就是，要生成那个target所需要的文件或是目标。依赖关系的实质就是说明了目标文件是由哪些文件生成的，换言
之，目标文件是哪些文件更新的。</p></li><li><p>command也就是make需要执行的命令。（任意的Shell命令）</p></li></ul><p>这是一个文件的依赖关系，也就是说，target这一个或多个的目标文件依赖于prerequisites中的文件，其生成规则定义在command中。说白一点就是说，prerequisites中如果有一个以上的文件比target文件要新的话，command所定义的命令就会被执行。这就是Makefile的规则。也就是Makefile中最核心的内容。</p><p>make是如何工作的：</p><p>默认情况下我们输入make：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">1.make会在当前目录下找名字叫“Makefile”或“makefile”的文件。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2.如果找到，它会找文件中的第一个目标文件（target），在上面的例子中，他会找到“edit”这个文件，并把这个文件作为最终的目标文件。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3.如果edit文件不存在，或是edit所依赖的后面的.o文件的文件修改时间要比edit这个文件新，那么，他就会执行后面所定义的命令来生成edit这个文件。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">4.如果edit所依赖的.o文件也存在，那么make会在当前文件中找目标为.o文件的依赖性，如果找到则再根据那一个规则生成.o文件。（这有点像一个堆栈的过程）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">5.当然，你的C文件和H文件是存在的啦，于是make会生成 .o 文件，然后再用 .o 文件声明make的终极任务，也就是执行文件edit了。</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>还有一种显式命令通过上述分析，我们知道，像clean这种，没有被第一个目标文件直接或间接关联，那么它后面所定义的命令将不会被自动执行，不过，我们可以显示要make执行。即命令——“make clean”，以此来清除所有的目标文件，以便重编译。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-makefile codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILD_PATH </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ~/Desktop/build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">TARGET </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> GoldWallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PRODUCT_PATH </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ~/Desktop/GoldWallet.ipa</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">TIME </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">shell</span><span class="token plain"> date </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;+%Y-%m-%d_%H-%M-%S&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">APPSTORE_PRODUCT_PATH </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> ~/Desktop/GoldWallet_</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIME</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">XCPRETTY </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">shell</span><span class="token plain"> command -v xcpretty 2&gt; /dev/null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">all</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> testBuild testUpload clean</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">appStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> appStoreBuild appStoreUpload clean</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">testBuild</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf ./build/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BUILD_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">ifdef</span><span class="token plain"> XCPRETTY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodebuild -workspace GoldWallet.xcworkspace -scheme GoldWallet -configuration DailyBuild -sdk iphoneos clean build CONFIGURATION_BUILD_DIR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BUILD_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> xcpretty</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodebuild -workspace GoldWallet.xcworkspace -scheme GoldWallet -configuration DailyBuild -sdk iphoneos clean build CONFIGURATION_BUILD_DIR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BUILD_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">endif</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcrun -sdk iphoneos PackageApplication -v </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BUILD_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TARGET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.app -o </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">appStoreBuild</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> updateBuildNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf ./build/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BUILD_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mkdir -p </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">ifdef</span><span class="token plain"> XCPRETTY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodebuild -workspace GoldWallet.xcworkspace -scheme GoldWallet -configuration Release -sdk iphoneos clean archive -archivePath </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TARGET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.xcarchive </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> xcpretty</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodebuild -exportArchive -archivePath </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TARGET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.xcarchive -exportOptionsPlist </span><span class="token keyword" style="font-style:italic">export</span><span class="token plain">.plist -exportPath </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> xcpretty</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodebuild -workspace GoldWallet.xcworkspace -scheme GoldWallet -configuration Release -sdk iphoneos clean archive -archivePath </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TARGET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.xcarchive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodebuild -exportArchive -archivePath </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TARGET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.xcarchive -exportOptionsPlist </span><span class="token keyword" style="font-style:italic">export</span><span class="token plain">.plist -exportPath </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">endif</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">testUpload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    python upload.py 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">appStoreUpload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    python upload.py 2 </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPSTORE_PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TARGET</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">.ipa</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">updateBuildNumber</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ./updateBuildNumber.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">clean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PRODUCT_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf ./build/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BUILD_PATH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-makefile codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token symbol">all</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">Thread</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CC</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">g++</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CPPFLAGS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">-Wall -std</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">c++11 -ggdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LDFLAGS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">-pthread</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">Thread</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">Thread.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">CC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">LDFLAGS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> -o </span><span class="token variable" style="color:rgb(191, 199, 213)">$@</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$^</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">Thread.o</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">Thread.cc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">CC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">CPPFLAGS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> -o </span><span class="token variable" style="color:rgb(191, 199, 213)">$@</span><span class="token plain"> -c </span><span class="token variable" style="color:rgb(191, 199, 213)">$^</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(130, 170, 255)">.PHONY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    clean</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token symbol">clean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm Thread.o Thread</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="https://www.cnblogs.com/haippy/p/3235560.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/haippy/p/3235560.html</a> 可见makefile只是一个演奏家，至于演奏的是什么内容，他不管。gcc 或者其他命令，只是其演奏内容。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="makefile的缺点"></a>makefile的缺点<a class="hash-link" href="#makefile的缺点" title="Direct link to heading">#</a></h2><p>不同产商的make各不相同，也有不同的语法。所以后来产生了Cmake</p><p>c++编程基础（二）——Makefile与cmake入门：<a href="https://blog.csdn.net/potxxx/article/details/86766378" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/potxxx/article/details/86766378</a></p><p>首先谈谈cmake是怎么被引进的？上节我们讲过通过编写makefile文件然后使用make命令就能避免我们每次都编写那么大一段命令行命令，但是makefile使用起来有几个问题：</p><p>在大型项目中要自己编写makefile文件还是很麻烦
makefile文件依赖于平台，简单描述下：win平台下使用微软自己的nmake工具以及cl编译器，假使我们在win下写好了makefile，想要将之移植到linux下（使用make与g++）又得重新再写一个makefile
与2类似，现在不同的平台上有不同的IDE他们都使用自己的项目构建方案各自不兼容，每次重新编译我们肯定不会希望还得自己重新写makefile
cmake的出现基本解决了上面的问题，于是现在大部分的第三方库都是构建在cmake上的。</p><p>cmake的特点：</p><p>跨平台,并可生成 native 编译配置文件,在 Linux/Unix 平台,生成 makefile,在 苹果平台,可以生成 xcode,在 Windows 平台,可以生成 MSVC 的工程文件。
简化编译构建过程和编译过程。Cmake 的工具链非常简单:cmake+make。
可扩展,可以为 cmake 编写特定功能的模块,扩充 cmake 功能。
————————————————
版权声明：本文为CSDN博主「potxxx」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：<a href="https://blog.csdn.net/potxxx/article/details/86766378" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/potxxx/article/details/86766378</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cmake与gcc的关系"></a><a href="https://www.cnblogs.com/StoneLuo/p/7517971.html" target="_blank" rel="noopener noreferrer">Cmake与gcc的关系</a><a class="hash-link" href="#cmake与gcc的关系" title="Direct link to heading">#</a></h2><p>1.gcc是GNU Compiler Collection（就是GNU编译器套件），也可以简单认为是编译器，它可以编译很多种编程语言（括C、C++、Objective-C、Fortran、Java等等）。</p><p>2.当你的程序<em>只有一个源文件</em>时，直接就<em>可以用gcc命令编译</em>它。</p><p>3.但是当你的程序包含很多个源文件时，用gcc命令逐个去编译时，你就很容易混乱而且工作量大</p><p>4.所以出现了make工具，<em>make</em>工具可以看成是一个智能的批处理工具，它本身并没有编译和链接的功能，而是用类似于批处理的方式—通过<em>调用makefile文件中用户指定的命令来进行编译和链接</em>的。</p><p>5.makefile是什么？简单的说就像一首歌的乐谱，make工具就像指挥家，指挥家根据乐谱指挥整个乐团怎么样演奏，make工具就根据makefile中的命令进行编译和链接的。</p><p>6.makefile命令中就包含了调用gcc（也可以是别的编译器）去编译某个源文件的命令。</p><p>7.makefile在一些简单的工程完全可以人工手下，但是当工程非常大的时候，手写makefile也是非常麻烦的，如果换了个平台makefile又要重新修改。</p><p>8.这时候就出现了Cmake这个工具，<em>cmake</em>就可以更加简单的<em>生成makefile</em>文件给上面那个make用。当然cmake还有其他功能，就是可以跨平台生成对应平台能用的makefile，你不用再自己去修改了。</p><p>9.可是cmake根据什么生成makefile呢？它又要根据一个叫<em>CMakeLists.txt</em>文件（学名：组态档）去生成makefile。</p><p>10.到最后CMakeLists.txt文件谁写啊？亲，是你自己手写的。</p><p>11.当然如果你用IDE，类似VS这些一般它都能帮你弄好了，你只需要按一下那个三角形</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="编译流程"></a>编译流程<a class="hash-link" href="#编译流程" title="Direct link to heading">#</a></h2><p>使用<code>gcc</code>编译C/C++程序时，主要的编译流程如下，包含<strong>预处理</strong>、<strong>编译</strong>、<strong>汇编</strong>、<strong>链接</strong>等四个步骤。 以输入C语言程序源码文件<code>b.c</code>为例，直接调用命令<code>gcc b.c</code>，将会<strong>完整执行</strong>以下流程，并生成对应的<strong>可执行</strong>的<strong>二进制</strong>文件<code>a.out</code>。 注意，这里<code>gcc</code>的默认输出就是固定的<code>a.out</code>。 在GCC工具链中，汇编由工具<code>as</code>完成，链接则由工具<code>ld</code>完成。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-C codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">      -E          -S          -c          </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">b.c ------&gt; b.i ------&gt; b.s ------&gt; b.o ------&gt; a.out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      gcc         gcc         as          ld</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="gccmakecmake-之-gcc"></a>GCC/Make/CMake 之 GCC<a class="hash-link" href="#gccmakecmake-之-gcc" title="Direct link to heading">#</a></h2><p><a href="https://zhuanlan.zhihu.com/p/342151242" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/342151242</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="makefile选项"></a>Makefile选项<a class="hash-link" href="#makefile选项" title="Direct link to heading">#</a></h2><p><a href="https://www.cnblogs.com/wanghetao/p/3348885.html" target="_blank" rel="noopener noreferrer">Makefile选项CFLAGS,LDFLAGS,LIBS</a></p><p><em>CFLAGS 表示用于 C 编译器的选项，</em></p><p><em>CXXFLAGS 表示用于 C++ 编译器的选项。
这两个变量实际上涵盖了编译和汇编两个步骤。</em></p><p><strong>CFLAGS</strong>： 指定头文件（.h文件）的路径，如：CFLAGS=-I/usr/include -I/path/include。同样地，安装一个包时会在安装路径下建立一个include目录，当安装过程中出现问题时，试着把以前安装的包的include目录加入到该变量中来。</p><p><strong>LDFLAGS</strong>：gcc 等编译器会用到的一些优化参数，也可以在里面指定库文件的位置。用法：LDFLAGS=-L/usr/lib -L/path/to/your/lib。每安装一个包都几乎一定的会在安装目录里建立一个lib目录。如果明明安装了某个包，而安装另一个包时，它愣是说找不到，可以抒那个包的lib路径加入的LDFALGS中试一下。</p><p><strong>LIBS</strong>：告诉链接器要链接哪些库文件，如LIBS = -lpthread -liconv</p><p>简单地说，LDFLAGS是告诉链接器从哪里寻找库文件，而LIBS是告诉链接器要链接哪些库文件。不过使用时链接阶段这两个参数都会加上，所以你即使将这两个的值互换，也没有问题。</p><p>有时候LDFLAGS指定-L虽然能让链接器找到库进行链接，但是运行时链接器却找不到这个库，如果要让软件运行时库文件的路径也得到扩展，那么我们需要增加这两个库给&quot;-Wl,R&quot;：</p><p>LDFLAGS = -L/var/xxx/lib -L/opt/mysql/lib -Wl,R/var/xxx/lib -Wl,R/opt/mysql/lib</p><p>如果在执行./configure以前设置环境变量export LDFLAGS=&quot;-L/var/xxx/lib -L/opt/mysql/lib -Wl,R/var/xxx/lib -Wl,R/opt/mysql/lib&quot; ，注意设置环境变量等号两边不可以有空格，而且要加上引号（shell的用法）。那么执行configure以后，Makefile将会设置这个选项，链接时会有这个参数，编译出来的可执行程序的库文件搜索路径就得到扩展了。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="交叉编译"></a>交叉编译<a class="hash-link" href="#交叉编译" title="Direct link to heading">#</a></h2><ul><li><p><a href="https://www.jianshu.com/p/3ba79f1ade39" target="_blank" rel="noopener noreferrer">写给安卓程序员的C/C++编译入门</a></p></li><li><p><a href="https://www.cnblogs.com/Free-Thinker/p/6168723.html" target="_blank" rel="noopener noreferrer">用CMake代替makefile进行跨平台交叉编译</a></p></li><li><p>CMake 如何入门？<a href="https://www.zhihu.com/question/58949190" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/58949190</a></p></li></ul><p>交叉编译有是三个比较重要的概念要先说明一下:</p><ul><li>build : 当前你使用的计算机</li><li>host : 你的目的是编译出来的程序可以在host上运行</li><li>target : 普通程序没有这个概念。对于想编译出编译器的人来说此属性决定了新编译器编译出的程序可以运行在哪</li></ul><p>如果我们想要交叉编译出安卓可运行的程序或者库的话就不能直接使用gcc去编译了.而需要使用Android NDK提供了的一套交叉编译工具链.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="参考文档："></a>参考文档：<a class="hash-link" href="#参考文档：" title="Direct link to heading">#</a></h2><ul><li><a href="https://seisman.github.io/how-to-write-makefile/index.html" target="_blank" rel="noopener noreferrer">跟我一起写Makefile</a></li><li><a href="https://en.wikipedia.org/wiki/Makefile" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Makefile</a></li><li><a href="http://www.ruanyifeng.com/blog/2015/02/make.html" target="_blank" rel="noopener noreferrer">阮一峰 Make 命令教程</a></li><li><a href="https://www.gnu.org/software/make/manual/make.html" target="_blank" rel="noopener noreferrer">GNU make</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="dys-typora-open://mine/survival/docs/编程基础/计算机系统基础/1-程序/1-构建/Makefile/Makefile.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#数据" class="table-of-contents__link">数据</a></li><li><a href="#运算" class="table-of-contents__link">运算</a></li><li><a href="#控制" class="table-of-contents__link">控制</a></li><li><a href="#过程" class="table-of-contents__link">过程</a></li><li><a href="#环境" class="table-of-contents__link">环境</a></li><li><a href="#解释器" class="table-of-contents__link">解释器</a></li><li><a href="#make" class="table-of-contents__link">make</a></li><li><a href="#makefile的规则" class="table-of-contents__link">Makefile的规则</a></li><li><a href="#makefile的缺点" class="table-of-contents__link">makefile的缺点</a></li><li><a href="#cmake与gcc的关系" class="table-of-contents__link">Cmake与gcc的关系</a></li><li><a href="#编译流程" class="table-of-contents__link">编译流程</a></li><li><a href="#gccmakecmake-之-gcc" class="table-of-contents__link">GCC/Make/CMake 之 GCC</a></li><li><a href="#makefile选项" class="table-of-contents__link">Makefile选项</a></li><li><a href="#交叉编译" class="table-of-contents__link">交叉编译</a></li><li><a href="#参考文档：" class="table-of-contents__link">参考文档：</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.1004da7c.js"></script>
<script src="/runtime~main.74d3fe56.js"></script>
<script src="/main.b81ad7fb.js"></script>
<script src="/1.2fe752e0.js"></script>
<script src="/259.96e24fb8.js"></script>
<script src="/260.8c75c7b8.js"></script>
<script src="/935f2afb.8492b0e9.js"></script>
<script src="/258.d78093f4.js"></script>
<script src="/3d89bf83.d48956de.js"></script>
</body>
</html>