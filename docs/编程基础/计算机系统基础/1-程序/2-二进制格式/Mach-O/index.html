<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Blog Atom Feed"><title data-react-helmet="true">Mach-O | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Mach-O | My Site"><meta data-react-helmet="true" name="description" content="Mach-O"><meta data-react-helmet="true" property="og:description" content="Mach-O"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/ç¼–ç¨‹åŸºç¡€/è®¡ç®—æœºç³»ç»ŸåŸºç¡€/1-ç¨‹åº/2-äºŒè¿›åˆ¶æ ¼å¼/Mach-O"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/ç¼–ç¨‹åŸºç¡€/è®¡ç®—æœºç³»ç»ŸåŸºç¡€/1-ç¨‹åº/2-äºŒè¿›åˆ¶æ ¼å¼/Mach-O"><link rel="stylesheet" href="/styles.8cfbcdec.css">
<link rel="preload" href="/styles.e736442d.js" as="script">
<link rel="preload" href="/runtime~main.500606b1.js" as="script">
<link rel="preload" href="/main.e34cadf8.js" as="script">
<link rel="preload" href="/1.3353372a.js" as="script">
<link rel="preload" href="/256.3f6603bc.js" as="script">
<link rel="preload" href="/257.427a7301.js" as="script">
<link rel="preload" href="/935f2afb.0ee8c40a.js" as="script">
<link rel="preload" href="/255.24175022.js" as="script">
<link rel="preload" href="/797cbab7.da239d5e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€">ç¼–ç¨‹åŸºç¡€</a><a class="navbar__item navbar__link" href="/docs/ç¼–ç¨‹è¯­è¨€/ç¼–ç¨‹è¯­è¨€">ç¼–ç¨‹è¯­è¨€</a><a class="navbar__item navbar__link" href="/docs/å·¥å…·/å¸¸ç”¨å·¥å…·">å·¥å…·</a><a class="navbar__item navbar__link" href="/docs/åº”ç”¨å¼€å‘/åº”ç”¨å¼€å‘">åº”ç”¨å¼€å‘</a><a class="navbar__item navbar__link" href="/docs/Apple/iOSå¼€å‘/iOSå¼€å‘">Apple</a><a class="navbar__item navbar__link" href="/docs/éŸ³è§†é¢‘/éŸ³è§†é¢‘">éŸ³è§†é¢‘</a><a class="navbar__item navbar__link" href="/docs/é¡¹ç›®/é¡¹ç›®">é¡¹ç›®</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€">ç¼–ç¨‹åŸºç¡€</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ç¼–ç¨‹è¯­è¨€/ç¼–ç¨‹è¯­è¨€">ç¼–ç¨‹è¯­è¨€</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/å·¥å…·/å¸¸ç”¨å·¥å…·">å·¥å…·</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/åº”ç”¨å¼€å‘/åº”ç”¨å¼€å‘">åº”ç”¨å¼€å‘</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Apple/iOSå¼€å‘/iOSå¼€å‘">Apple</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/éŸ³è§†é¢‘/éŸ³è§†é¢‘">éŸ³è§†é¢‘</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/é¡¹ç›®/é¡¹ç›®">é¡¹ç›®</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Mach-O</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mach-o"></a>Mach-O<a class="hash-link" href="#mach-o" title="Direct link to heading">#</a></h1><p>Mach-Object</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ç¬¦å·è¡¨"></a>ç¬¦å·è¡¨<a class="hash-link" href="#ç¬¦å·è¡¨" title="Direct link to heading">#</a></h1><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="objective-c"></a>Objective-C<a class="hash-link" href="#objective-c" title="Direct link to heading">#</a></h3><p>The dynamic nature of Objective-C complicates things slightly. Because the code that implements a method is not determined until the method is actually called, Objective-C does not define linker symbols for methods. Linker symbols are only defined for classes.</p><p>For example, if main.m includes the code <code>[[FooClass alloc] initWithBar:nil];</code> then <code>main.o</code> will contain an undefined symbol for <code>FooClass</code>, but no linker symbols for the <code>-initWithBar:</code> method will be in <code>main.o</code>.</p><p>Since categories are a collection of methods, using a category&#x27;s method does not generate an undefined symbol. This means the linker does not know to load an object file defining the category, if the class itself is already defined. This causes the same &quot;selector not recognized&quot; runtime exception you would see for any unimplemented method.</p><p>å‚è€ƒï¼š</p><p><a href="https://developer.apple.com/library/archive/qa/qa1490/_index.html" target="_blank" rel="noopener noreferrer">https://developer.apple.com/library/archive/qa/qa1490/_index.html</a></p><p>å› ä¸ºå®ç°æ–¹æ³•çš„ä»£ç ç›´åˆ°æ–¹æ³•è¢«å®é™…è°ƒç”¨æ—¶æ‰ç¡®å®šï¼ŒObjective-C æ²¡æœ‰ä¸ºæ–¹æ³•å®šä¹‰é“¾æ¥å™¨ç¬¦å·ã€‚é“¾æ¥å™¨ç¬¦å·ä»…ä¸ºç±»å®šä¹‰ã€‚</p><p>dys_ios_frameworkï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/Users/dingyusong/mine/github/dys_ios_framework_staticlib/demo2/dys_ios_framework/dys_ios_framework/DYSFrameWorkClass.h</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework nm -g dys_ios_framework</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework_vers.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000040 R _dys_ios_frameworkVersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 R _dys_ios_frameworkVersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DYSFrameWorkClass.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _NSLog</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000280 T _OBJC_CLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000258 T _OBJC_METACLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U ___CFConstantStringClassReference</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>DYSFrameWorkClass.h</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@interface DYSFrameWorkClass : NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+ (void)dys_test;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- (void)dys_test1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>å¯ä»¥çœ‹åˆ°ç¬¦å·åªæœ‰ç±»ï¼Œæ²¡æœ‰æ–¹æ³•ã€‚éªŒè¯äº†ä¸Šé¢çš„æ–¹æ³•ã€‚</p><p>æ·»åŠ äº†helloc.c å’Œ helloc2.cã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework nm -g dys_ios_framework</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework_vers.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000040 R _dys_ios_frameworkVersionNumber</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 R _dys_ios_frameworkVersionString</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helloc.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _my_c_print</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">helloc2.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _my_c_print_in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DYSFrameWorkClass.o:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _NSLog</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000280 T _OBJC_CLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000258 T _OBJC_METACLASS_$_DYSFrameWorkClass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U ___CFConstantStringClassReference</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U __objc_empty_cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _my_c_print_in</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>-gæˆ–â€“extern-onlyï¼šä»…æ˜¾ç¤ºå¤–éƒ¨ç¬¦å·ã€‚</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mach-o-1"></a>Mach-O<a class="hash-link" href="#mach-o-1" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">gcc -g a.c -o a</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æ³¨æ„-gå‚æ•°ï¼Œåœ¨å…¶ä»–unixç³»ç»Ÿä¸­ï¼Œé€šå¸¸å°†ç¬¦å·ä¿¡æ¯å†…åµŒåœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯åœ¨osxä¸­ï¼Œè¿™äº›ä¿¡æ¯éƒ½æ”¾åœ¨ä¸€ä¸ªè¾…åŠ©æ–‡ä»¶dSYMä¸­ã€‚</p><p><a href="https://h3adsh0tzz.com/2020/01/macho-file-format/" target="_blank" rel="noopener noreferrer">Mach-O File Format: Introduction</a></p><p><a href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/CodeFootprint/Articles/MachOOverview.html" target="_blank" rel="noopener noreferrer">Overview of the Mach-O Executable Format</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mach-header"></a>Mach header<a class="hash-link" href="#mach-header" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">//EXTERNAL_HEADERS/mach-o/loader.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct mach_header {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            magic;          // mach magic number</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cpu_type_t          cputype;        // cpu specifier</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cpu_subtype_t       cpusubtype;     // cpu subtype specifier</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            filetype;       // type of mach-o e.g. exec, dylib ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            ncmds;          // number of load commands</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            sizeofcmds;     // size of load command region</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            flags;          // flags</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t            reserved;       // *64-bit only* reserved</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/* Constant for the magic field of the mach_header_64 (64-bit architectures) */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#define MH_MAGIC_64 0xfeedfacf /* the 64-bit mach magic number */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#define MH_CIGAM_64 0xcffaedfe /* NXSwapInt(MH_MAGIC_64) */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework otool -h dys_ios_framework </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mach header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> 0xfeedfacf 16777228          0  0x00           6    21       2536 0x00100085</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="image-20210818153407343" src="/assets/images/image-20210818153407343-1379df3a7f30768ac1d14903a7f9baaf.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="load-commands"></a>Load Commands<a class="hash-link" href="#load-commands" title="Direct link to heading">#</a></h3><p>åŠ è½½å‘½ä»¤ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">headerä¸­è¿™ä¸¤ä¸ªå­—æ®µï¼Œæ˜¯å…³äºåŠ è½½çš„ã€‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">uint32_t            ncmds;          // number of load commands</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">uint32_t            sizeofcmds;     // size of load command region</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   struct load_command {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t      cmd;      // type of load command</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint32_t      cmdsize;    // size of load command</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="symbol-table"></a>Symbol Table<a class="hash-link" href="#symbol-table" title="Direct link to heading">#</a></h3><p>ç¬¦å·è¡¨å­˜å‚¨äº†å½“å‰æ–‡ä»¶çš„ç¬¦å·ä¿¡æ¯ï¼Œé™æ€é“¾æ¥å™¨(ld)å’ŒåŠ¨æ€é“¾æ¥å™¨(dyld)åœ¨é“¾æ¥çš„è¿‡ç¨‹ä¸­éƒ½ä¼šè¯»å–ç¬¦å·è¡¨ï¼Œå¦å¤–è°ƒè¯•å™¨ä¹Ÿä¼šç”¨ç¬¦å·è¡¨æ¥æŠŠç¬¦å·æ˜ å°„åˆ°æºæ–‡ä»¶ã€‚</p><p>.symtabç¬¦å·è¡¨ä¸åŒ…å«å±€éƒ¨å˜é‡çš„æ¡ç›®ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dynamic-symbol-table"></a>Dynamic Symbol Table<a class="hash-link" href="#dynamic-symbol-table" title="Direct link to heading">#</a></h3><p>ä½¿ç”¨ <strong>*otool* å‘½ä»¤å¯ä»¥æŸ¥çœ‹åŠ¨æ€ç¬¦å·è¡¨ä¸­çš„ç¬¦å·ä½äºç¬¦å·è¡¨ä¸­çš„ä¸‹æ ‡ã€‚å› æ­¤åŠ¨æ€ç¬¦å·ä¹Ÿå«åš ***Indirect symbols*ã€‚**</strong></p><p>****åŠ¨æ€ç¬¦å·è¡¨ï¼Œ***Dynamic Symbol Table* ï¼Œå…¶ä¸­ ***ä»…å­˜å‚¨äº†ç¬¦å·ä½äºSymbol Tableä¸­çš„ä¸‹æ ‡* ï¼Œè€Œéç¬¦å·æ•°æ®ç»“æ„ï¼Œå› ä¸ºç¬¦å·çš„ç»“æ„ä»…å­˜å‚¨åœ¨ ***Symbol Table* è€Œå·²ã€‚****</p><p><img alt="image-20210817172804282" src="/assets/images/image-20210817172804282-7599e91265cb45f110a9fbeb9228a556.png"></p><p><img alt="image-20210817172203838" src="/assets/images/image-20210817172203838-76ea04ff6e826509b5f944461ca4dba1.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="string-table"></a>String Table<a class="hash-link" href="#string-table" title="Direct link to heading">#</a></h3><p>äºŒè¿›åˆ¶ä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²éƒ½å­˜å‚¨åœ¨ ***String Table* ä¸­ã€‚********</p><p><img alt="img" src="/assets/images/17231f081b953bf4~tplv-t2oaga2asx-watermark-e9c2fc748948b0a99a4b1fb2e40f3b2f.awebp"></p><p><img alt="image-20210817172107039" src="/assets/images/image-20210817172107039-c1487f2ec5b85b97689e4acf4ec56e0c.png"></p><p><img alt="image-20210817172356296" src="/assets/images/image-20210817172356296-39e9ae1d1b04f39245d9682f23d2f794.png"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework strings dys_ios_framework</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="otool"></a>otool<a class="hash-link" href="#otool" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework otool --help</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">error: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/otool: unknown char `-&#x27; in flag --help</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Usage: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/otool [-arch arch_type] [-fahlLDtdorSTMRIHGvVcXmqQjCP] [-mcpu=arg] [--version] &lt;object file&gt; ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -f print the fat headers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -a print the archive header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -h print the mach header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -l print the load commands</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -L print shared libraries used</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -D print shared library id name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -t print the text section (disassemble with -v)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -x print all text sections (disassemble with -v)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -p &lt;routine name&gt;  start dissassemble from routine name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -s &lt;segname&gt; &lt;sectname&gt; print contents of section</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -d print the data section</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -o print the Objective-C segment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -r print the relocation entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -S print the table of contents of a library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -T print the table of contents of a dynamic shared library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -M print the module table of a dynamic shared library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -R print the reference table of a dynamic shared library (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -I print the indirect symbol table</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -H print the two-level hints table (obsolete)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -G print the data in code table</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -v print verbosely (symbolically) when possible</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -V print disassembled operands symbolically</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -c print argument strings of a core file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -X print no leading addresses or headers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -m don&#x27;t use archive(member) syntax</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -B force Thumb disassembly (ARM objects only)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -q use llvm&#x27;s disassembler (the default)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -Q use otool(1)&#x27;s disassembler</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -mcpu=arg use `arg&#x27; as the cpu for disassembly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -j print opcode bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -P print the info plist section as strings</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        -C print linker optimization hints</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --version print the version of /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/otool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>-I print the indirect symbol table</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework otool -I dys_ios_framework </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dys_ios_framework:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Indirect symbols for (__TEXT,__stubs) 2 entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">address            index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000000007e70    58 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000000007e7c    63 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Indirect symbols for (__DATA_CONST,__got) 1 entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">address            index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000000008000    64 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Indirect symbols for (__DATA,__la_symbol_ptr) 2 entries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">address            index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000000000c000    58 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000000000c008    63 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  dys_ios_framework.framework </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="image-20210817173651023" src="/assets/images/image-20210817173651023-1d1fc1b15cafe895d2231f6af4ff9ceb.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ç¬¦å·ç”Ÿæˆè§„åˆ™"></a>ç¬¦å·ç”Ÿæˆè§„åˆ™<a class="hash-link" href="#ç¬¦å·ç”Ÿæˆè§„åˆ™" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cè¯­è¨€"></a>Cè¯­è¨€<a class="hash-link" href="#cè¯­è¨€" title="Direct link to heading">#</a></h4><p>Cçš„ç¬¦å·ç”Ÿæˆè§„åˆ™æ¯”è¾ƒç®€å•ï¼Œä¸€èˆ¬çš„ç¬¦å·éƒ½æ˜¯åœ¨å‡½æ•°åä¸ŠåŠ ä¸Šä¸‹åˆ’çº¿ï¼Œæ¯”å¦‚main.cé‡ŒåŒ…å«mianå’Œmylogä¸¤ä¸ªCå‡½æ•°ï¼Œå¯¹åº”ç¬¦å·å¦‚ä¸‹ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  link-test nm a.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T _foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  link-test nm b.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 D _x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000004 D _y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  link-test nm a.out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100008008 d __dyld_private</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100000000 T __mh_execute_header</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100003f10 T _foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100003f30 T _main</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _printf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100008010 D _x</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000100008014 D _y</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U dyld_stub_binder</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="c"></a>C++<a class="hash-link" href="#c" title="Direct link to heading">#</a></h4><p>C++å› ä¸ºæ”¯æŒå‘½åç©ºé—´ï¼Œå‡½æ•°é‡è½½ç­‰é«˜çº§ç‰¹æ€§ï¼Œä¸ºäº†é¿å…ç¬¦å·å†²çªï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¯¹C++ç¬¦å·åšäº†Symbol Mangling(ä¸åŒç¼–è¯‘å™¨çš„è§„åˆ™ä¸ä¸€æ ·)ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace MyNameSpace {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    class MyClass{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        static int myFunc(int);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        static double myFunc(double);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ç¼–è¯‘åï¼Œåˆ†åˆ«å¯¹åº”ç¬¦å·</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000008 T __ZN11MyNameSpace7MyClass6myFuncEd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000000 T __ZN11MyNameSpace7MyClass6myFuncEi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>å…¶å®ï¼ŒSymbol Manglingè§„åˆ™å¹¶ä¸éš¾ï¼Œåˆšåˆšçš„ä¸¤ä¸ªç¬¦å·æ˜¯æŒ‰ç…§å¦‚ä¸‹è§„åˆ™ç”Ÿæˆçš„ï¼š</p><ul><li>ä»¥_Zå¼€å¤´</li><li>è·Ÿç€Cè¯­è¨€çš„ä¿ç•™å­—ç¬¦ä¸²N</li><li>å¯¹äºnamespaceç­‰åµŒå¥—çš„åç§°ï¼Œæ¥ä¸‹ä¾æ¬¡æ‹¼æ¥åç§°é•¿åº¦ï¼Œåç§°</li><li>ç„¶åæ˜¯ç»“æŸå­—ç¬¦E</li><li>æœ€åæ˜¯å‚æ•°çš„ç±»å‹ï¼Œæ¯”å¦‚intæ˜¯iï¼Œdoubleæ˜¯d</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="objective-c-1"></a>Objective C<a class="hash-link" href="#objective-c-1" title="Direct link to heading">#</a></h4><p>Objective Cçš„ç¬¦å·æ›´ç®€å•ä¸€äº›ï¼Œæ¯”å¦‚æ–¹æ³•çš„ç¬¦å·æ˜¯<code>+-[Class_name(category_name) method:name:]</code>ï¼Œé™¤äº†è¿™äº›ï¼ŒObjective Cè¿˜ä¼šç”Ÿæˆä¸€äº›Runtimeå…ƒæ•°æ®çš„ç¬¦å·</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_BTDRouteBuilder</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_BTDRouter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_CLASS_$_UIViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000458 S _OBJC_CLASS_$_ViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 U _OBJC_METACLASS_$_UIViewController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">0000000000000480 S _OBJC_METACLASS_$_ViewController</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æ‰€ä»¥å½“é“¾æ¥çš„æ—¶å€™ç±»æ‰¾ä¸åˆ°äº†ï¼Œä¼šæŠ¥é”™ç¬¦å·*OBJC_CLASS*$_CLASSNAMEæ‰¾ä¸åˆ°</p><p><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="/assets/images/20191130225957319-3877695318309d16b4a3256be9bb46c7.png"></p><p>å½“ç„¶ï¼Œå¦‚æœç±»çš„ç¬¦å·æ²¡æœ‰è¢«è£å‡æ‰ï¼Œè¿è¡Œæ—¶å°±ç”¨*OBJC_CLASS*$_CLASSNAMEä½œä¸ºå‚æ•°ï¼Œé€šè¿‡dlsymæ¥è·å–ç±»æŒ‡é’ˆã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ç¬¦å·çš„ç§ç±»"></a>ç¬¦å·çš„ç§ç±»<a class="hash-link" href="#ç¬¦å·çš„ç§ç±»" title="Direct link to heading">#</a></h3><p>æŒ‰ç…§ä¸åŒçš„æ–¹å¼å¯ä»¥å¯¹ç¬¦å·è¿›è¡Œä¸åŒçš„åˆ†ç±»ï¼Œæ¯”å¦‚æŒ‰ç…§å¯è§æ€§åˆ’åˆ†</p><ul><li>å…¨å±€ç¬¦å·(Global Symbol) å¯¹å…¶ä»–ç¼–è¯‘å•å…ƒå¯è§</li><li>æœ¬åœ°ç¬¦å·(Local Symbol) åªå¯¹å½“å‰ç¼–è¯‘å•å…ƒå¯è§</li></ul><p>æŒ‰ç…§ä½ç½®åˆ’åˆ†</p><ul><li>å¤–éƒ¨ç¬¦å·ï¼Œç¬¦å·ä¸åœ¨å½“å‰æ–‡ä»¶ï¼Œéœ€è¦ldæˆ–è€…dyldåœ¨é“¾æ¥çš„æ—¶å€™è§£å†³</li><li>éå¤–éƒ¨ç¬¦å·ï¼Œå³å½“å‰æ–‡ä»¶å†…çš„ç¬¦å·</li></ul><p>nmå‘½ä»¤é‡Œçš„å°å†™å­—æ¯å¯¹åº”ç€æœ¬åœ°ç¬¦å·ï¼Œå¤§å†™å­—æ¯è¡¨ç¤ºå…¨å±€ç¬¦å·ï¼›Uè¡¨ç¤ºundefinedï¼Œå³æœªå®šä¹‰çš„å¤–éƒ¨ç¬¦å·</p><p><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="/assets/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9sZW9tb2JpbGVkZXZlbG9wZXIuYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70-1ef08279f0a31d06741bb2d5e87d98e9.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="å¯è§æ€§"></a>å¯è§æ€§<a class="hash-link" href="#å¯è§æ€§" title="Direct link to heading">#</a></h3><p>æœ‰ä¸ªå¾ˆå¸¸è§çš„caseï¼Œå°±æ˜¯ä½ æœ‰1000ä¸ªå‡½æ•°ï¼Œä½†åªæœ‰10ä¸ªå‡½æ•°æ˜¯å…¬å¼€çš„ï¼Œå¸Œæœ›æœ€åç”Ÿæˆçš„åŠ¨æ€åº“é‡Œä¸åŒ…å«å…¶ä»–990ä¸ªå‡½æ•°çš„ç¬¦å·ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨clangçš„attributeæ¥å®ç°</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">//ç¬¦å·å¯è¢«å¤–éƒ¨é“¾æ¥</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">__attribute__((visibility(&quot;default&quot;)))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">//ç¬¦å·ä¸ä¼šè¢«æ”¾åˆ°Dynamic Symbol Tableé‡Œï¼Œæ„å‘³ç€ä¸å¯ä»¥å†è¢«å…¶ä»–ç¼–è¯‘å•å…ƒé“¾æ¥</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">__attribute__((visibility(&quot;hidden&quot;)))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>clangæ¥æä¾›äº†ä¸€ä¸ªå…¨å±€çš„å¼€å…³ï¼Œç”¨æ¥è®¾ç½®ç¬¦å·çš„é»˜è®¤å¯è§æ€§ï¼š</p><p><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="/assets/images/1-2bb401d8c4f16c284117bd8eca376271.png"></p><p>æ§åˆ¶ç¬¦å·çš„å¯è§æ€§</p><p><a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/SymbolVisibility.html#//apple_ref/doc/uid/TP40001670-CJBGBHEJ" target="_blank" rel="noopener noreferrer">Appleï¼š Controlling Symbol Visibility</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="segments-and-sections"></a>segments and sections<a class="hash-link" href="#segments-and-sections" title="Direct link to heading">#</a></h2><p><img alt="image-20210819164759981" src="/assets/images/image-20210819164759981-7dfbf97a69aa778c57fd9dbaf1f837f0.png"></p><p>æ®µï¼ˆsegmentï¼‰æœ‰æ—¶å€™å¯ä»¥è¿›ä¸€æ­¥åˆ†è§£ä¸ºåŒºï¼ˆsectionï¼‰ã€‚</p><p><img alt="image-20210819162807327" src="/assets/images/image-20210819162807327-2c79c16a9b5bdfe72255057831d99690.png"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  mach-o size dys_ios_framework_demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">__TEXT  __DATA  __OBJC  others  dec     hex</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">32768   16384   0       4295016448      4295065600      100018000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æ–‡ä»¶å¤´ï¼Œä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œç¬¦å·è¡¨ç­‰å…¶ä»–ä¿¡æ¯</p><p><img alt="image-20210819173553884" src="/assets/images/image-20210819173553884-f7263539ae0e5ff5208823f5c019035a.png"></p><p>sectionä¸»è¦æä¾›ç»™Linkerä½¿ç”¨ï¼Œ è€Œsegmentæä¾›ç»™Loaderç”¨ï¼ŒLinkeréœ€è¦å…³å¿ƒ.text, .rel.text, .data, .rodataç­‰ç­‰ï¼Œå…³é”®æ˜¯Linkeréœ€è¦åšrelocationã€‚è€ŒLoaderåªéœ€è¦çŸ¥é“Read/Write/Executeçš„å±æ€§ã€‚</p><p>å‚è€ƒ:<a href="https://www.cnblogs.com/feng9exe/p/6899136.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/feng9exe/p/6899136.html</a></p><p>å‚è€ƒ:<a href="http://rk700.github.io/2014/10/26/ELF-segments-and-sections/" target="_blank" rel="noopener noreferrer">ELF segments and sections</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="åº“æ–‡ä»¶"></a>åº“æ–‡ä»¶<a class="hash-link" href="#åº“æ–‡ä»¶" title="Direct link to heading">#</a></h2><p>ç”Ÿæˆåº“æ–‡ä»¶</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">libtool -static -o libmylib.a add.o</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— vi main.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— clang main.c add.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— ./a.out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add(3,3)=6</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— clang -c add.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— ll</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">total 136</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rwxr-xr-x  1 Ding  staff    48K 10  6 21:49 a.out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff    40B 10  6 21:46 add.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff    22B 10  6 21:45 add.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   624B 10  6 21:49 add.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   118B 10  6 21:49 main.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— libtool -static -o libmyadd.a add.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— ll</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">total 144</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rwxr-xr-x  1 Ding  staff    48K 10  6 21:49 a.out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff    40B 10  6 21:46 add.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff    22B 10  6 21:45 add.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   624B 10  6 21:49 add.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   808B 10  6 21:50 libmyadd.a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   118B 10  6 21:49 main.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— clang -g -o main main.c -I . -L . -l myadd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— ll</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">total 248</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rwxr-xr-x  1 Ding  staff    48K 10  6 21:49 a.out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff    40B 10  6 21:46 add.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff    22B 10  6 21:45 add.h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   624B 10  6 21:49 add.o</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   808B 10  6 21:50 libmyadd.a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rwxr-xr-x  1 Ding  staff    49K 10  6 21:51 main</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r--  1 Ding  staff   118B 10  6 21:49 main.c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">drwxr-xr-x  3 Ding  staff    96B 10  6 21:51 main.dSYM</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">âœ  /Users/Ding/mine/gitee/clab/compile-as-ld/04-static-lib git:(master) âœ— ./main</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add(3,3)=6</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cstaticå˜é‡åŠ è½½é—®é¢˜"></a>C++Staticå˜é‡åŠ è½½é—®é¢˜<a class="hash-link" href="#cstaticå˜é‡åŠ è½½é—®é¢˜" title="Direct link to heading">#</a></h2><p><img alt="image-20211105164810704" src="/assets/images/image-20211105164810704-0a43f711e4c1917f91fc062a36bdee95.png"></p><ol><li>Other Linker Flags æ·»åŠ -all_load å¯ä»¥è§£å†³ï¼</li><li>ç”Ÿæˆä¸´æ—¶å˜é‡ä¹Ÿå¯ä»¥è§£å†³ï¼</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">IRZLogan* CreateRZLogan(const LoganConfig* cfg) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    RZTransportationHttp module1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    RZFileStorage module2;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">//    RZCompressZlib module3;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    RZControlFlowV1 module4;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    RZEncryptionV1 module5;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    RZFileNode module6;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    LoganConfig* newCfg = (LoganConfig*)cfg;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!checkConfig(newCfg)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        assert(0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return nullptr;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return new RZLoganV1(*newCfg);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="rtfm"></a>RTFM<a class="hash-link" href="#rtfm" title="Direct link to heading">#</a></h2><ul><li><a href="https://developer.apple.com/library/archive/technotes/tn2206/_index.html" target="_blank" rel="noopener noreferrer">[1] Apple Technical Note - TN2206: Mac OS X Code Signing In Depth</a></li><li><a href="https://www.nextop.de/NeXTstep_3.3_Developer_Documentation/DevTools/14_MachO/MachO.htmld/index.html" target="_blank" rel="noopener noreferrer">[2] NeXTSTEP 3,3 DevTools documentation, Chapter 14, Mach Object Files&quot; -- Documents the
original Mach-O format (which remains largely unchanged in OS X).</a></li><li><a href="https://www.cs.miami.edu/home/burt/learning/Csc521.091/docs/MachOTopics.pdf" target="_blank" rel="noopener noreferrer">[3] Apple Developer: Mach-O Programming Topics - - Basic architecture and loading</a></li><li><a href="https://github.com/aidansteele/osx-abi-macho-file-format-reference" target="_blank" rel="noopener noreferrer">[4] Apple Developer: Mac OS x ABI Mach-O File Format Reference -- Discussion on load commands</a></li><li>[5] Dream Team Absinthe and Corona Jailbreaks for iOS 5.0.l: <a href="http://onference.hitb.org/hitbsecconf2012ams/materials/" target="_blank" rel="noopener noreferrer">http://onference.hitb.org/hitbsecconf2012ams/materials/</a></li><li>[6] Apple Developer: Memory Management- Discusses memory management from the user mode perspective</li><li>[7] Apple Developer: Grand Central Dispatcher Reference</li><li>[8] Apple Developer: Concurrency Programming Guide</li><li><a href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/CodeFootprint/Articles/MachOOverview.html" target="_blank" rel="noopener noreferrer">Apple Developer:Overview of the Mach-O Executable Format</a></li><li><a href="https://www.nextop.de/NeXTstep_3.3_Developer_Documentation/" target="_blank" rel="noopener noreferrer">https://www.nextop.de/NeXTstep_3.3_Developer_Documentation/</a></li><li><a href="https://www.nextop.de/" target="_blank" rel="noopener noreferrer">https://www.nextop.de/</a></li><li><a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/MachOTopics/0-Introduction/introduction.html#//apple_ref/doc/uid/TP40001519" target="_blank" rel="noopener noreferrer">Mach-O Programming Topics</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="dys-typora-open://mine/survival/docs/ç¼–ç¨‹åŸºç¡€/è®¡ç®—æœºç³»ç»ŸåŸºç¡€/1-ç¨‹åº/2-äºŒè¿›åˆ¶æ ¼å¼/Mach-O.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objective-c" class="table-of-contents__link">Objective-C</a></li><li><a href="#mach-o-1" class="table-of-contents__link">Mach-O</a><ul><li><a href="#mach-header" class="table-of-contents__link">Mach header</a></li><li><a href="#load-commands" class="table-of-contents__link">Load Commands</a></li><li><a href="#symbol-table" class="table-of-contents__link">Symbol Table</a></li><li><a href="#dynamic-symbol-table" class="table-of-contents__link">Dynamic Symbol Table</a></li><li><a href="#string-table" class="table-of-contents__link">String Table</a></li><li><a href="#otool" class="table-of-contents__link">otool</a></li><li><a href="#ç¬¦å·ç”Ÿæˆè§„åˆ™" class="table-of-contents__link">ç¬¦å·ç”Ÿæˆè§„åˆ™</a></li><li><a href="#ç¬¦å·çš„ç§ç±»" class="table-of-contents__link">ç¬¦å·çš„ç§ç±»</a></li><li><a href="#å¯è§æ€§" class="table-of-contents__link">å¯è§æ€§</a></li></ul></li><li><a href="#segments-and-sections" class="table-of-contents__link">segments and sections</a></li><li><a href="#åº“æ–‡ä»¶" class="table-of-contents__link">åº“æ–‡ä»¶</a></li><li><a href="#cstaticå˜é‡åŠ è½½é—®é¢˜" class="table-of-contents__link">C++Staticå˜é‡åŠ è½½é—®é¢˜</a></li><li><a href="#rtfm" class="table-of-contents__link">RTFM</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.e736442d.js"></script>
<script src="/runtime~main.500606b1.js"></script>
<script src="/main.e34cadf8.js"></script>
<script src="/1.3353372a.js"></script>
<script src="/256.3f6603bc.js"></script>
<script src="/257.427a7301.js"></script>
<script src="/935f2afb.0ee8c40a.js"></script>
<script src="/255.24175022.js"></script>
<script src="/797cbab7.da239d5e.js"></script>
</body>
</html>