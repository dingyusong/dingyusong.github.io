<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Blog Atom Feed"><title data-react-helmet="true">2016-11-21-JSPatchæºç è§£æ | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="2016-11-21-JSPatchæºç è§£æ | My Site"><meta data-react-helmet="true" name="description" content="title: JSPatchæºç è§£æ"><meta data-react-helmet="true" property="og:description" content="title: JSPatchæºç è§£æ"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/Apple/iOSå¼€å‘/ä¸‰æ–¹æ¡†æ¶/2016-11-21-JSPatchæºç è§£æ"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/Apple/iOSå¼€å‘/ä¸‰æ–¹æ¡†æ¶/2016-11-21-JSPatchæºç è§£æ"><link rel="stylesheet" href="/styles.8cfbcdec.css">
<link rel="preload" href="/styles.e736442d.js" as="script">
<link rel="preload" href="/runtime~main.500606b1.js" as="script">
<link rel="preload" href="/main.e34cadf8.js" as="script">
<link rel="preload" href="/1.3353372a.js" as="script">
<link rel="preload" href="/256.3f6603bc.js" as="script">
<link rel="preload" href="/257.427a7301.js" as="script">
<link rel="preload" href="/935f2afb.0ee8c40a.js" as="script">
<link rel="preload" href="/255.24175022.js" as="script">
<link rel="preload" href="/d520deb9.4ba70645.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a><a class="navbar__item navbar__link" href="/docs/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€">ç¼–ç¨‹åŸºç¡€</a><a class="navbar__item navbar__link" href="/docs/ç¼–ç¨‹è¯­è¨€/ç¼–ç¨‹è¯­è¨€">ç¼–ç¨‹è¯­è¨€</a><a class="navbar__item navbar__link" href="/docs/å·¥å…·/å¸¸ç”¨å·¥å…·">å·¥å…·</a><a class="navbar__item navbar__link" href="/docs/åº”ç”¨å¼€å‘/åº”ç”¨å¼€å‘">åº”ç”¨å¼€å‘</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Apple/iOSå¼€å‘/iOSå¼€å‘">Apple</a><a class="navbar__item navbar__link" href="/docs/éŸ³è§†é¢‘/éŸ³è§†é¢‘">éŸ³è§†é¢‘</a><a class="navbar__item navbar__link" href="/docs/é¡¹ç›®/é¡¹ç›®">é¡¹ç›®</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">My Site</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€/ç¼–ç¨‹åŸºç¡€">ç¼–ç¨‹åŸºç¡€</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ç¼–ç¨‹è¯­è¨€/ç¼–ç¨‹è¯­è¨€">ç¼–ç¨‹è¯­è¨€</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/å·¥å…·/å¸¸ç”¨å·¥å…·">å·¥å…·</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/åº”ç”¨å¼€å‘/åº”ç”¨å¼€å‘">åº”ç”¨å¼€å‘</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/Apple/iOSå¼€å‘/iOSå¼€å‘">Apple</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/éŸ³è§†é¢‘/éŸ³è§†é¢‘">éŸ³è§†é¢‘</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/é¡¹ç›®/é¡¹ç›®">é¡¹ç›®</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">2016-11-21-JSPatchæºç è§£æ</h1></header><div class="markdown"><p>title: JSPatchæºç è§£æ
date: 2016-11-21 10:49:51
categories: [iOS,ä¸‰æ–¹æ¡†æ¶]
tags: [JSPatch]
toc: true</p><hr><p>æœ¬æ–‡ä¸€å‡ ä¸ªdemoæ¥ä¸²ä¸€ä¸²JSPatchçš„å®ç°åŸç†ï¼ŒåŒæ—¶ä¹Ÿå¯¹OCè¿è¡Œæ—¶çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶è¿›è¡Œå›é¡¾å’Œæ¸©ä¹ ã€‚</p><p>[toc]</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="åŸºç¡€"></a>åŸºç¡€<a class="hash-link" href="#åŸºç¡€" title="Direct link to heading">#</a></h1><p>è§£ædemoï¼š<a href="https://github.com/DingYusong/JSPatchDemoTutorial" target="_blank" rel="noopener noreferrer">https://github.com/DingYusong/JSPatchDemoTutorial</a></p><p>è¦ä»æ ¹æœ¬ä¸Šç†Ÿç»ƒæŒæ¡JSPatch ï¼Œè¦äº†è§£ä»¥ä¸‹åŸºç¡€çŸ¥è¯†ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="javascript"></a>JavaScript<a class="hash-link" href="#javascript" title="Direct link to heading">#</a></h2><ul><li><a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener noreferrer">ECMAScript 6 å…¥é—¨</a></li><li><a href="http://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000" target="_blank" rel="noopener noreferrer">JavaScriptæ•™ç¨‹</a></li></ul><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://github.com/whihail/JSPatch---comment" target="_blank" rel="noopener noreferrer">JSPatch---comment</a>  </li><li><a href="http://philonpang.github.io/blog/2015/06/26/jspatchxue-xi-yi-ji-iosping-tai-hotfixzai-xian-bu-ding-guan-li-fang-an-shi-xian/" target="_blank" rel="noopener noreferrer">IOSå¹³å°Hotfixæ¡†æ¶:JSPatchå­¦ä¹ ç¬”è®°åŠå’ŒWaxPatchçš„é›†æˆ</a>  </li><li><a href="https://segmentfault.com/a/1190000003870981" target="_blank" rel="noopener noreferrer">JSPatch å®ç°åŸç†è¯¦è§£ (æ•´æ”¹ç‰ˆ)</a></li></ul><p>Objective-C Runtime</p><p><a href="http://justsee.iteye.com/blog/2163777" target="_blank" rel="noopener noreferrer">Objective-C Runtime</a></p><p><a href="https://opensource.apple.com/source/objc4/" target="_blank" rel="noopener noreferrer">objcæºç </a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cè¯­è¨€åŸºç¡€"></a>Cè¯­è¨€åŸºç¡€<a class="hash-link" href="#cè¯­è¨€åŸºç¡€" title="Direct link to heading">#</a></h2><p>æŒ‡å‘ç»“æ„ä½“å˜é‡çš„æŒ‡é’ˆ</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ç»“æ„æŒ‡é’ˆå˜é‡è¯´æ˜çš„ä¸€èˆ¬å½¢å¼ä¸º:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct ç»“æ„å *ç»“æ„æŒ‡é’ˆå˜é‡å</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ä¾‹å¦‚ï¼Œåœ¨å‰é¢çš„ä¾‹é¢˜ä¸­å®šä¹‰äº† stu è¿™ä¸ªç»“æ„ï¼Œå¦‚è¦è¯´æ˜ä¸€ä¸ªæŒ‡å‘ stu çš„æŒ‡é’ˆå˜é‡ pstuï¼Œ å¯å†™ä¸º:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct stu *pstu;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">struct stu {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      int num;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      char *name;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      char sex;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      float score;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } boy1={102,&quot;Zhang ping&quot;,&#x27;M&#x27;,78.5},*pstu;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ç¬¬185é¡µ</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">main() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pstu=&amp;boy1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    printf(&quot;Number=%d\nName=%s\n&quot;,boy1.num,boy1.name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    printf(&quot;Sex=%c\nScore=%f\n\n&quot;,boy1.sex,boy1.score);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    printf(&quot;Number=%d\nName=%s\n&quot;,(*pstu).num,(*pstu).name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    printf(&quot;Sex=%c\nScore=%f\n\n&quot;,(*pstu).sex,(*pstu).score);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    printf(&quot;Number=%d\nName=%s\n&quot;,pstu-&gt;num,pstu-&gt;name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    printf(&quot;Sex=%c\nScore=%f\n\n&quot;,pstu-&gt;sex,pstu-&gt;score);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ç±»å‹å®šä¹‰ç¬¦typedef</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cè¯­è¨€ä¸ä»…æä¾›äº†ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼Œè€Œä¸”è¿˜å…è®¸ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰ç±»å‹è¯´æ˜ç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´ å…è®¸ç”±ç”¨æˆ·ä¸ºæ•°æ®ç±»å‹å–â€œåˆ«åâ€ã€‚ç±»å‹å®šä¹‰ç¬¦ typedef å³å¯ç”¨æ¥å®Œæˆæ­¤åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œæœ‰æ•´ å‹é‡ a,b,å…¶è¯´æ˜å¦‚ä¸‹:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">int a,b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                       ç¬¬193é¡µ</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">å…¶ä¸­ int æ˜¯æ•´å‹å˜é‡çš„ç±»å‹è¯´æ˜ç¬¦ã€‚int çš„å®Œæ•´å†™æ³•ä¸º integerï¼Œä¸ºäº†å¢åŠ ç¨‹åºçš„å¯è¯»æ€§ï¼Œ å¯æŠŠæ•´å‹è¯´æ˜ç¬¦ç”¨ typedef å®šä¹‰ä¸º:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    typedef int INTEGER</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">è¿™ä»¥åå°±å¯ç”¨ INTEGER æ¥ä»£æ›¿ int ä½œæ•´å‹å˜é‡çš„ç±»å‹è¯´æ˜äº†ã€‚ ä¾‹å¦‚:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INTEGER a,b; å®ƒç­‰æ•ˆäº:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">int a,b;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ç”¨ typedef å®šä¹‰æ•°ç»„ã€æŒ‡é’ˆã€ç»“æ„ç­‰ç±»å‹å°†å¸¦æ¥å¾ˆå¤§çš„æ–¹ä¾¿ï¼Œä¸ä»…ä½¿ç¨‹åºä¹¦å†™ç®€å•è€Œä¸”</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ä½¿æ„ä¹‰æ›´ä¸ºæ˜ç¡®ï¼Œå› è€Œå¢å¼ºäº†å¯è¯»æ€§ã€‚</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ä¾‹å¦‚:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">typedef char NAME[20]; è¡¨ç¤º NAME æ˜¯å­—ç¬¦æ•°ç»„ç±»å‹ï¼Œæ•°ç»„é•¿åº¦ä¸º 20ã€‚ç„¶åå¯ ç”¨ NAME è¯´æ˜å˜é‡ï¼Œå¦‚:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">NAME a1,a2,s1,s2; å®Œå…¨ç­‰æ•ˆäº:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">char a1[20],a2[20],s1[20],s2[20] åˆå¦‚:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        typedef struct stu</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        { char name[20];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          int age;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          char sex;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} STU;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">å®šä¹‰ STU è¡¨ç¤º stu çš„ç»“æ„ç±»å‹ï¼Œç„¶åå¯ç”¨ STU æ¥è¯´æ˜ç»“æ„å˜é‡:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">STU body1,body2; typedef å®šä¹‰çš„ä¸€èˆ¬å½¢å¼ä¸º:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">typedef åŸç±»å‹å æ–°ç±»å‹å</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">å…¶ä¸­åŸç±»å‹åä¸­å«æœ‰å®šä¹‰éƒ¨åˆ†ï¼Œæ–°ç±»å‹åä¸€èˆ¬ç”¨å¤§å†™è¡¨ç¤ºï¼Œä»¥ä¾¿äºåŒºåˆ«ã€‚ æœ‰æ—¶ä¹Ÿå¯ç”¨å®å®šä¹‰æ¥ä»£æ›¿ typedef çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®å®šä¹‰æ˜¯ç”±é¢„å¤„ç†å®Œæˆçš„ï¼Œè€Œ typedef</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">åˆ™æ˜¯åœ¨ç¼–è¯‘æ—¶å®Œæˆçš„ï¼Œåè€…æ›´ä¸ºçµæ´»æ–¹ä¾¿ã€‚</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="http://www.cocoachina.com/ios/20141008/9844.html" target="_blank" rel="noopener noreferrer">ç†è§£ Objective-C Runtime</a></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="æµç¨‹"></a>æµç¨‹<a class="hash-link" href="#æµç¨‹" title="Direct link to heading">#</a></h1><p>é€šè¿‡å‡ ä¸ªç®€å•çš„demoæ¥æ¢³ç†ä¸€ä¸‹JSPatchçš„æ‰§è¡Œçš„æµç¨‹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="é€šè¿‡jspatchè°ƒç”¨ocæ–¹æ³•ã€‚"></a>é€šè¿‡JSPatchè°ƒç”¨OCæ–¹æ³•ã€‚<a class="hash-link" href="#é€šè¿‡jspatchè°ƒç”¨ocæ–¹æ³•ã€‚" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬å°±å…·ä½“ç¤ºä¾‹æ¥åˆ†æã€‚</p><p>åœ¨æˆ‘çš„demo-1åˆ†æ”¯ï¼Œå®ç°äº†ä¸€ä¸ªé€šè¿‡ä¸‹å‘jsè„šæœ¬å¼¹å‡ºäº†ä¸€ä¸ªalertViewã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹ä»–æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>ç¬¬ä¸€å¥ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = require(&#x27;UIAlertView&#x27;).alloc().init();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="require"></a>require<a class="hash-link" href="#require" title="Direct link to heading">#</a></h3><p>å…ˆçœ‹<code>require(&#x27;UIAlertView&#x27;)</code></p><p>å¾ˆæ˜¾ç„¶æ ¹æ®JSçš„è¯­æ³•ï¼Œrequireæ˜¯ä¸€ä¸ªæŒ‚è½½å…¨å±€ä¸‹çš„å‡½æ•°ã€‚çœ‹ä¸€ä¸‹ä»–çš„å®ç°ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  var _require = function(clsName) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!global[clsName]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      global[clsName] = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        __clsName: clsName</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return global[clsName]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  global.require = function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var lastRequire</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    for (var i = 0; i &lt; arguments.length; i ++) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      arguments[i].split(&#x27;,&#x27;).forEach(function(clsName) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        lastRequire = _require(clsName.trim())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      })</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return lastRequire</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>require</code>çš„<code>arguments=[&#x27;UIAlertView&#x27;] </code>  ,è°ƒç”¨<code>_require(UIAlertView)</code> å®Œæˆååœ¨globalå¯¹è±¡ä¸‹æŒ‚è½½äº†ä¸€ä¸ª<code>UIAlertView</code>çš„jså¯¹è±¡ï¼Œå¯¹è±¡çš„å†…å®¹æ˜¯</p><p><code>require(&#x27;UIAlertView&#x27;)</code>æ‰§è¡Œå®Œæˆçš„æ—¶å€™æ•ˆæœå¦‚ä¸‹ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">global.UIAlertView = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    __clsName: UIAlertView</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>é‚£ä¹ˆç¬¬ä¸€å¥å°±å˜æˆäº†ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = global.UIAlertView.alloc().init();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="è°ƒç”¨ç±»æ–¹æ³•"></a>è°ƒç”¨ç±»æ–¹æ³•<a class="hash-link" href="#è°ƒç”¨ç±»æ–¹æ³•" title="Direct link to heading">#</a></h3><p><code>UIAlertView</code>è¿™ä¸ªå¯¹è±¡JSç¯å¢ƒä¸‹æ˜¯æ²¡æœ‰allocæ–¹æ³•çš„ï¼Œæ˜¾ç„¶ç›´æ¥æ‰§è¡Œæ˜¯è¡Œä¸é€šçš„ã€‚</p><p>æˆ‘æ»¡æ¥çœ‹ä¸€ä¸‹è¿™æ®µJSä»£ç çš„æ‰§è¡Œå…¥å£ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    [NSURLConnection sendAsynchronousRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@&quot;http://localhost:3601/demo.js&quot;]] queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *data, NSError *connectionError) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        NSString *script = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [JPEngine evaluateScript:script];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è¿›å…¥è¿™ä¸ªæ–¹æ³•<code>[JPEngine evaluateScript:script];</code>å‘ç°å…¶å®ä¸‹é¢è¿™æ®µscript</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = require(&#x27;UIAlertView&#x27;).alloc().init();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.setTitle(&#x27;Alert&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.setMessage(&#x27;AlertView from js&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.addButtonWithTitle(&#x27;OK&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.show();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è¢«æ­£åˆ™åŒ¹é…æ›¿æ¢æˆäº†å¦‚ä¸‹è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå¤§çš„è‡ªæ‰§è¡Œå‡½æ•°ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">;(function(){try{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = require(&#x27;UIAlertView&#x27;).__c(&quot;alloc&quot;)().__c(&quot;init&quot;)();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;setTitle&quot;)(&#x27;Alert&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;setMessage&quot;)(&#x27;AlertView from js&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;addButtonWithTitle&quot;)(&#x27;OK&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;show&quot;)();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}catch(e){_OC_catch(e.message, e.stack)}})();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ç¬¬ä¸€å¥ä»£ç å…¶å®å˜æˆäº†è¿™æ ·ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = global.UIAlertView.__c(&quot;alloc&quot;)().__c(&quot;init&quot;)();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>çœ‹ç¬¬ä¸€é”»å‡½æ•°<code>global.UIAlertView.__c(&quot;alloc&quot;)()</code> å°±æ˜¯<code>__C</code>å‡½æ•°ï¼Œå‚æ•°ä¸º<code>alloc</code>ã€‚å¾ˆå·§å¦™çš„ç‚¹åœ¨äºå°†OCæ–¹æ³•è½¬æ¢æˆäº†ä¸€ä¸ªå‚æ•°ï¼Œè¿™æ˜¯æ•´ä¸ªJSPatchçš„æ ¸å¿ƒï¼Œæ­¤å¤„ç›¸å½“äºä¸€ä¸ªè·¯ç”±ä¸­å¿ƒã€‚</p><p><code>__C</code>å‡½æ•°å“ªé‡Œæ¥çš„ï¼ŸUIAlertæ˜¯è¿™æ ·ä¸€ä¸ªå¯¹è±¡å•Š<code>global.UIAlertView = { __clsName: UIAlertView }</code>ï¼Œå“ªæ¥çš„<code>__c</code>å‡½æ•°ï¼Œåˆ«æ€¥ï¼Œæ˜¯å¦è¿˜è®°å¾—<code>startEngine </code></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objective-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">+ (void)startEngine</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NSString *path = [[NSBundle bundleForClass:[self class]] pathForResource:@&quot;JSPatch&quot; ofType:@&quot;js&quot;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!path) _exceptionBlock(@&quot;can&#x27;t find JSPatch.js&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NSString *jsCore = [[NSString alloc] initWithData:[[NSFileManager defaultManager] contentsAtPath:path] encoding:NSUTF8StringEncoding];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ([_context respondsToSelector:@selector(evaluateScript:withSourceURL:)]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [_context evaluateScript:jsCore withSourceURL:[NSURL URLWithString:@&quot;JSPatch.js&quot;]];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [_context evaluateScript:jsCore];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>å…ˆä¸ç®¡å‰é¢çš„ä¸€å¤§å †ï¼Œåé¢å‘ç°ä»–å‘JSContexté‡Œæ³¨å…¥äº†ä¸€æ®µJSï¼Œç”±æ­¤å¯è§è¿™ä¸ª<code>__C</code>å¿…å®šæ˜¯ä»è¿™é‡Œæ³¨å…¥çš„jsç¯å¢ƒçš„ã€‚é‚£ä¹ˆæŸ¥çœ‹JSPatch.js,æ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> _customMethods </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">__c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> slf </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf </span><span class="token keyword" style="font-style:italic">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Boolean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">throw</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> methodName </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27; is undefined&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__isSuper</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_OC_superClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__realClsName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__realClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> clsName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">clsName </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> methodType </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;instMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;clsMethods&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__isSuper</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> args </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">slice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">call</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">arguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_methodFunc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__isSuper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> slf </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__realClsName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__realClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> __clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> __isSuper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">performSelectorInOC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> slf </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> args </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">slice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">call</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">arguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">__isPerformInOC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> sel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">performSelector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> slf </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> args </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">slice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">call</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">arguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_methodFunc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">splice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__isSuper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> method </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> _customMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_customMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">hasOwnProperty</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">method</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">defineProperty</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> method</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> _customMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">method</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> configurable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> enumerable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>_customMethods  æ˜¯ä¸€ä¸ªå¯¹è±¡åŒ…å« <code>__C</code>,<code>super</code>,<code>performSelectorInOC</code>,<code>performSelector</code> è¿™å››ä¸ªå‡½æ•°å±æ€§ã€‚</p><p>ä¸‹é¢æœ‰ä¸ªforå¾ªç¯å¯¹_customMethodså¯¹è±¡è¿›è¡Œéå†ã€‚ç»™åŸºç±»Objectæ·»åŠ <code>__C</code>,<code>super</code>,<code>performSelectorInOC</code>,<code>performSelector</code> è¿™4ä¸ªæ–¹æ³•ã€‚</p><p>è€Œæ‰€æœ‰çš„JSç±»éƒ½æ˜¯ç»§æ‰¿<code>Object</code>çš„ï¼Œæ‰€ä»¥<code>UIAlertView</code>ä¹Ÿèƒ½ä½¿ç”¨<code>__C</code>æ–¹æ³•ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = global.UIAlertView.__c(&quot;alloc&quot;)().__c(&quot;init&quot;)();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æ‰€ä»¥åˆ°æ­¤è¿™å¥ä»£ç å°±åˆç†äº†ã€‚</p><p>å†æ¥çœ‹çœ‹<code>__C</code>æ˜¯å¦‚ä½•æ‰§è¡Œçš„ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> slf </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf </span><span class="token keyword" style="font-style:italic">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Boolean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">throw</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> methodName </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27; is undefined&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__isSuper</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_OC_superClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__realClsName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__realClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> clsName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">clsName </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> methodType </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;instMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;clsMethods&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__isSuper</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> args </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">slice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">call</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">arguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_methodFunc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> slf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">__isSuper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æ­¤å¤„çš„thiså¯ä»¥ç†è§£ä¸º<code>UIAlertView</code> methodName æ˜¯allocã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">global.UIAlertView = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    __clsName: UIAlertView</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è€Œç›®å‰æ¥çœ‹<code>_ocCls</code> æ˜¯ä¸ªç©ºå¯¹è±¡ï¼Œè‡ªç„¶èµ°åˆ°äº†æœ€åä¸€æ­¥ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">_methodFunc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token maybe-class-name">UIAlertView</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> alloc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>_methodFunc</code>å¦‚ä¸‹ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">_methodFunc</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">instance</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> clsName</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> methodName</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> args</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> isSuper</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> isPerformSelector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> selectorName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> methodName</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">isPerformSelector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      methodName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex">/__/g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;-&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      selectorName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> methodName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex">/_/g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;:&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex">/-/g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;_&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> marchArr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> selectorName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">match</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex">/:/g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> numOfArgs </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> marchArr </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> marchArr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> numOfArgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        selectorName </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;:&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> ret </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> instance </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_OC_callI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> selectorName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> isSuper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                         </span><span class="token function" style="color:rgb(130, 170, 255)">_OC_callC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">clsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> selectorName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_formatOCToJS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">_OC_callC(UIAlertView, alloc, [])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è¿™ä¸ªæ˜¯å¼•æ“é‡Œé¢æ³¨å…¥çš„æ–¹æ³•ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objective-c codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    context[@&quot;_OC_callC&quot;] = ^id(NSString *className, NSString *selectorName, JSValue *arguments) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return callSelector(className, selectorName, arguments, nil, NO);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">callSelector(UIAlertView, alloc, [], nil, NO);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>callSelectorå‡½æ•°éå¸¸é•¿ï¼Œè¿™ä¸ªå‡½æ•°æ¶‰åŠåˆ°OCçš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼Œç®—æ˜¯æ•´ä¸ªJSPatchçš„OCç«¯çš„æ ¸å¿ƒäº†ã€‚å‡½æ•°æˆ‘å°±ä¸è´´åœ¨è¿™é‡Œï¼Œå’±ä»¬ä¸€æ­¥ä¸€æ­¥çš„åˆ†æã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">static id callSelector(NSString *className, NSString *selectorName, JSValue *arguments, JSValue *instance, BOOL isSuper)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Class cls = instance ? [instance class] : NSClassFromString(className);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    SEL selector = NSSelectorFromString(selectorName);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>clsä¸ºUIAlertView  selectorä¸ºallocã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">        methodSignature = [cls methodSignatureForSelector:selector];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        methodSignature = fixSignature(methodSignature);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!methodSignature) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _exceptionBlock([NSString stringWithFormat:@&quot;unrecognized selector %@ for class %@&quot;, selectorName, className]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return nil;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        invocation= [NSInvocation invocationWithMethodSignature:methodSignature];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [invocation setTarget:cls];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [invocation invoke];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>1.æ ¹æ®alloc åˆ›å»ºNSMethodSignature ç­¾åå¯¹è±¡ methodSignature </p><p>2.æ ¹æ®ç­¾åå¯¹è±¡methodSignatureåˆ›å»ºNSInvocation å¯¹è±¡invocation</p><p>3.è®¾ç½®ç­¾åå¯¹è±¡çš„targetä¸º UIAlertViewã€‚</p><p>4.invoke æ‰§è¡Œã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">            void *result;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            [invocation getReturnValue:&amp;result];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            //For performance, ignore the other methods prefix with alloc/new/copy/mutableCopy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if ([selectorName isEqualToString:@&quot;alloc&quot;] || [selectorName isEqualToString:@&quot;new&quot;] ||</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                [selectorName isEqualToString:@&quot;copy&quot;] || [selectorName isEqualToString:@&quot;mutableCopy&quot;]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                returnValue = (__bridge_transfer id)result;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                returnValue = (__bridge id)result;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return formatOCToJS(returnValue);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">static id formatOCToJS(id obj)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ([obj isKindOfClass:[NSString class]] || [obj isKindOfClass:[NSDictionary class]] || [obj isKindOfClass:[NSArray class]] || [obj isKindOfClass:[NSDate class]]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _autoConvert ? obj: _wrapObj([JPBoxing boxObj:obj]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ([obj isKindOfClass:[NSNumber class]]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return _convertOCNumberToString ? [(NSNumber*)obj stringValue] : obj;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ([obj isKindOfClass:NSClassFromString(@&quot;NSBlock&quot;)] || [obj isKindOfClass:[JSValue class]]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return obj;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return _wrapObj(obj);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">static NSDictionary *_wrapObj(id obj)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!obj || obj == _nilObj) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return @{@&quot;__isNil&quot;: @(YES)};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return @{@&quot;__obj&quot;: obj, @&quot;__clsName&quot;: NSStringFromClass([obj isKindOfClass:[JPBoxing class]] ? [[((JPBoxing *)obj) unbox] class]: [obj class])};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var ret = instance ? _OC_callI(instance, selectorName, args, isSuper):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                         _OC_callC(clsName, selectorName, args)          //å¦‚æœinstanceå€¼ä¸ºYESï¼Œåˆ™ä¸ºå®ä¾‹å¯¹è±¡ï¼Œå¦åˆ™ä¸ºç±»å¯¹è±¡</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return _formatOCToJS(ret)            //å°†è°ƒç”¨OCæ–¹æ³•çš„è¿”å›å€¼è½¬åŒ–ä¸ºjså¯¹è±¡ è¿”å›</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">obj = {__obj: UIAlertView, __clsName: &quot;UIAlertView&quot;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è‡³æ­¤ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³• <code>require(&#x27;UIAlertView&#x27;).alloc()</code>æµç¨‹ç»“æŸã€‚returnä¸€ä¸ªå¯¹è±¡ä¸ºï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">obj = {__obj: UIAlertView, __clsName: &quot;UIAlertView&quot;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="è°ƒç”¨å®ä¾‹æ–¹æ³•"></a>è°ƒç”¨å®ä¾‹æ–¹æ³•<a class="hash-link" href="#è°ƒç”¨å®ä¾‹æ–¹æ³•" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="æ— å‚æ•°"></a>æ— å‚æ•°<a class="hash-link" href="#æ— å‚æ•°" title="Direct link to heading">#</a></h4><p>æ‰¿æ¥ä¸Šæ–‡åº”è¯¥æ˜¯ï¼š<code>obj.init();</code>è¿›ä¸€æ­¥è½¬ä¸ºä¸º<code>obj.__c(&quot;init&quot;)()</code></p><p>æœ¬æ¬¡æ˜¯å®ä¾‹æ–¹æ³•ã€‚</p><p>åº”ä¸º<code>slf.__obj=UIAlertView</code>æ‰€ä»¥æ­¤æ¬¡<code>__C</code>å‡½æ•°åº”è¯¥</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">_methodFunc(UIAlertView, &#x27;UIAlertView&#x27;, init, [], null)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>å¾ˆè‡ªç„¶çš„èµ°åˆ°äº†<code>_OC_callI</code>å‡½æ•°ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">callSelector(nil, init, [], UIAlertView*, null);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">static id callSelector(NSString *className, NSString *selectorName, JSValue *arguments, JSValue *instance, BOOL isSuper)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>JSValueçš„toObjectè½¬æˆå¯¹è±¡äº†ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [_JSMethodSignatureLock lock];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!_JSMethodSignatureCache[cls]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _JSMethodSignatureCache[(id&lt;NSCopying&gt;)cls] = [[NSMutableDictionary alloc]init];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        methodSignature = _JSMethodSignatureCache[cls][selectorName];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (!methodSignature) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            methodSignature = [cls instanceMethodSignatureForSelector:selector];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            methodSignature = fixSignature(methodSignature);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            _JSMethodSignatureCache[cls][selectorName] = methodSignature;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [_JSMethodSignatureLock unlock];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>å®ä¾‹æ–¹æ³•çš„ç¼“å­˜ï¼Œä¸‹æ¬¡è°ƒç”¨å°±ç›´æ¥ä»ç¼“å­˜é‡Œé¢å–ï¼Œä¸ç”¨å†ç”ŸæˆNSMethodSignatureæ–¹æ³•ç­¾åå¯¹è±¡äº†ã€‚</p><p>æ‰§è¡Œå®Œ<code>obj.__c(&quot;init&quot;)()</code> åˆ™alertviewå˜é‡å°±å˜æˆäº†ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = {__obj: UIAlertView, __clsName: &quot;UIAlertView&quot;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>åŒæ ·åé¢çš„å‡ å¥ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">;(function(){try{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var alertView = require(&#x27;UIAlertView&#x27;).__c(&quot;alloc&quot;)().__c(&quot;init&quot;)();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;setTitle&quot;)(&#x27;Alert&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;setMessage&quot;)(&#x27;AlertView from js&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;addButtonWithTitle&quot;)(&#x27;OK&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alertView.__c(&quot;show&quot;)();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}catch(e){_OC_catch(e.message, e.stack)}})();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è¯´ä¸€è¯´æœ‰åŒºåˆ«çš„ç‚¹ï¼Œå®ä¾‹å‡½æ•°ä¼ å‚ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="æœ‰å‚æ•°"></a>æœ‰å‚æ•°<a class="hash-link" href="#æœ‰å‚æ•°" title="Direct link to heading">#</a></h4><p>å¯¹settitle</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id argumentsObj = formatJSToOC(arguments);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;__NSArrayM 0x6040004411d0&gt;(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Alert</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è¿™ä¸€å¤§å—éƒ½æ˜¯è®¾ç½®NSinvocationçš„å‚æ•°ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NSUInteger numberOfArguments = methodSignature.numberOfArguments;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NSInteger inputArguments = [(NSArray *)argumentsObj count];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (inputArguments &gt; numberOfArguments - 2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // calling variable argument method, only support parameter type `id` and return type `id`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id sender = instance != nil ? instance : cls;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id result = invokeVariableParameterMethod(argumentsObj, methodSignature, sender, selector);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return formatOCToJS(result);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    for (NSUInteger i = 2; i &lt; numberOfArguments; i++) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        const char *argumentType = [methodSignature getArgumentTypeAtIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id valObj = argumentsObj[i-2];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        switch (argumentType[0] == &#x27;r&#x27; ? argumentType[1] : argumentType[0]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                #define JP_CALL_ARG_CASE(_typeString, _type, _selector) \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                case _typeString: {                              \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    _type value = [valObj _selector];                     \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    [invocation setArgument:&amp;value atIndex:i];\</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    break; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;c&#x27;, char, charValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;C&#x27;, unsigned char, unsignedCharValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;s&#x27;, short, shortValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;S&#x27;, unsigned short, unsignedShortValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;i&#x27;, int, intValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;I&#x27;, unsigned int, unsignedIntValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;l&#x27;, long, longValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;L&#x27;, unsigned long, unsignedLongValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;q&#x27;, long long, longLongValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;Q&#x27;, unsigned long long, unsignedLongLongValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;f&#x27;, float, floatValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;d&#x27;, double, doubleValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_CASE(&#x27;B&#x27;, BOOL, boolValue)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case &#x27;:&#x27;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                SEL value = nil;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (valObj != _nilObj) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    value = NSSelectorFromString(valObj);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                [invocation setArgument:&amp;value atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case &#x27;{&#x27;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                NSString *typeString = extractStructName([NSString stringWithUTF8String:argumentType]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JSValue *val = arguments[i-2];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                #define JP_CALL_ARG_STRUCT(_type, _methodName) \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if ([typeString rangeOfString:@#_type].location != NSNotFound) {    \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    _type value = [val _methodName];  \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    [invocation setArgument:&amp;value atIndex:i];  \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    break; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_STRUCT(CGRect, toRect)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_STRUCT(CGPoint, toPoint)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_STRUCT(CGSize, toSize)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                JP_CALL_ARG_STRUCT(NSRange, toRange)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                @synchronized (_context) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    NSDictionary *structDefine = _registeredStruct[typeString];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    if (structDefine) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        size_t size = sizeOfStructTypes(structDefine[@&quot;types&quot;]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        void *ret = malloc(size);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        getStructDataWithDict(ret, valObj, structDefine);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        [invocation setArgument:ret atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        free(ret);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case &#x27;*&#x27;:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case &#x27;^&#x27;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if ([valObj isKindOfClass:[JPBoxing class]]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    void *value = [((JPBoxing *)valObj) unboxPointer];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    if (argumentType[1] == &#x27;@&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        if (!_TMPMemoryPool) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            _TMPMemoryPool = [[NSMutableDictionary alloc] init];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        if (!_markArray) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            _markArray = [[NSMutableArray alloc] init];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        memset(value, 0, sizeof(id));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        [_markArray addObject:valObj];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    [invocation setArgument:&amp;value atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case &#x27;#&#x27;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if ([valObj isKindOfClass:[JPBoxing class]]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    Class value = [((JPBoxing *)valObj) unboxClass];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    [invocation setArgument:&amp;value atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            default: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (valObj == _nullObj) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    valObj = [NSNull null];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    [invocation setArgument:&amp;valObj atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if (valObj == _nilObj ||</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    ([valObj isKindOfClass:[NSNumber class]] &amp;&amp; strcmp([valObj objCType], &quot;c&quot;) == 0 &amp;&amp; ![valObj boolValue])) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    valObj = nil;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    [invocation setArgument:&amp;valObj atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    break;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                if ([(JSValue *)arguments[i-2] hasProperty:@&quot;__isBlock&quot;]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    JSValue *blkJSVal = arguments[i-2];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    Class JPBlockClass = NSClassFromString(@&quot;JPBlock&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    if (JPBlockClass &amp;&amp; ![blkJSVal[@&quot;blockObj&quot;] isUndefined]) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        __autoreleasing id cb = [JPBlockClass performSelector:@selector(blockWithBlockObj:) withObject:[blkJSVal[@&quot;blockObj&quot;] toObject]];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        [invocation setArgument:&amp;cb atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        __autoreleasing id cb = genCallbackBlock(arguments[i-2]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        [invocation setArgument:&amp;cb atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    [invocation setArgument:&amp;valObj atIndex:i];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è®¾ç½®å®Œæˆä¹‹åinvokeæ‰§è¡Œå’Œä¸Šé¢ä¸€æ ·ã€‚</p><p>è·å–è¿”å›å€¼ç±»å‹<code>methodReturnType</code></p><p><code>strcpy(returnType, [methodSignature methodReturnType]); </code></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (strncmp(returnType, &quot;v&quot;, 1) != 0) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    //éç©ºç±»å‹</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><a href="http://www.runoob.com/cprogramming/c-function-strncmp.html" target="_blank" rel="noopener noreferrer">http://www.runoob.com/cprogramming/c-function-strncmp.html</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ä¿®æ”¹å·²æœ‰æ–¹æ³•"></a>ä¿®æ”¹å·²æœ‰æ–¹æ³•<a class="hash-link" href="#ä¿®æ”¹å·²æœ‰æ–¹æ³•" title="Direct link to heading">#</a></h2><ol><li>æ‹¿åˆ°è¦ä¿®æ”¹æ–¹æ³•çš„impæŒ‡é’ˆã€‚</li><li>æ‹¿åˆ°è¦ä¿®æ”¹æ–¹æ³•çš„å‚æ•°ç±»å‹ã€‚</li><li>æ–°å¢ä¸€ä¸ªæ–¹æ³•æŒ‡å‘åŸæ¥çš„æ–¹æ³•çš„impã€‚ï¼ˆä¿ç•™æ—§æ–¹æ³•ï¼Œä½†æ˜¯æ”¹åäº†ï¼‰</li><li>æŠŠæ—§æ–¹æ³•çš„selectoræŒ‡å‘æ–°çš„impå®ç°ã€‚ï¼ˆè¾¾åˆ°ä¿®æ”¹æ–¹æ³•çš„ç›®çš„äº†ï¼‰</li></ol><p>è¿™å‡ ä¸ªè¿‡ç¨‹ç”¨äº†å¾ˆå¤šruntimeæ¥å£æ–¹æ³•ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">å½“è°ƒç”¨ä¸€ä¸ª NSObject å¯¹è±¡ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œå¹¶ä¸ä¼šé©¬ä¸ŠæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯ä¼šç»è¿‡å¤šå±‚è½¬å‘ï¼Œå±‚å±‚è°ƒç”¨å¯¹è±¡çš„ -resolveInstanceMethod:, -forwardingTargetForSelector:, -methodSignatureForSelector:, -forwardInvocation: ç­‰æ–¹æ³•ï¼Œå…¶ä¸­æœ€å -forwardInvocation: æ˜¯ä¼šæœ‰ä¸€ä¸ª NSInvocation å¯¹è±¡ï¼Œè¿™ä¸ª NSInvocation å¯¹è±¡ä¿å­˜äº†è¿™ä¸ªæ–¹æ³•è°ƒç”¨çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Selector åï¼Œå‚æ•°å’Œè¿”å›å€¼ç±»å‹ï¼Œæœ€é‡è¦çš„æ˜¯æœ‰æ‰€æœ‰å‚æ•°å€¼ï¼Œå¯ä»¥ä»è¿™ä¸ª NSInvocation å¯¹è±¡é‡Œæ‹¿åˆ°è°ƒç”¨çš„æ‰€æœ‰å‚æ•°å€¼ã€‚æˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•è®©æ¯ä¸ªéœ€è¦è¢« JS æ›¿æ¢çš„æ–¹æ³•è°ƒç”¨æœ€åéƒ½è°ƒåˆ° -forwardInvocation:ï¼Œå°±å¯ä»¥è§£å†³æ— æ³•æ‹¿åˆ°å‚æ•°å€¼çš„é—®é¢˜äº†ã€‚</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ç¥æ¥ä¹‹ç¬”ï¼š</p><p>ä¸€ä¸ªç‰¹æ®Šçš„å…¨å±€IMPï¼š<code>_objc_msgForward</code></p><p>ç›´æ¥é€šè¿‡class_replaceMethodå°†æ–¹æ³•çš„IMP æ›¿æ¢æˆ <code>_objc_msgForward</code> è¿™æ ·è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶å°±ä¼šèµ°åˆ° <code>-forwardInvocation:</code>ã€‚</p><p>æœ€åä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æŠŠ UIViewController çš„ <code>-forwardInvocation:</code> æ–¹æ³•çš„å®ç°ç»™æ›¿æ¢æ‰äº†ï¼Œå¦‚æœç¨‹åºé‡ŒçœŸæœ‰ç”¨åˆ°è¿™ä¸ªæ–¹æ³•å¯¹æ¶ˆæ¯è¿›è¡Œè½¬å‘ï¼ŒåŸæ¥çš„é€»è¾‘æ€ä¹ˆåŠï¼Ÿé¦–å…ˆæˆ‘ä»¬åœ¨æ›¿æ¢ <code>-forwardInvocation:</code> æ–¹æ³•å‰ä¼šæ–°å»ºä¸€ä¸ªæ–¹æ³• <code>-ORIGforwardInvocation:</code>ï¼Œä¿å­˜åŸæ¥çš„å®ç°IMPï¼Œåœ¨æ–°çš„ <code>-forwardInvocation:</code> å®ç°é‡Œåšäº†ä¸ªåˆ¤æ–­ï¼Œå¦‚æœè½¬å‘çš„æ–¹æ³•æ˜¯æˆ‘ä»¬æƒ³æ”¹å†™çš„ï¼Œå°±èµ°æˆ‘ä»¬çš„é€»è¾‘ï¼Œè‹¥ä¸æ˜¯ï¼Œå°±è°ƒ <code>-ORIGforwardInvocation:</code> èµ°åŸæ¥çš„æµç¨‹ã€‚</p><p>è¦çœ‹æºä»£ç çš„è¯è¯·åˆ‡æ¢åˆ°demo-2ã€‚demoä¸ºä¿®æ”¹Peopleçš„å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•çš„å®ç°ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@interface People : NSObject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-(void)eat;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+(NSInteger)handsNumber;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@implementation People</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-(void)eat{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NSLog(@&quot;eating one time&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+(NSInteger)handsNumber{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">defineClass(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;People&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        eat: function () {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self.ORIGeat();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            console.log(&#x27;eat two times&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        handsNumber: function () {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            return 2;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>æœªä¿®æ”¹ä¹‹å‰æ˜¯è¿™æ ·çš„ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">2018-07-25 17:54:04.062150+0800 JSPatchDemoTutorial[44808:17595827] People has 1 hand</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2018-07-25 17:54:04.062330+0800 JSPatchDemoTutorial[44808:17595827] eating one time</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ä¿®æ”¹ä¹‹åæ˜¯è¿™æ ·çš„ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">2018-07-25 17:50:04.728957+0800 JSPatchDemoTutorial[44570:17586864] People has 2 hand</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2018-07-25 17:50:04.731803+0800 JSPatchDemoTutorial[44570:17586864] eating one time</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2018-07-25 17:50:04.732548+0800 JSPatchDemoTutorial[44570:17586864] JSPatch.log: eat two times</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>çº¿é¢ä¸€å¥ä¸€å¥çš„æ¥åˆ†æã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ä¿®æ”¹ç±»æ–¹æ³•"></a>ä¿®æ”¹ç±»æ–¹æ³•<a class="hash-link" href="#ä¿®æ”¹ç±»æ–¹æ³•" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">+(NSInteger)handsNumber{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return 1;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>requireå°±ä¸è¯´äº†ã€‚</p><p>ä¸‹é¢çœ‹ä¸€çœ‹defineClass å‡½æ•°ã€‚</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  global</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">defineClass</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">declaration</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> properties</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> instMethods</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> clsMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> newInstMethods </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> newClsMethods </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">properties </span><span class="token keyword" style="font-style:italic">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      clsMethods </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> instMethods</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      instMethods </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> properties</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      properties </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">properties</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      properties</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">forEach</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">instMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          instMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_propertiesGetFun</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> nameOfSet </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;set&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">substr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toUpperCase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">substr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">instMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">nameOfSet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          instMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">nameOfSet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_propertiesSetFun</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> realClsName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> declaration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;:&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">trim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">_formatDefineMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> newInstMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> realClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">_formatDefineMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">clsMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> newClsMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> realClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> ret </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">_OC_defineClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">declaration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> newInstMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> newClsMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> className </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ret</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> superCls </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ret</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;superCls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">className</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      instMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      clsMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">superCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">superCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> funcName </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">superCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;instMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">className</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;instMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">funcName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">superCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;instMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">funcName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">var</span><span class="token plain"> funcName </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">superCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;clsMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">className</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;clsMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">funcName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> _ocCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">superCls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;clsMethods&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">funcName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">_setupJSMethod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">className</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> instMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> realClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">_setupJSMethod</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">className</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> clsMethods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> realClsName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">className</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ä¿®æ”¹å®ä¾‹æ–¹æ³•"></a>ä¿®æ”¹å®ä¾‹æ–¹æ³•<a class="hash-link" href="#ä¿®æ”¹å®ä¾‹æ–¹æ³•" title="Direct link to heading">#</a></h3><blockquote><p>SPatch çš„åŸºæœ¬åŸç†å°±æ˜¯ï¼šJS ä¼ é€’å­—ç¬¦ä¸²ç»™ OCï¼ŒOC é€šè¿‡ Runtime æ¥å£è°ƒç”¨å’Œæ›¿æ¢ OC æ–¹æ³•ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç±»å/æ–¹æ³•ååå°„å¾—åˆ°ç›¸åº”çš„ç±»å’Œæ–¹æ³•ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Class class = NSClassFromString(&quot;UIViewController&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">id viewController = [[class alloc] init];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SEL selector = NSSelectorFromString(&quot;viewDidLoad&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[viewController performSelector:selector];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ä¹Ÿå¯ä»¥æ›¿æ¢æŸä¸ªç±»çš„æ–¹æ³•ä¸ºæ–°çš„å®ç°ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">static void newViewDidLoad(id slf, SEL sel) {}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class_replaceMethod(class, selector, newViewDidLoad, @&quot;&quot;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>è¿˜å¯ä»¥æ–°æ³¨å†Œä¸€ä¸ªç±»ï¼Œä¸ºç±»æ·»åŠ æ–¹æ³•ï¼š</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Class cls = objc_allocateClassPair(superCls, &quot;JPObject&quot;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">objc_registerClassPair(cls);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class_addMethod(cls, selector, implement, typedesc);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£<a class="hash-link" href="#å‚è€ƒæ–‡æ¡£" title="Direct link to heading">#</a></h1><ul><li><a href="https://segmentfault.com/a/1190000003870981" target="_blank" rel="noopener noreferrer">JSPatch å®ç°åŸç†è¯¦è§£ (æ•´æ”¹ç‰ˆ)</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="dys-typora-open://mine/survival/docs/Apple/iOSå¼€å‘/ä¸‰æ–¹æ¡†æ¶/2016-11-21-JSPatchæºç è§£æ.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#javascript" class="table-of-contents__link">JavaScript</a></li><li><a href="#cè¯­è¨€åŸºç¡€" class="table-of-contents__link">Cè¯­è¨€åŸºç¡€</a></li><li><a href="#é€šè¿‡jspatchè°ƒç”¨ocæ–¹æ³•ã€‚" class="table-of-contents__link">é€šè¿‡JSPatchè°ƒç”¨OCæ–¹æ³•ã€‚</a><ul><li><a href="#require" class="table-of-contents__link">require</a></li><li><a href="#è°ƒç”¨ç±»æ–¹æ³•" class="table-of-contents__link">è°ƒç”¨ç±»æ–¹æ³•</a></li><li><a href="#è°ƒç”¨å®ä¾‹æ–¹æ³•" class="table-of-contents__link">è°ƒç”¨å®ä¾‹æ–¹æ³•</a></li></ul></li><li><a href="#ä¿®æ”¹å·²æœ‰æ–¹æ³•" class="table-of-contents__link">ä¿®æ”¹å·²æœ‰æ–¹æ³•</a><ul><li><a href="#ä¿®æ”¹ç±»æ–¹æ³•" class="table-of-contents__link">ä¿®æ”¹ç±»æ–¹æ³•</a></li><li><a href="#ä¿®æ”¹å®ä¾‹æ–¹æ³•" class="table-of-contents__link">ä¿®æ”¹å®ä¾‹æ–¹æ³•</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.e736442d.js"></script>
<script src="/runtime~main.500606b1.js"></script>
<script src="/main.e34cadf8.js"></script>
<script src="/1.3353372a.js"></script>
<script src="/256.3f6603bc.js"></script>
<script src="/257.427a7301.js"></script>
<script src="/935f2afb.0ee8c40a.js"></script>
<script src="/255.24175022.js"></script>
<script src="/d520deb9.4ba70645.js"></script>
</body>
</html>