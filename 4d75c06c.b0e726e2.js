(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{161:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return p})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return s}));var a=n(3),i=n(7),r=(n(0),n(330)),o=["components"],c={},p={unversionedId:"\u7f16\u7a0b\u57fa\u7840/\u8ba1\u7b97\u673a\u7cfb\u7edf\u57fa\u7840/1-\u7a0b\u5e8f/1-\u6784\u5efa/CMake/Importing-and-Exporting-Guide",id:"\u7f16\u7a0b\u57fa\u7840/\u8ba1\u7b97\u673a\u7cfb\u7edf\u57fa\u7840/1-\u7a0b\u5e8f/1-\u6784\u5efa/CMake/Importing-and-Exporting-Guide",isDocsHomePage:!1,title:"Importing-and-Exporting-Guide",description:"Importing and Exporting Guide",source:"@site/docs/\u7f16\u7a0b\u57fa\u7840/\u8ba1\u7b97\u673a\u7cfb\u7edf\u57fa\u7840/1-\u7a0b\u5e8f/1-\u6784\u5efa/CMake/Importing-and-Exporting-Guide.md",slug:"/\u7f16\u7a0b\u57fa\u7840/\u8ba1\u7b97\u673a\u7cfb\u7edf\u57fa\u7840/1-\u7a0b\u5e8f/1-\u6784\u5efa/CMake/Importing-and-Exporting-Guide",permalink:"/docs/\u7f16\u7a0b\u57fa\u7840/\u8ba1\u7b97\u673a\u7cfb\u7edf\u57fa\u7840/1-\u7a0b\u5e8f/1-\u6784\u5efa/CMake/Importing-and-Exporting-Guide",editUrl:"dys-typora-open://mine/survival/docs/\u7f16\u7a0b\u57fa\u7840/\u8ba1\u7b97\u673a\u7cfb\u7edf\u57fa\u7840/1-\u7a0b\u5e8f/1-\u6784\u5efa/CMake/Importing-and-Exporting-Guide.md",version:"current"},l=[{value:"Introduction",id:"introduction",children:[]},{value:"Importing Targets",id:"importing-targets",children:[{value:"Importing Executables",id:"importing-executables",children:[]},{value:"Importing Libraries",id:"importing-libraries",children:[]}]},{value:"Exporting Targets",id:"exporting-targets",children:[{value:"Creating Packages",id:"creating-packages",children:[]},{value:"Exporting Targets from the Build Tree",id:"exporting-targets-from-the-build-tree",children:[]},{value:"Building and Installing a Package",id:"building-and-installing-a-package",children:[]}]},{value:"Creating Relocatable Packages",id:"creating-relocatable-packages",children:[]},{value:"Using the Package Configuration File",id:"using-the-package-configuration-file",children:[]},{value:"Adding Components",id:"adding-components",children:[]}],d={toc:l};function s(e){var t=e.components,n=Object(i.a)(e,o);return Object(r.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"importing-and-exporting-guide"},"Importing and Exporting Guide"),Object(r.b)("p",null,"\u5bfc\u5165\u548c\u5bfc\u51fa\u6307\u5357"),Object(r.b)("p",null,"[toc]"),Object(r.b)("h2",{id:"introduction"},"Introduction"),Object(r.b)("p",null,"In this guide, we will present the concept of ",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED")," targets and demonstrate how to import existing executable or library files from disk into a CMake project. We will then show how CMake supports exporting targets from one CMake-based project and importing them into another. Finally, we will demonstrate how to package a project with a configuration file to allow for easy integration into other CMake projects. This guide and the complete example source code can be found in the ",Object(r.b)("inlineCode",{parentName:"p"},"Help/guide/importing-exporting")," directory of the CMake source code tree."),Object(r.b)("p",null,"\u5728\u672c\u6307\u5357\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u5bfc\u5165\u76ee\u6807\u7684\u6982\u5ff5\uff0c\u5e76\u6f14\u793a\u5982\u4f55\u5c06\u73b0\u6709\u7684\u53ef\u6267\u884c\u6587\u4ef6\u6216\u5e93\u6587\u4ef6\u4ece\u78c1\u76d8\u5bfc\u5165\u5230CMake\u9879\u76ee\u4e2d\u3002\u7136\u540e\uff0c\u6211\u4eec\u5c06\u5c55\u793aCMake\u5982\u4f55\u652f\u6301\u4ece\u4e00\u4e2a\u57fa\u4e8eCMake\u7684\u9879\u76ee\u5bfc\u51fa\u76ee\u6807\u5e76\u5c06\u5b83\u4eec\u5bfc\u5165\u5230\u53e6\u4e00\u4e2a\u9879\u76ee\u4e2d\u3002\u6700\u540e\uff0c\u6211\u4eec\u5c06\u6f14\u793a\u5982\u4f55\u7528\u914d\u7f6e\u6587\u4ef6\u6253\u5305\u4e00\u4e2a\u9879\u76ee\uff0c\u4ee5\u4fbf\u8f7b\u677e\u5730\u96c6\u6210\u5230\u5176\u4ed6CMake\u9879\u76ee\u4e2d\u3002\u672c\u6307\u5357\u548c\u5b8c\u6574\u7684\u793a\u4f8b\u6e90\u4ee3\u7801\u53ef\u4ee5\u5728CMake\u6e90\u4ee3\u7801\u6811\u7684Help/guide/importing-exporting\u76ee\u5f55\u4e2d\u627e\u5230\u3002"),Object(r.b)("h2",{id:"importing-targets"},"Importing Targets"),Object(r.b)("p",null,"IMPORTED targets are used to convert files outside of a CMake project into logical targets inside of the project. IMPORTED targets are created using the IMPORTED option of the add_executable() and add_library() commands. No build files are generated for IMPORTED targets. Once imported, IMPORTED targets may be referenced like any other target within the project and provide a convenient, flexible reference to outside executables and libraries."),Object(r.b)("p",null,"By default, the IMPORTED target name has scope in the directory in which it is created and below. We can use the GLOBAL option to extended visibility so that the target is accessible globally in the build system."),Object(r.b)("p",null,"Details about the IMPORTED target are specified by setting properties whose names begin in IMPORTED",Object(r.b)("em",{parentName:"p"}," and INTERFACE"),". For example, IMPORTED_LOCATION contains the full path to the target on disk."),Object(r.b)("p",null,"\u5bfc\u5165\u7684\u76ee\u6807\u7528\u4e8e\u5c06CMake\u9879\u76ee\u5916\u90e8\u7684\u6587\u4ef6\u8f6c\u6362\u4e3a\u9879\u76ee\u5185\u90e8\u7684\u903b\u8f91\u76ee\u6807\u3002\u5bfc\u5165\u7684\u76ee\u6807\u662f\u4f7f\u7528",Object(r.b)("inlineCode",{parentName:"p"},"add_executable()"),"\u548c",Object(r.b)("inlineCode",{parentName:"p"},"add_library()"),"\u547d\u4ee4\u7684IMPORTED\u9009\u9879\u521b\u5efa\u7684\u3002\u6ca1\u6709\u4e3a\u5bfc\u5165\u7684\u76ee\u6807\u751f\u6210\u6587\u4ef6\u3002\u5bfc\u5165\u540e\uff0c\u5bfc\u5165\u7684\u76ee\u6807\u53ef\u4ee5\u50cf\u9879\u76ee\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u76ee\u6807\u4e00\u6837\u88ab\u5f15\u7528\uff0c\u5e76\u63d0\u4f9b\u5bf9\u5916\u90e8\u53ef\u6267\u884c\u6587\u4ef6\u548c\u5e93\u7684\u65b9\u4fbf\u3001\u7075\u6d3b\u7684\u5f15\u7528\u3002"),Object(r.b)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bfc\u5165\u7684\u76ee\u6807\u540d\u79f0\u5728\u521b\u5efa\u5b83\u7684\u76ee\u5f55\u53ca\u5176\u4e0b\u5177\u6709\u4f5c\u7528\u57df\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528GLOBAL\u9009\u9879\u6765\u6269\u5c55\u53ef\u89c1\u6027\uff0c\u4ee5\u4fbf\u5728\u6784\u5efa\u7cfb\u7edf\u4e2d\u5168\u5c40\u8bbf\u95ee\u76ee\u6807\u3002"),Object(r.b)("p",null,"\u6709\u5173\u5bfc\u5165\u76ee\u6807\u7684\u8be6\u7ec6\u4fe1\u606f\u662f\u901a\u8fc7\u8bbe\u7f6e\u540d\u79f0\u4ee5",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED_"),"\u548c",Object(r.b)("inlineCode",{parentName:"p"},"INTERFACE_"),"\u5f00\u5934\u7684\u5c5e\u6027\u6765\u6307\u5b9a\u7684\u3002\u4f8b\u5982\uff0c\u5bfc\u5165\u7684\u4f4d\u7f6e\u5305\u542b\u78c1\u76d8\u4e0a\u76ee\u6807\u7684\u5b8c\u6574\u8def\u5f84\u3002"),Object(r.b)("h3",{id:"importing-executables"},"Importing Executables"),Object(r.b)("p",null,"To start, we will walk through a simple example that creates an ",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED"),"executable target and then references it from the ",Object(r.b)("inlineCode",{parentName:"p"},"add_custom_command()"),"command."),Object(r.b)("p",null,"\u9996\u5148\uff0c\u6211\u4eec\u5c06\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u521b\u5efa\u4e00\u4e2a\u5bfc\u5165\u7684\u53ef\u6267\u884c\u76ee\u6807\uff0c\u7136\u540e\u4ece",Object(r.b)("inlineCode",{parentName:"p"},"add_custom_command()"),"\u547d\u4ee4\u5f15\u7528\u5b83\u3002"),Object(r.b)("p",null,"We\u2019ll need to do some setup to get started. We want to create an executable that when run creates a basic ",Object(r.b)("inlineCode",{parentName:"p"},"main.cc")," file in the current directory. The details of this project are not important. Navigate to ",Object(r.b)("inlineCode",{parentName:"p"},"Help/guide/importing-exporting/MyExe"),", create a build directory, run",Object(r.b)("inlineCode",{parentName:"p"},"cmake"),"and build and install the project."),Object(r.b)("p",null,"\u6211\u4eec\u9700\u8981\u505a\u4e00\u4e9b\u8bbe\u7f6e\u624d\u80fd\u5f00\u59cb\u3002\u6211\u4eec\u60f3\u8981\u521b\u5efa\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd0\u884c\u8d77\u6765\u4f1a\u521b\u5efa\u4e00\u4e2a\u57fa\u672c\u7684",Object(r.b)("inlineCode",{parentName:"p"},"main.cc"),"\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002\u8fd9\u4e2a\u9879\u76ee\u7684\u7ec6\u8282\u5e76\u4e0d\u91cd\u8981\u3002\u5bfc\u822a\u5230",Object(r.b)("inlineCode",{parentName:"p"},"Help/guide/importing-exporting/MyExe"),"\uff0c\u521b\u5efa\u751f\u6210\u76ee\u5f55\uff0c\u8fd0\u884c",Object(r.b)("inlineCode",{parentName:"p"},"cmake"),"\uff0c\u751f\u6210\u5e76\u5b89\u88c5\u9879\u76ee\u3002"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"$ cd Help/guide/importing-exporting/MyExe\n$ mkdir build\n$ cd build\n$ cmake ..\n$ cmake --build .\n$ cmake --install . --prefix <install location>\n$ <install location>/myexe\n$ ls\n[...] main.cc [...]\n")),Object(r.b)("p",null,"Now we can import this executable into another CMake project. The source code for this section is available in ",Object(r.b)("inlineCode",{parentName:"p"},"Help/guide/importing-exporting/Importing"),". In the CMakeLists file, use the ",Object(r.b)("inlineCode",{parentName:"p"},"add_executable()")," command to create a new target called ",Object(r.b)("inlineCode",{parentName:"p"},"myexe"),". Use the ",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED"),"option to tell CMake that this target references an executable file located outside of the project. No rules will be generated to build it and the ",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED")," target property will be set to ",Object(r.b)("inlineCode",{parentName:"p"},"true"),"."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"add_executable(myexe IMPORTED)\n")),Object(r.b)("p",null,"Next, set the ","[",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED_LOCATION"),"]","(dfile:///Users/dingyusong/Library/Application Support/Dash/DocSets/CMake/CMake.docset/Contents/Resources/Documents/cmake.org/cmake/help/v3.19/prop_tgt/IMPORTED_LOCATION.html#prop_tgt:IMPORTED_LOCATION) property of the target using the ","[",Object(r.b)("inlineCode",{parentName:"p"},"set_property()"),"]","(dfile:///Users/dingyusong/Library/Application Support/Dash/DocSets/CMake/CMake.docset/Contents/Resources/Documents/cmake.org/cmake/help/v3.19/command/set_property.html#command:set_property) command. This will tell CMake the location of the target on disk. The location may need to be adjusted to the ",Object(r.b)("inlineCode",{parentName:"p"},"<install location>")," specified in the previous step."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},'set_property(TARGET myexe PROPERTY\n             IMPORTED_LOCATION "../InstallMyExe/bin/myexe")\n')),Object(r.b)("p",null,"We can now reference this ","[",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED"),"]","(dfile:///Users/dingyusong/Library/Application Support/Dash/DocSets/CMake/CMake.docset/Contents/Resources/Documents/cmake.org/cmake/help/v3.19/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED) target just like any target built within the project. In this instance, let\u2019s imagine that we want to use the generated source file in our project. Use the ","[",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED"),"]","(dfile:///Users/dingyusong/Library/Application Support/Dash/DocSets/CMake/CMake.docset/Contents/Resources/Documents/cmake.org/cmake/help/v3.19/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED) target in the ","[",Object(r.b)("inlineCode",{parentName:"p"},"add_custom_command()"),"]","(dfile:///Users/dingyusong/Library/Application Support/Dash/DocSets/CMake/CMake.docset/Contents/Resources/Documents/cmake.org/cmake/help/v3.19/command/add_custom_command.html#command:add_custom_command) command:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"add_custom_command(OUTPUT main.cc COMMAND myexe)\n")),Object(r.b)("p",null,"As ",Object(r.b)("inlineCode",{parentName:"p"},"COMMAND")," specifies an executable target name, it will automatically be replaced by the location of the executable given by the ","[",Object(r.b)("inlineCode",{parentName:"p"},"IMPORTED_LOCATION"),"]","(dfile:///Users/dingyusong/Library/Application Support/Dash/DocSets/CMake/CMake.docset/Contents/Resources/Documents/cmake.org/cmake/help/v3.19/prop_tgt/IMPORTED_LOCATION.html#prop_tgt:IMPORTED_LOCATION) property above."),Object(r.b)("p",null,"Finally, use the output from ",Object(r.b)("inlineCode",{parentName:"p"},"add_custom_command()"),":"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"add_executable(mynewexe main.cc)\n")),Object(r.b)("h3",{id:"importing-libraries"},"Importing Libraries"),Object(r.b)("h2",{id:"exporting-targets"},"Exporting Targets"),Object(r.b)("h3",{id:"creating-packages"},"Creating Packages"),Object(r.b)("h4",{id:"creating-a-package-configuration-file"},"Creating a Package Configuration File"),Object(r.b)("h4",{id:"creating-a-package-version-file"},"Creating a Package Version File"),Object(r.b)("h3",{id:"exporting-targets-from-the-build-tree"},"Exporting Targets from the Build Tree"),Object(r.b)("h3",{id:"building-and-installing-a-package"},"Building and Installing a Package"),Object(r.b)("h2",{id:"creating-relocatable-packages"},"Creating Relocatable Packages"),Object(r.b)("p",null,"\u521b\u5efa\u53ef\u91cd\u5b9a\u4f4d\u5305"),Object(r.b)("h2",{id:"using-the-package-configuration-file"},"Using the Package Configuration File"),Object(r.b)("h2",{id:"adding-components"},"Adding Components"))}s.isMDXComponent=!0},330:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),d=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},s=function(e){var t=d(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),s=d(n),u=a,m=s["".concat(o,".").concat(u)]||s[u]||b[u]||r;return n?i.a.createElement(m,c(c({ref:t},l),{},{components:n})):i.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var c={};for(var p in t)hasOwnProperty.call(t,p)&&(c[p]=t[p]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<r;l++)o[l]=n[l];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);